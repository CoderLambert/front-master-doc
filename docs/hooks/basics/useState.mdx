# useState - çŠ¶æ€ç®¡ç†åŸºç¡€

import { Tabs, TabItem } from '@docusaurus/theme-common';

`useState`æ˜¯React Hooksç³»ç»Ÿä¸­æœ€åŸºç¡€ä¹Ÿæ˜¯æœ€é‡è¦çš„Hookï¼Œå®ƒä¸ºå‡½æ•°ç»„ä»¶æä¾›äº†çŠ¶æ€ç®¡ç†èƒ½åŠ›ã€‚åœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬å°†æ·±å…¥å­¦ä¹ useStateçš„ç”¨æ³•ã€æœ€ä½³å®è·µå’Œå¸¸è§é™·é˜±ã€‚

## æœ¬ç« å­¦ä¹ ç›®æ ‡

- ç†è§£useStateçš„åŸºæœ¬è¯­æ³•å’Œä½œç”¨
- æŒæ¡çŠ¶æ€æ›´æ–°çš„å„ç§æ–¹å¼
- å­¦ä¼šä½¿ç”¨å‡½æ•°å¼çŠ¶æ€æ›´æ–°
- ç†è§£çŠ¶æ€æ›´æ–°çš„å¼‚æ­¥ç‰¹æ€§
- æŒæ¡å¤šä¸ªçŠ¶æ€çš„ç®¡ç†æ–¹æ³•
- é¿å…å¸¸è§çš„useStateä½¿ç”¨é”™è¯¯

---

## 1. ä»€ä¹ˆæ˜¯useStateï¼Ÿ

useStateæ˜¯Reactæä¾›çš„Hookï¼Œå®ƒå…è®¸ä½ åœ¨å‡½æ•°ç»„ä»¶ä¸­æ·»åŠ çŠ¶æ€ã€‚åœ¨å¼•å…¥Hooksä¹‹å‰ï¼Œåªæœ‰ç±»ç»„ä»¶æ‰èƒ½æ‹¥æœ‰çŠ¶æ€ï¼Œè€ŒuseStateè®©å‡½æ•°ç»„ä»¶ä¹Ÿæ‹¥æœ‰äº†"è®°å¿†"èƒ½åŠ›ã€‚

<Box style={{ padding: '20px', background: '#e3f2fd', borderRadius: '8px', margin: '20px 0' }}>
  <h4 style={{ margin: 0, color: '#1976d2' }}>ğŸ’¡ æ ¸å¿ƒæ¦‚å¿µ</h4>
  <p style={{ margin: '10px 0 0 0' }}>
    <strong>çŠ¶æ€ï¼ˆStateï¼‰</strong>æ˜¯ç»„ä»¶å†…éƒ¨çš„ç§æœ‰æ•°æ®ï¼Œå½“çŠ¶æ€æ”¹å˜æ—¶ï¼Œç»„ä»¶ä¼šé‡æ–°æ¸²æŸ“ä»¥åæ˜ è¿™äº›å˜åŒ–ã€‚
  </p>
</Box>

### 1.1 åŸºæœ¬è¯­æ³•

```javascript
const [state, setState] = useState(initialValue);
```

- `state`: å½“å‰çŠ¶æ€å€¼
- `setState`: æ›´æ–°çŠ¶æ€çš„å‡½æ•°
- `initialValue`: çŠ¶æ€çš„åˆå§‹å€¼

### 1.2 ç®€å•ç¤ºä¾‹

<CodeBlock>

```jsx
import { useState } from 'react';

function Counter() {
  // åˆ›å»ºä¸€ä¸ªåä¸ºcountçš„çŠ¶æ€ï¼Œåˆå§‹å€¼ä¸º0
  const [count, setCount] = useState(0);

  return (
    <div>
      <p>å½“å‰è®¡æ•°: {count}</p>
      <button onClick={() => setCount(count + 1)}>
        ç‚¹å‡»+1
      </button>
      <button onClick={() => setCount(count - 1)}>
        ç‚¹å‡»-1
      </button>
    </div>
  );
}
```

</CodeBlock>

---

## 2. åŸºç¡€ç”¨æ³•

### 2.1 ä¸åŒç±»å‹çš„åˆå§‹å€¼

useStateå¯ä»¥æ¥å—å„ç§ç±»å‹çš„åˆå§‹å€¼ï¼š

<CodeBlock>

```jsx
import { useState } from 'react';

function StateExamples() {
  // æ•°å­—
  const [count, setCount] = useState(0);

  // å­—ç¬¦ä¸²
  const [name, setName] = useState('Alice');

  // å¸ƒå°”å€¼
  const [isVisible, setIsVisible] = useState(true);

  // å¯¹è±¡
  const [user, setUser] = useState({ name: 'Bob', age: 25 });

  // æ•°ç»„
  const [items, setItems] = useState(['Item 1', 'Item 2']);

  return (
    <div>
      <p>è®¡æ•°: {count}</p>
      <p>å§“å: {name}</p>
      <p>å¯è§: {isVisible ? 'æ˜¯' : 'å¦'}</p>
      <p>ç”¨æˆ·: {user.name}, {user.age}å²</p>
      <ul>
        {items.map((item, index) => (
          <li key={index}>{item}</li>
        ))}
      </ul>
    </div>
  );
}
```

</CodeBlock>

### 2.2 äº‹ä»¶å¤„ç†

<CodeBlock>

```jsx
import { useState } from 'react';

function InputExample() {
  const [inputValue, setInputValue] = useState('');

  return (
    <div>
      <input
        type="text"
        value={inputValue}
        onChange={(e) => setInputValue(e.target.value)}
        placeholder="è¾“å…¥ä¸€äº›æ–‡å­—..."
      />
      <p>ä½ è¾“å…¥äº†: {inputValue}</p>
    </div>
  );
}
```

</CodeBlock>

### 2.3 åˆ‡æ¢çŠ¶æ€

<CodeBlock>

```jsx
import { useState } from 'react';

function ToggleExample() {
  const [isOn, setIsOn] = useState(false);

  return (
    <button
      onClick={() => setIsOn(!isOn)}
      style={{
        backgroundColor: isOn ? '#4caf50' : '#ccc',
        color: 'white',
        padding: '10px 20px',
        border: 'none',
        borderRadius: '4px',
        cursor: 'pointer'
      }}
    >
      {isOn ? 'å¼€' : 'å…³'}
    </button>
  );
}
```

</CodeBlock>

---

## 3. çŠ¶æ€æ›´æ–°

### 3.1 ç›´æ¥æ›´æ–°

æœ€ç®€å•çš„çŠ¶æ€æ›´æ–°æ–¹å¼ï¼Œç›´æ¥ä¼ å…¥æ–°å€¼ï¼š

<CodeBlock>

```jsx
function DirectUpdate() {
  const [count, setCount] = useState(0);

  const increment = () => {
    setCount(count + 1);
  };

  const decrement = () => {
    setCount(count - 1);
  };

  const reset = () => {
    setCount(0);
  };

  return (
    <div>
      <p>è®¡æ•°: {count}</p>
      <button onClick={increment}>+1</button>
      <button onClick={decrement}>-1</button>
      <button onClick={reset}>é‡ç½®</button>
    </div>
  );
}
```

</CodeBlock>

### 3.2 å‡½æ•°å¼æ›´æ–°

å½“æ–°çŠ¶æ€ä¾èµ–äºå‰ä¸€ä¸ªçŠ¶æ€æ—¶ï¼Œåº”è¯¥ä½¿ç”¨å‡½æ•°å¼æ›´æ–°ï¼š

<CodeBlock>

```jsx
function FunctionalUpdate() {
  const [count, setCount] = useState(0);

  const increment = () => {
    setCount(prevCount => prevCount + 1);
  };

  const decrement = () => {
    setCount(prevCount => prevCount - 1);
  };

  const addFive = () => {
    // å‡½æ•°å¼æ›´æ–°ç¡®ä¿æ¯æ¬¡éƒ½åŸºäºæœ€æ–°çŠ¶æ€
    setCount(prevCount => prevCount + 5);
  };

  return (
    <div>
      <p>è®¡æ•°: {count}</p>
      <button onClick={increment}>+1</button>
      <button onClick={decrement}>-1</button>
      <button onClick={addFive}>+5</button>
    </div>
  );
}
```

</CodeBlock>

<Box style={{ padding: '20px', background: '#fff3e0', borderRadius: '8px', margin: '20px 0' }}>
  <h4 style={{ margin: 0, color: '#e65100' }}>âš ï¸ é‡è¦æç¤º</h4>
  <p style={{ margin: '10px 0 0 0' }}>
    å½“çŠ¶æ€æ›´æ–°<strong>ä¾èµ–äºå‰ä¸€ä¸ªçŠ¶æ€å€¼</strong>æ—¶ï¼Œ<strong>å¿…é¡»</strong>ä½¿ç”¨å‡½æ•°å¼æ›´æ–°ä»¥é¿å…é—­åŒ…é™·é˜±ã€‚
  </p>
</Box>

### 3.3 å¤æ‚å¯¹è±¡æ›´æ–°

æ›´æ–°å¯¹è±¡çŠ¶æ€æ—¶ï¼Œéœ€è¦åˆ›å»ºæ–°å¯¹è±¡è€Œä¸æ˜¯ç›´æ¥ä¿®æ”¹åŸå¯¹è±¡ï¼š

<ErrorBox>

```jsx
// âŒ é”™è¯¯ - ç›´æ¥ä¿®æ”¹å¯¹è±¡
function BadExample() {
  const [user, setUser] = useState({ name: 'Alice', age: 25 });

  const updateAge = () => {
    user.age = 26;  // ç›´æ¥ä¿®æ”¹ï¼
    setUser(user);  // Reactä¸ä¼šæ£€æµ‹åˆ°å˜åŒ–
  };

  return <button onClick={updateAge}>æ›´æ–°å¹´é¾„</button>;
}

// âœ… æ­£ç¡® - åˆ›å»ºæ–°å¯¹è±¡
function GoodExample() {
  const [user, setUser] = useState({ name: 'Alice', age: 25 });

  const updateAge = () => {
    setUser({ ...user, age: 26 });  // ä½¿ç”¨å±•å¼€è¿ç®—ç¬¦
  };

  return <button onClick={updateAge}>æ›´æ–°å¹´é¾„</button>;
}
```

</ErrorBox>

### 3.4 æ•°ç»„çŠ¶æ€æ›´æ–°

<Compare>

```jsx
// âŒ æ·»åŠ æ•°ç»„é¡¹ - é”™è¯¯æ–¹å¼
function BadArrayExample() {
  const [items, setItems] = useState(['A', 'B']);

  const addItem = () => {
    items.push('C');  // ç›´æ¥ä¿®æ”¹æ•°ç»„ï¼
    setItems(items);  // Reactä¸ä¼šæ£€æµ‹åˆ°å˜åŒ–
  };

  return <button onClick={addItem}>æ·»åŠ </button>;
}

// âœ… æ·»åŠ æ•°ç»„é¡¹ - æ­£ç¡®æ–¹å¼
function GoodArrayExample() {
  const [items, setItems] = useState(['A', 'B']);

  const addItem = () => {
    setItems([...items, 'C']);  // åˆ›å»ºæ–°æ•°ç»„
  };

  const removeItem = (index) => {
    setItems(items.filter((_, i) => i !== index));
  };

  const updateItem = (index, newValue) => {
    setItems(items.map((item, i) => i === index ? newValue : item));
  };

  return (
    <div>
      <button onClick={addItem}>æ·»åŠ </button>
      <ul>
        {items.map((item, index) => (
          <li key={index}>
            {item}
            <button onClick={() => updateItem(index, item + '!')}>
              æ›´æ–°
            </button>
            <button onClick={() => removeItem(index)}>
              åˆ é™¤
            </button>
          </li>
        ))}
      </ul>
    </div>
  );
}
```

</Compare>

---

## 4. å¤šä¸ªçŠ¶æ€ç®¡ç†

### 4.1 åˆ†åˆ«å®šä¹‰çŠ¶æ€

å¯¹äºä¸åŒç±»å‹çš„çŠ¶æ€ï¼Œå»ºè®®åˆ†åˆ«å®šä¹‰ï¼š

<CodeBlock>

```jsx
function SeparateStates() {
  const [name, setName] = useState('');
  const [age, setAge] = useState(0);
  const [email, setEmail] = useState('');

  const handleSubmit = (e) => {
    e.preventDefault();
    console.log({ name, age, email });
  };

  return (
    <form onSubmit={handleSubmit}>
      <input
        type="text"
        placeholder="å§“å"
        value={name}
        onChange={(e) => setName(e.target.value)}
      />
      <input
        type="number"
        placeholder="å¹´é¾„"
        value={age}
        onChange={(e) => setAge(Number(e.target.value))}
      />
      <input
        type="email"
        placeholder="é‚®ç®±"
        value={email}
        onChange={(e) => setEmail(e.target.value)}
      />
      <button type="submit">æäº¤</button>
    </form>
  );
}
```

</CodeBlock>

### 4.2 ä½¿ç”¨å¯¹è±¡ç®¡ç†ç›¸å…³çŠ¶æ€

å½“çŠ¶æ€ä¹‹é—´æœ‰é€»è¾‘å…³è”æ—¶ï¼Œå¯ä»¥ä½¿ç”¨å•ä¸€å¯¹è±¡ï¼š

<CodeBlock>

```jsx
function ObjectState() {
  const [user, setUser] = useState({
    name: '',
    age: 0,
    email: ''
  });

  const updateField = (field, value) => {
    setUser(prev => ({ ...prev, [field]: value }));
  };

  const handleSubmit = (e) => {
    e.preventDefault();
    console.log(user);
  };

  return (
    <form onSubmit={handleSubmit}>
      <input
        type="text"
        placeholder="å§“å"
        value={user.name}
        onChange={(e) => updateField('name', e.target.value)}
      />
      <input
        type="number"
        placeholder="å¹´é¾„"
        value={user.age}
        onChange={(e) => updateField('age', Number(e.target.value))}
      />
      <input
        type="email"
        placeholder="é‚®ç®±"
        value={user.email}
        onChange={(e) => updateField('email', e.target.value)}
      />
      <button type="submit">æäº¤</button>
    </form>
  );
}
```

</CodeBlock>

---

## 5. çŠ¶æ€åˆå§‹åŒ–

### 5.1 æƒ°æ€§åˆå§‹åŒ–

å¯¹äºå¤æ‚çš„åˆå§‹çŠ¶æ€è®¡ç®—ï¼Œä½¿ç”¨æƒ°æ€§åˆå§‹åŒ–é¿å…æ¯æ¬¡æ¸²æŸ“éƒ½è®¡ç®—ï¼š

<CodeBlock>

```jsx
function LazyInitialization() {
  // âŒ æ¯æ¬¡æ¸²æŸ“éƒ½æ‰§è¡Œ
  // const [state, setState] = useState(expensiveComputation());

  // âœ… åªåœ¨åˆæ¬¡æ¸²æŸ“æ—¶æ‰§è¡Œ
  const [state, setState] = useState(() => {
    return expensiveComputation();
  });

  const expensiveComputation = () => {
    console.log('æ‰§è¡Œå¤æ‚è®¡ç®—...');
    // æ¨¡æ‹Ÿå¤æ‚è®¡ç®—
    return 100;
  };

  return (
    <div>
      <p>çŠ¶æ€å€¼: {state}</p>
      <button onClick={() => setState(state + 1)}>æ›´æ–°</button>
    </div>
  );
}
```

</CodeBlock>

### 5.2 ä»localStorageåˆå§‹åŒ–

<CodeBlock>

```jsx
function LocalStorageState() {
  const [theme, setTheme] = useState(() => {
    // ä»localStorageè¯»å–åˆå§‹å€¼
    const savedTheme = localStorage.getItem('theme');
    return savedTheme || 'light';
  });

  const toggleTheme = () => {
    setTheme(prev => {
      const newTheme = prev === 'light' ? 'dark' : 'light';
      // ä¿å­˜åˆ°localStorage
      localStorage.setItem('theme', newTheme);
      return newTheme;
    });
  };

  return (
    <button onClick={toggleTheme}>
      å½“å‰ä¸»é¢˜: {theme}ï¼Œç‚¹å‡»åˆ‡æ¢
    </button>
  );
}
```

</CodeBlock>

---

## 6. å®é™…åº”ç”¨åœºæ™¯

### 6.1 è®¡æ•°å™¨åº”ç”¨

<CodeBlock>

```jsx
function AdvancedCounter() {
  const [count, setCount] = useState(0);
  const [step, setStep] = useState(1);

  const increment = () => setCount(prev => prev + step);
  const decrement = () => setCount(prev => prev - step);
  const reset = () => setCount(0);

  return (
    <div>
      <h2>è®¡æ•°å™¨</h2>
      <p>å½“å‰è®¡æ•°: {count}</p>
      <div>
        <label>
          æ­¥é•¿:
          <input
            type="number"
            value={step}
            onChange={(e) => setStep(Number(e.target.value))}
            style={{ width: '60px', marginLeft: '10px' }}
          />
        </label>
      </div>
      <button onClick={increment}>+{step}</button>
      <button onClick={decrement}>-{step}</button>
      <button onClick={reset}>é‡ç½®</button>
    </div>
  );
}
```

</CodeBlock>

### 6.2 å¾…åŠäº‹é¡¹åˆ—è¡¨

<CodeBlock>

```jsx
function TodoList() {
  const [todos, setTodos] = useState([]);
  const [inputValue, setInputValue] = useState('');

  const addTodo = () => {
    if (inputValue.trim()) {
      setTodos(prev => [
        ...prev,
        {
          id: Date.now(),
          text: inputValue,
          completed: false
        }
      ]);
      setInputValue('');
    }
  };

  const toggleTodo = (id) => {
    setTodos(prev =>
      prev.map(todo =>
        todo.id === id ? { ...todo, completed: !todo.completed } : todo
      )
    );
  };

  const deleteTodo = (id) => {
    setTodos(prev => prev.filter(todo => todo.id !== id));
  };

  return (
    <div>
      <h2>å¾…åŠäº‹é¡¹</h2>
      <div>
        <input
          type="text"
          value={inputValue}
          onChange={(e) => setInputValue(e.target.value)}
          onKeyPress={(e) => e.key === 'Enter' && addTodo()}
          placeholder="æ·»åŠ æ–°ä»»åŠ¡..."
        />
        <button onClick={addTodo}>æ·»åŠ </button>
      </div>
      <ul>
        {todos.map(todo => (
          <li
            key={todo.id}
            style={{
              textDecoration: todo.completed ? 'line-through' : 'none',
              cursor: 'pointer'
            }}
            onClick={() => toggleTodo(todo.id)}
          >
            {todo.text}
            <button onClick={(e) => {
              e.stopPropagation();
              deleteTodo(todo.id);
            }}>
              åˆ é™¤
            </button>
          </li>
        ))}
      </ul>
    </div>
  );
}
```

</CodeBlock>

### 6.3 è¡¨å•å¤„ç†

<CodeBlock>

```jsx
function ContactForm() {
  const [formData, setFormData] = useState({
    name: '',
    email: '',
    message: ''
  });
  const [isSubmitting, setIsSubmitting] = useState(false);

  const handleChange = (e) => {
    setFormData({
      ...formData,
      [e.target.name]: e.target.value
    });
  };

  const handleSubmit = async (e) => {
    e.preventDefault();
    setIsSubmitting(true);

    // æ¨¡æ‹ŸAPIè°ƒç”¨
    await new Promise(resolve => setTimeout(resolve, 1000));

    console.log('æäº¤çš„æ•°æ®:', formData);
    setIsSubmitting(false);
    setFormData({ name: '', email: '', message: '' });
    alert('æäº¤æˆåŠŸï¼');
  };

  return (
    <form onSubmit={handleSubmit}>
      <div>
        <label>
          å§“å:
          <input
            type="text"
            name="name"
            value={formData.name}
            onChange={handleChange}
            required
          />
        </label>
      </div>
      <div>
        <label>
          é‚®ç®±:
          <input
            type="email"
            name="email"
            value={formData.email}
            onChange={handleChange}
            required
          />
        </label>
      </div>
      <div>
        <label>
          ç•™è¨€:
          <textarea
            name="message"
            value={formData.message}
            onChange={handleChange}
            rows="4"
            required
          />
        </label>
      </div>
      <button type="submit" disabled={isSubmitting}>
        {isSubmitting ? 'æäº¤ä¸­...' : 'æäº¤'}
      </button>
    </form>
  );
}
```

</CodeBlock>

---

## 7. å¸¸è§é”™è¯¯ä¸é™·é˜±

### 7.1 å¿˜è®°ä½¿ç”¨setterå‡½æ•°

<ErrorBox>

```jsx
// âŒ é”™è¯¯ - ç›´æ¥ä¿®æ”¹çŠ¶æ€
function BadExample() {
  const [count, setCount] = useState(0);

  const increment = () => {
    count++;  // é”™è¯¯ï¼ä¸èƒ½ç›´æ¥ä¿®æ”¹çŠ¶æ€
    setCount(count);  // è¿™ä¸ä¼šæ›´æ–°UI
  };

  return <button onClick={increment}>+1</button>;
}

// âœ… æ­£ç¡®
function GoodExample() {
  const [count, setCount] = useState(0);

  const increment = () => {
    setCount(count + 1);
  };

  return <button onClick={increment}>+1</button>;
}
```

</ErrorBox>

### 7.2 é—­åŒ…é™·é˜±

<ErrorBox>

```jsx
// âŒ é”™è¯¯ - çŠ¶æ€æ›´æ–°å»¶è¿Ÿ
function DelayedUpdate() {
  const [count, setCount] = useState(0);

  const increment = () => {
    setCount(count + 1);
    setCount(count + 1);  // è¿™ä¸ä¼šå¢åŠ åˆ°2ï¼
  };

  return <button onClick={increment}>+2</button>;
}

// âœ… æ­£ç¡® - ä½¿ç”¨å‡½æ•°å¼æ›´æ–°
function CorrectUpdate() {
  const [count, setCount] = useState(0);

  const increment = () => {
    setCount(prev => prev + 1);
    setCount(prev => prev + 1);  // è¿™ä¼šå¢åŠ åˆ°2
  };

  return <button onClick={increment}>+2</button>;
}
```

</ErrorBox>

### 7.3 åœ¨æ¡ä»¶è¯­å¥ä¸­è°ƒç”¨useState

<ErrorBox>

```jsx
// âŒ é”™è¯¯ - Hookåœ¨æ¡ä»¶è¯­å¥ä¸­
function BadExample(condition) {
  if (condition) {
    const [state, setState] = useState(0);  // é”™è¯¯ï¼
  }

  return <div>...</div>;
}

// âœ… æ­£ç¡® - Hookåœ¨é¡¶å±‚
function GoodExample(condition) {
  const [state, setState] = useState(0);  // å§‹ç»ˆè°ƒç”¨

  if (condition) {
    // å¯ä»¥åœ¨æ¡ä»¶ä¸­ä½¿ç”¨çŠ¶æ€
    console.log(state);
  }

  return <div>...</div>;
}
```

</ErrorBox>

### 7.4 æ•°ç»„å’Œå¯¹è±¡çš„çŠ¶æ€æ›´æ–°

<ErrorBox>

```jsx
// âŒ é”™è¯¯ - ä¿®æ”¹åŸæ•°ç»„/å¯¹è±¡
function BadArrayUpdate() {
  const [arr, setArr] = useState([1, 2, 3]);

  const addItem = () => {
    arr.push(4);  // ä¿®æ”¹åŸæ•°ç»„
    setArr(arr);  // Reactä¸ä¼šé‡æ–°æ¸²æŸ“
  };

  return <button onClick={addItem}>æ·»åŠ </button>;
}

// âœ… æ­£ç¡® - åˆ›å»ºæ–°æ•°ç»„
function GoodArrayUpdate() {
  const [arr, setArr] = useState([1, 2, 3]);

  const addItem = () => {
    setArr([...arr, 4]);  // åˆ›å»ºæ–°æ•°ç»„
  };

  return <button onClick={addItem}>æ·»åŠ </button>;
}
```

</ErrorBox>

---

## 8. æ€§èƒ½ä¼˜åŒ–

### 8.1 å‡å°‘ä¸å¿…è¦çš„çŠ¶æ€

<Compare>

```jsx
// âŒ ä¸å¿…è¦ - å¯ä»¥ä»å…¶ä»–çŠ¶æ€è®¡ç®—å¾—å‡º
function UnnecessaryState() {
  const [firstName, setFirstName] = useState('John');
  const [lastName, setLastName] = useState('Doe');
  const [fullName, setFullName] = useState('John Doe');  // ä¸å¿…è¦

  // éœ€è¦æ‰‹åŠ¨åŒæ­¥æ›´æ–°
  const updateName = (newFirst, newLast) => {
    setFirstName(newFirst);
    setLastName(newLast);
    setFullName(`${newFirst} ${newLast}`);
  };

  return <div>{fullName}</div>;
}

// âœ… æ›´å¥½ - è®¡ç®—å±æ€§
function DerivedState() {
  const [firstName, setFirstName] = useState('John');
  const [lastName, setLastName] = useState('Doe');

  // æ´¾ç”ŸçŠ¶æ€ - ä¸éœ€è¦useState
  const fullName = `${firstName} ${lastName}`;

  const updateName = (newFirst, newLast) => {
    setFirstName(newFirst);
    setLastName(newLast);
  };

  return <div>{fullName}</div>;
}
```

</Compare>

### 8.2 æ‰¹é‡æ›´æ–°

<CodeBlock>

```jsx
function BatchedUpdates() {
  const [count, setCount] = useState(0);
  const [flag, setFlag] = useState(false);

  const handleClick = () => {
    // React 18ä¸­ï¼Œè¿™äº›æ›´æ–°ä¼šè¢«æ‰¹é‡å¤„ç†
    setCount(c => c + 1);  // è®¡åˆ’æ›´æ–°: 1
    setFlag(f => !f);      // è®¡åˆ’æ›´æ–°: true
    // Reactä¼šåªé‡æ–°æ¸²æŸ“ä¸€æ¬¡
  };

  return (
    <div>
      <h1 style={{ color: flag ? 'blue' : 'black' }}>{count}</h1>
      <button onClick={handleClick}>
        ç‚¹å‡»
      </button>
    </div>
  );
}
```

</CodeBlock>

---

## 9. å®è·µç»ƒä¹ 

### ç»ƒä¹ 1ï¼šæ¸©åº¦è½¬æ¢å™¨

åˆ›å»ºä¸€ä¸ªæ¸©åº¦è½¬æ¢å™¨ï¼Œæ”¯æŒæ‘„æ°åº¦ã€åæ°åº¦å’Œå¼€å°”æ–‡ä¹‹é—´çš„è½¬æ¢ã€‚

<Expandable title="ç‚¹å‡»æŸ¥çœ‹è¦æ±‚">

**åŠŸèƒ½è¦æ±‚**ï¼š
- ä¸‰ä¸ªè¾“å…¥æ¡†ï¼šæ‘„æ°åº¦ã€åæ°åº¦ã€å¼€å°”æ–‡
- è¾“å…¥ä»»ä½•ä¸€ä¸ªå€¼ï¼Œå…¶ä»–ä¸¤ä¸ªè‡ªåŠ¨æ›´æ–°
- ä½¿ç”¨ç»Ÿä¸€çš„æ¸©åº¦çŠ¶æ€å¯¹è±¡
- æ ¼å¼åŒ–æ˜¾ç¤ºå°æ•°ç‚¹åä¸¤ä½

**æç¤º**ï¼š
- ä½¿ç”¨å¯¹è±¡çŠ¶æ€ç®¡ç†æ‰€æœ‰æ¸©åº¦
- æ¸©åº¦è½¬æ¢å…¬å¼ï¼š
  - C â†’ F: F = C Ã— 9/5 + 32
  - C â†’ K: K = C + 273.15
  - F â†’ C: C = (F - 32) Ã— 5/9

</Expandable>

### ç»ƒä¹ 2ï¼šé¢œè‰²é€‰æ‹©å™¨

åˆ›å»ºä¸€ä¸ªé¢œè‰²é€‰æ‹©å™¨ï¼Œæ˜¾ç¤ºRGBã€HEXå’ŒHSLå€¼ã€‚

<Expandable title="ç‚¹å‡»æŸ¥çœ‹è¦æ±‚">

**åŠŸèƒ½è¦æ±‚**ï¼š
- é¢œè‰²é€‰æ‹©å™¨ï¼ˆinput type="color"ï¼‰
- æ˜¾ç¤ºRGBå€¼ï¼ˆR: 0-255, G: 0-255, B: 0-255ï¼‰
- æ˜¾ç¤ºHEXå€¼ï¼ˆ#RRGGBBï¼‰
- æ˜¾ç¤ºHSLå€¼ï¼ˆè‰²ç›¸ã€é¥±å’Œåº¦ã€äº®åº¦ï¼‰
- å¯ä»¥é€šè¿‡RGBæ»‘å—è°ƒæ•´é¢œè‰²

**æç¤º**ï¼š
- éœ€è¦RGBåˆ°HEXã€HSLçš„è½¬æ¢å‡½æ•°
- ä½¿ç”¨useStateç®¡ç†RGBå€¼
- æ ¹æ®RGBè®¡ç®—å…¶ä»–æ ¼å¼

</Expandable>

### ç»ƒä¹ 3ï¼šè´­ç‰©è½¦

åˆ›å»ºä¸€ä¸ªç®€å•çš„è´­ç‰©è½¦åº”ç”¨ã€‚

<Expandable title="ç‚¹å‡»æŸ¥çœ‹è¦æ±‚">

**åŠŸèƒ½è¦æ±‚**ï¼š
- å•†å“åˆ—è¡¨ï¼ˆåç§°ã€ä»·æ ¼ï¼‰
- æ·»åŠ åˆ°è´­ç‰©è½¦
- è´­ç‰©è½¦å•†å“æ•°é‡è°ƒæ•´
- åˆ é™¤å•†å“
- æ€»ä»·è®¡ç®—
- æ¸…ç©ºè´­ç‰©è½¦

**æ•°æ®ç»“æ„**ï¼š
```javascript
// å•†å“
{ id, name, price }

// è´­ç‰©è½¦é¡¹
{ productId, quantity }
```

**æç¤º**ï¼š
- ä½¿ç”¨æ•°ç»„çŠ¶æ€ç®¡ç†è´­ç‰©è½¦
- ä½¿ç”¨useStateçš„å‡½æ•°å¼æ›´æ–°é¿å…é—­åŒ…é—®é¢˜
- è®¡ç®—æ€»ä»·çš„æ´¾ç”ŸçŠ¶æ€

</Expandable>

### ç»ƒä¹ 4ï¼šå¤šæ­¥éª¤è¡¨å•

åˆ›å»ºä¸€ä¸ªå¤šæ­¥éª¤çš„æ³¨å†Œè¡¨å•ã€‚

<Expandable title="ç‚¹å‡»æŸ¥çœ‹è¦æ±‚">

**åŠŸèƒ½è¦æ±‚**ï¼š
- æ­¥éª¤1ï¼šä¸ªäººä¿¡æ¯ï¼ˆå§“åã€é‚®ç®±ï¼‰
- æ­¥éª¤2ï¼šè´¦æˆ·è®¾ç½®ï¼ˆç”¨æˆ·åã€å¯†ç ï¼‰
- æ­¥éª¤3ï¼šç¡®è®¤ä¿¡æ¯
- ä¸Šä¸€æ­¥/ä¸‹ä¸€æ­¥æŒ‰é’®
- è¿›åº¦æ¡æ˜¾ç¤º
- è¡¨å•éªŒè¯

**æç¤º**ï¼š
- ä½¿ç”¨æ­¥éª¤çŠ¶æ€ï¼ˆ0, 1, 2ï¼‰
- æ¯ä¸ªæ­¥éª¤çš„è¡¨å•æ•°æ®åˆ†å¼€ç®¡ç†
- æœ€åä¸€æ­¥æ˜¾ç¤ºæ‰€æœ‰ä¿¡æ¯ä¾›ç¡®è®¤

</Expandable>

---

## 10. æœ¬ç« å°ç»“

### å…³é”®è¦ç‚¹

<Checklist>

- âœ… useStateä¸ºå‡½æ•°ç»„ä»¶æä¾›çŠ¶æ€ç®¡ç†èƒ½åŠ›
- âœ… ä½¿ç”¨`[state, setState] = useState(initialValue)`è¯­æ³•
- âœ… çŠ¶æ€æ›´æ–°è§¦å‘ç»„ä»¶é‡æ–°æ¸²æŸ“
- âœ… å½“æ–°çŠ¶æ€ä¾èµ–å‰ä¸€ä¸ªçŠ¶æ€æ—¶ï¼Œä½¿ç”¨å‡½æ•°å¼æ›´æ–°
- âœ… ä½¿ç”¨å±•å¼€è¿ç®—ç¬¦æ›´æ–°å¯¹è±¡å’Œæ•°ç»„çŠ¶æ€
- âœ… å¤æ‚åˆå§‹çŠ¶æ€å¯ä»¥ä½¿ç”¨æƒ°æ€§åˆå§‹åŒ–
- âœ… é¿å…ç›´æ¥ä¿®æ”¹çŠ¶æ€ï¼Œè€Œæ˜¯åˆ›å»ºæ–°å€¼
- âœ… å¤šä¸ªç›¸å…³çŠ¶æ€å¯ä»¥ä½¿ç”¨å¯¹è±¡ç®¡ç†

</Checklist>

### æœ€ä½³å®è·µ

<BestPractices>

1. **ä¼˜å…ˆä½¿ç”¨å‡½æ•°å¼æ›´æ–°** - å½“çŠ¶æ€æ›´æ–°ä¾èµ–å‰ä¸€ä¸ªå€¼æ—¶
2. **ä¿æŒçŠ¶æ€æ‰å¹³åŒ–** - é¿å…æ·±å±‚åµŒå¥—çš„å¯¹è±¡
3. **åˆç†æ‹†åˆ†çŠ¶æ€** - ç›¸å…³çŠ¶æ€æ”¾ä¸€èµ·ï¼Œä¸ç›¸å…³çŠ¶æ€åˆ†å¼€
4. **ä½¿ç”¨æ´¾ç”ŸçŠ¶æ€** - ä»å…¶ä»–çŠ¶æ€è®¡ç®—å¾—å‡ºçš„å€¼ä¸éœ€è¦ç”¨useState
5. **æƒ°æ€§åˆå§‹åŒ–** - å¤æ‚åˆå§‹è®¡ç®—åªåœ¨åˆæ¬¡æ¸²æŸ“æ—¶æ‰§è¡Œ

</BestPractices>

### ä¸‹ä¸€æ­¥å­¦ä¹ 

ç°åœ¨ä½ å·²ç»æŒæ¡äº†useStateï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°†å­¦ä¹ ï¼š

1. **[useEffect](useEffect)** - ç†è§£å‰¯ä½œç”¨å’Œç”Ÿå‘½å‘¨æœŸ
2. **[useContext](useContext)** - å­¦ä¹ è·¨ç»„ä»¶çŠ¶æ€å…±äº«
3. **[useReducer](advanced/useReducer)** - æŒæ¡å¤æ‚çŠ¶æ€ç®¡ç†

---

## 11. å»¶ä¼¸é˜…è¯»

### å®˜æ–¹èµ„æº

- [useState APIå‚è€ƒ](https://react.dev/reference/react/useState) - Reactå®˜æ–¹æ–‡æ¡£
- [Hookè§„åˆ™](https://react.dev/reference/react) - Hookä½¿ç”¨è§„åˆ™
- [Stateæ›´æ–°è¯¦è§£](https://react.dev/learn/state-as-a-snapshot) - çŠ¶æ€å¿«ç…§æœºåˆ¶

### æ¨èé˜…è¯»

- [React Hookså®Œå…¨æŒ‡å—](https://legacy.reactjs.org/docs/hooks-intro.html) - Hooksè®¾è®¡æ€æƒ³
- [å‡½æ•°å¼æ›´æ–°è¯¦è§£](https://react.dev/reference/react/useState#updating-state-based-on-the-previous-state) - çŠ¶æ€æ›´æ–°æœºåˆ¶

---

[â† ä¸Šä¸€ç« ï¼šåŸºç¡€å…¥é—¨æ€»ç»“](foundations/forms) | [ä¸‹ä¸€ç« ï¼šuseEffect â†’](useEffect)
