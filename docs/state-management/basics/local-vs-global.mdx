# æœ¬åœ° vs å…¨å±€çŠ¶æ€ - çŠ¶æ€èŒƒå›´å†³ç­–æŒ‡å—

import { Tabs, TabItem } from '@docusaurus/theme-common';

åœ¨Reactåº”ç”¨ä¸­ï¼ŒçŠ¶æ€ç®¡ç†æ˜¯æ ¸å¿ƒæ¦‚å¿µä¹‹ä¸€ã€‚æ­£ç¡®åœ°å†³å®šå“ªäº›çŠ¶æ€åº”è¯¥æ˜¯å±€éƒ¨çš„ï¼ˆlocalï¼‰ï¼Œå“ªäº›åº”è¯¥æ˜¯å…¨å±€çš„ï¼ˆglobalï¼‰ï¼Œå¯¹äºæ„å»ºå¯ç»´æŠ¤ã€å¯æ‰©å±•çš„åº”ç”¨è‡³å…³é‡è¦ã€‚æœ¬ç« å°†æ·±å…¥æ¢è®¨çŠ¶æ€èŒƒå›´çš„å†³ç­–åŸåˆ™ã€å®é™…åº”ç”¨åœºæ™¯å’Œæœ€ä½³å®è·µã€‚

## æœ¬ç« å­¦ä¹ ç›®æ ‡

- ç†è§£æœ¬åœ°çŠ¶æ€å’Œå…¨å±€çŠ¶æ€çš„æ ¸å¿ƒæ¦‚å¿µ
- æŒæ¡çŠ¶æ€èŒƒå›´çš„å†³ç­–åŸåˆ™
- å­¦ä¼šè¯†åˆ«éœ€è¦å…¨å±€çŠ¶æ€çš„æƒ…å†µ
- æŒæ¡çŠ¶æ€æå‡ï¼ˆState Liftingï¼‰çš„æ—¶æœºå’Œæ–¹å¼
- ç†è§£çŠ¶æ€ç®¡ç†åº“çš„é€‰æ‹©æ ‡å‡†
- é¿å…å¸¸è§çš„çŠ¶æ€èŒƒå›´è¯¯åŒº
- æŒæ¡æ€§èƒ½ä¼˜åŒ–ä¸çŠ¶æ€èŒƒå›´çš„å¹³è¡¡

---

## 1. ä»€ä¹ˆæ˜¯çŠ¶æ€èŒƒå›´ï¼Ÿ

çŠ¶æ€èŒƒå›´æŒ‡çš„æ˜¯çŠ¶æ€å˜é‡åœ¨åº”ç”¨ä¸­çš„å¯è§æ€§å’Œå…±äº«èŒƒå›´ã€‚æ­£ç¡®ç†è§£çŠ¶æ€èŒƒå›´æ˜¯æ„å»ºå¯ç»´æŠ¤Reactåº”ç”¨çš„åŸºç¡€ã€‚

<Box style={{ padding: '20px', background: '#e3f2fd', borderRadius: '8px', margin: '20px 0' }}>
  <h4 style={{ margin: 0, color: '#1976d2' }}>ğŸ’¡ æ ¸å¿ƒæ¦‚å¿µ</h4>
  <p style={{ margin: '10px 0 0 0' }}>
    <strong>æœ¬åœ°çŠ¶æ€</strong>ï¼ˆLocal Stateï¼‰åªå­˜åœ¨äºå•ä¸ªç»„ä»¶å†…éƒ¨ï¼Œ<strong>å…¨å±€çŠ¶æ€</strong>ï¼ˆGlobal Stateï¼‰å¯ä»¥åœ¨åº”ç”¨çš„å¤šä¸ªç»„ä»¶ä¹‹é—´å…±äº«ã€‚é€‰æ‹©æ­£ç¡®çš„çŠ¶æ€èŒƒå›´å¯ä»¥æé«˜æ€§èƒ½å¹¶ç®€åŒ–ä»£ç ã€‚
  </p>
</Box>

<CodeBlock>

```jsx
// æœ¬åœ°çŠ¶æ€ - ä»…åœ¨Counterç»„ä»¶å†…ä½¿ç”¨
function Counter() {
  const [count, setCount] = useState(0);
  return <button onClick={() => setCount(c => c + 1)}>{count}</button>;
}

// å…¨å±€çŠ¶æ€ - å¤šä¸ªç»„ä»¶å…±äº«ç”¨æˆ·ä¿¡æ¯
const UserContext = createContext();

function App() {
  const [user, setUser] = useState(null);

  return (
    <UserContext.Provider value={{ user, setUser }}>
      <Header />
      <Main />
      <Footer />
    </UserContext.Provider>
  );
}

function Header() {
  const { user } = useContext(UserContext);
  return <div>{user ? `Welcome ${user.name}` : 'Please login'}</div>;
}
```

</CodeBlock>

### 1.1 çŠ¶æ€èŒƒå›´çš„åˆ†ç±»

<Grid>

<div>
  <h4>æœ¬åœ°çŠ¶æ€ (Local State)</h4>
  <ul>
    <li>ç»„ä»¶å†…éƒ¨ä½¿ç”¨</li>
    <li>ä¸éœ€è¦åœ¨å…¶ä»–ç»„ä»¶ä¸­å…±äº«</li>
    <li>ä½¿ç”¨useStateç®¡ç†</li>
    <li>ç»„ä»¶å¸è½½æ—¶é”€æ¯</li>
    <li>æ€§èƒ½å¼€é”€å°</li>
  </ul>
</div>

<div>
  <h4>å…¨å±€çŠ¶æ€ (Global State)</h4>
  <ul>
    <li>å¤šä¸ªç»„ä»¶éœ€è¦è®¿é—®</li>
    <li>è·¨ç»„ä»¶å±‚çº§å…±äº«</li>
    <li>ä½¿ç”¨Contextæˆ–çŠ¶æ€åº“</li>
    <li>åº”ç”¨ç”Ÿå‘½å‘¨æœŸå†…å­˜åœ¨</li>
    <li>éœ€è¦è°¨æ…ç®¡ç†æ€§èƒ½</li>
  </ul>
</div>

</Grid>

---

## 2. çŠ¶æ€èŒƒå›´å†³ç­–åŸåˆ™

æ­£ç¡®çš„çŠ¶æ€èŒƒå›´é€‰æ‹©éœ€è¦è€ƒè™‘å¤šä¸ªå› ç´ ã€‚éµå¾ªè¿™äº›åŸåˆ™å¯ä»¥é¿å…è¿‡åº¦å·¥ç¨‹åŒ–æˆ–æ€§èƒ½é—®é¢˜ã€‚

<CodeBlock>

```jsx
// å†³ç­–æ ‘ç¤ºä¾‹
function shouldBeGlobalState(state, componentTree) {
  // 1. å¤šä¸ªç»„ä»¶éœ€è¦è¿™ä¸ªçŠ¶æ€å—ï¼Ÿ
  if (!isSharedAcrossComponents(state)) {
    return makeLocalState(); // æœ¬åœ°çŠ¶æ€
  }

  // 2. çŠ¶æ€å˜åŒ–é¢‘ç‡é«˜å—ï¼Ÿ
  if (hasHighUpdateFrequency(state)) {
    return makeLocalWithOptimization(); // æœ¬åœ°çŠ¶æ€+ä¼˜åŒ–
  }

  // 3. æ˜¯å¦æ˜¯åº”ç”¨æ ¸å¿ƒä¸šåŠ¡çŠ¶æ€ï¼Ÿ
  if (isCoreBusinessState(state)) {
    return makeGlobalState(); // å…¨å±€çŠ¶æ€
  }

  // 4. æ˜¯å¦éœ€è¦æŒä¹…åŒ–ï¼Ÿ
  if (requiresPersistence(state)) {
    return makePersistentState(); // å…¨å±€çŠ¶æ€
  }

  return makeLocalState(); // é»˜è®¤æœ¬åœ°çŠ¶æ€
}
```

</CodeBlock>

### 2.1 å…³é”®å†³ç­–å› ç´ 

<Box style={{ padding: '20px', background: '#f3e5f5', borderRadius: '8px', margin: '20px 0' }}>
  <h4 style={{ margin: 0, color: '#7b1fa2' }}>ğŸ¯ å†³ç­–æ£€æŸ¥æ¸…å•</h4>
  <p style={{ margin: '10px 0 0 0' }}>
    åœ¨ç¡®å®šçŠ¶æ€èŒƒå›´å‰ï¼Œé—®è‡ªå·±ä»¥ä¸‹é—®é¢˜ï¼š
    <br />1ï¸âƒ£ æ˜¯å¦æœ‰å¤šä¸ªç»„ä»¶éœ€è¦è¿™ä¸ªçŠ¶æ€ï¼Ÿ
    <br />2ï¸âƒ£ çŠ¶æ€çš„æ›´æ”¹æ˜¯å¦é¢‘ç¹ï¼Ÿ
    <br />3ï¸âƒ£ çŠ¶æ€å˜åŒ–æ˜¯å¦å½±å“å¤šä¸ªä¸ç›¸å…³çš„ç»„ä»¶ï¼Ÿ
    <br />4ï¸âƒ£ æ˜¯å¦éœ€è¦è·¨è·¯ç”±å…±äº«çŠ¶æ€ï¼Ÿ
  </p>
</Box>

<CodeBlock>

```jsx
// ç¤ºä¾‹1ï¼šè¡¨å•è¾“å…¥ - æœ¬åœ°çŠ¶æ€
function ContactForm() {
  const [name, setName] = useState('');
  const [email, setEmail] = useState('');
  const [message, setMessage] = useState('');

  // âœ… åªæœ‰è¿™ä¸ªè¡¨å•éœ€è¦è¿™äº›çŠ¶æ€
  // âœ… ä¸éœ€è¦åœ¨å…¶ä»–ç»„ä»¶ä¸­è®¿é—®
  return (
    <form>
      <input value={name} onChange={(e) => setName(e.target.value)} />
      <input value={email} onChange={(e) => setEmail(e.target.value)} />
      <textarea value={message} onChange={(e) => setMessage(e.target.value)} />
    </form>
  );
}

// ç¤ºä¾‹2ï¼šç”¨æˆ·è®¤è¯ä¿¡æ¯ - å…¨å±€çŠ¶æ€
const AuthContext = createContext();

function AuthProvider({ children }) {
  const [user, setUser] = useState(null);
  const [token, setToken] = useState(null);

  // âœ… å¤šä¸ªç»„ä»¶éœ€è¦ç”¨æˆ·ä¿¡æ¯
  // âœ… ç™»å½•çŠ¶æ€å½±å“æ•´ä¸ªåº”ç”¨
  // âœ… éœ€è¦åœ¨è·¯ç”±é—´ä¿æŒçŠ¶æ€

  return (
    <AuthContext.Provider value={{ user, setUser, token, setToken }}>
      {children}
    </AuthContext.Provider>
  );
}

// ç¤ºä¾‹3ï¼šä¸»é¢˜è®¾ç½® - å…¨å±€çŠ¶æ€
const ThemeContext = createContext();

function ThemeProvider({ children }) {
  const [theme, setTheme] = useState('light');
  const [isDark, setIsDark] = useState(false);

  // âœ… å¤šä¸ªç»„ä»¶éœ€è¦çŸ¥é“å½“å‰ä¸»é¢˜
  // âœ… çŠ¶æ€å˜åŒ–å½±å“æ•´ä¸ªåº”ç”¨çš„å¤–è§‚
  // âœ… çŠ¶æ€éœ€è¦æŒä¹…åŒ–åˆ°localStorage

  return (
    <ThemeContext.Provider value={{ theme, setTheme, isDark, setIsDark }}>
      {children}
    </ThemeContext.Provider>
  );
}
```

</CodeBlock>

### 2.2 åæ¨¡å¼ï¼šè¿‡æ—©ä½¿ç”¨å…¨å±€çŠ¶æ€

<ErrorBox>

```jsx
// âŒ é”™è¯¯ - ä¸ºç®€å•çŠ¶æ€åˆ›å»ºå…¨å±€çŠ¶æ€
const GlobalCounterContext = createContext();

function App() {
  const [count, setCount] = useState(0);

  return (
    <GlobalCounterContext.Provider value={{ count, setCount }}>
      <Counter />
    </GlobalCounterContext.Provider>
  );
}

function Counter() {
  const { count, setCount } = useContext(GlobalCounterContext);
  // åªæœ‰è¿™ä¸€ä¸ªç»„ä»¶éœ€è¦count
  return <button onClick={() => setCount(c => c + 1)}>{count}</button>;
}

// âœ… æ­£ç¡® - ä½¿ç”¨æœ¬åœ°çŠ¶æ€
function Counter() {
  const [count, setCount] = useState(0);
  return <button onClick={() => setCount(c => c + 1)}>{count}</button>;
}
```

</ErrorBox>

---

## 3. æœ¬åœ°çŠ¶æ€ç®¡ç†

æœ¬åœ°çŠ¶æ€æ˜¯Reactåº”ç”¨çš„åŸºç¡€ã€‚æ­£ç¡®ä½¿ç”¨æœ¬åœ°çŠ¶æ€å¯ä»¥æé«˜æ€§èƒ½å¹¶ç®€åŒ–ä»£ç ã€‚

<CodeBlock>

```jsx
// åŸºç¡€æœ¬åœ°çŠ¶æ€
function LocalStateExample() {
  const [state, setState] = useState(initialValue);

  const updateState = (newValue) => {
    setState(newValue);
  };

  return (
    <div>
      {/* æ¸²æŸ“çŠ¶æ€ */}
    </div>
  );
}

// å¤æ‚æœ¬åœ°çŠ¶æ€
function ComplexLocalState() {
  const [formData, setFormData] = useState({
    name: '',
    email: '',
    preferences: {
      newsletter: true,
      notifications: false
    }
  });

  const updateField = (field, value) => {
    setFormData(prev => ({
      ...prev,
      [field]: value
    }));
  };

  const updateNestedField = (parent, field, value) => {
    setFormData(prev => ({
      ...prev,
      [parent]: {
        ...prev[parent],
        [field]: value
      }
    }));
  };

  return (
    <form>
      <input
        value={formData.name}
        onChange={(e) => updateField('name', e.target.value)}
      />
      <label>
        <input
          type="checkbox"
          checked={formData.preferences.newsletter}
          onChange={(e) =>
            updateNestedField('preferences', 'newsletter', e.target.checked)
          }
        />
        Subscribe to newsletter
      </label>
    </form>
  );
}
```

</CodeBlock>

### 3.1 çŠ¶æ€æå‡çš„æ—¶æœº

çŠ¶æ€æå‡æ˜¯å°†æœ¬åœ°çŠ¶æ€ç§»åŠ¨åˆ°çˆ¶ç»„ä»¶çš„æŠ€æœ¯ï¼Œé€šå¸¸æ˜¯ä¸ºäº†è®©å¤šä¸ªå­ç»„ä»¶å…±äº«çŠ¶æ€ã€‚

<CodeBlock>

```jsx
// æå‡å‰ï¼šä¸¤ä¸ªç‹¬ç«‹çš„çŠ¶æ€
function TemperatureInput({ label, temperature, onChange }) {
  return (
    <div>
      <label>{label}</label>
      <input
        value={temperature}
        onChange={(e) => onChange(e.target.value)}
      />
    </div>
  );
}

function CelsiusInput() {
  const [celsius, setCelsius] = useState('');
  return (
    <TemperatureInput
      label="Celsius"
      temperature={celsius}
      onChange={setCelsius}
    />
  );
}

function FahrenheitInput() {
  const [fahrenheit, setFahrenheit] = useState('');
  return (
    <TemperatureInput
      label="Fahrenheit"
      temperature={fahrenheit}
      onChange={setFahrenheit}
    />
  );
}

// æå‡åï¼šå…±äº«çŠ¶æ€åœ¨çˆ¶ç»„ä»¶
function TemperatureConverter() {
  const [celsius, setCelsius] = useState('');
  const [fahrenheit, setFahrenheit] = useState('');

  const handleCelsiusChange = (value) => {
    setCelsius(value);
    setFahrenheit(celsiusToFahrenheit(value));
  };

  const handleFahrenheitChange = (value) => {
    setFahrenheit(value);
    setCelsius(fahrenheitToCelsius(value));
  };

  return (
    <div>
      <TemperatureInput
        label="Celsius"
        temperature={celsius}
        onChange={handleCelsiusChange}
      />
      <TemperatureInput
        label="Fahrenheit"
        temperature={fahrenheit}
        onChange={handleFahrenheitChange}
      />
    </div>
  );
}
```

</CodeBlock>

### 3.2 æ€§èƒ½ä¼˜åŒ–ï¼šæœ¬åœ°çŠ¶æ€

<CodeBlock>

```jsx
// ä½¿ç”¨useCallbacké¿å…ä¸å¿…è¦çš„é‡æ¸²æŸ“
function OptimizedComponent() {
  const [count, setCount] = useState(0);
  const [data, setData] = useState([]);

  // ç¼“å­˜äº‹ä»¶å¤„ç†å™¨
  const handleIncrement = useCallback(() => {
    setCount(c => c + 1);
  }, []);

  const handleDataLoad = useCallback(async () => {
    const result = await fetchData();
    setData(result);
  }, []);

  return (
    <div>
      <button onClick={handleIncrement}>Count: {count}</button>
      <button onClick={handleDataLoad}>Load Data</button>
      <DataList data={data} />
    </div>
  );
}

// ä½¿ç”¨useMemoç¼“å­˜è®¡ç®—ç»“æœ
function ExpensiveComponent({ items }) {
  const [filter, setFilter] = useState('');

  // åªåœ¨itemsæˆ–filterå˜åŒ–æ—¶é‡æ–°è®¡ç®—
  const filteredItems = useMemo(() => {
    return items.filter(item =>
      item.name.toLowerCase().includes(filter.toLowerCase())
    );
  }, [items, filter]);

  return (
    <div>
      <input
        value={filter}
        onChange={(e) => setFilter(e.target.value)}
        placeholder="Filter items..."
      />
      <ul>
        {filteredItems.map(item => (
          <li key={item.id}>{item.name}</li>
        ))}
      </ul>
    </div>
  );
}
```

</CodeBlock>

---

## 4. å…¨å±€çŠ¶æ€ç®¡ç†

å½“å¤šä¸ªç»„ä»¶éœ€è¦å…±äº«çŠ¶æ€æ—¶ï¼Œæˆ–è€…çŠ¶æ€éœ€è¦åœ¨åº”ç”¨çš„ä¸åŒéƒ¨åˆ†ä¹‹é—´ä¿æŒä¸€è‡´æ—¶ï¼Œå…¨å±€çŠ¶æ€ç®¡ç†å˜å¾—å¿…è¦ã€‚

<CodeBlock>

```jsx
// Context API - Reactå†…ç½®å…¨å±€çŠ¶æ€
const UserContext = createContext();

function UserProvider({ children }) {
  const [user, setUser] = useState(null);
  const [isLoading, setIsLoading] = useState(false);

  const login = async (credentials) => {
    setIsLoading(true);
    try {
      const userData = await api.login(credentials);
      setUser(userData);
    } finally {
      setIsLoading(false);
    }
  };

  const logout = () => {
    setUser(null);
  };

  const value = {
    user,
    isLoading,
    login,
    logout,
    isAuthenticated: !!user
  };

  return (
    <UserContext.Provider value={value}>
      {children}
    </UserContext.Provider>
  );
}

// ä½¿ç”¨å…¨å±€çŠ¶æ€
function Header() {
  const { user, logout, isAuthenticated } = useContext(UserContext);

  if (!isAuthenticated) {
    return <Link to="/login">Login</Link>;
  }

  return (
    <div>
      <span>Welcome, {user.name}</span>
      <button onClick={logout}>Logout</button>
    </div>
  );
}
```

</CodeBlock>

### 4.1 çŠ¶æ€æå‡ vs å…¨å±€çŠ¶æ€

<Compare>

```jsx
// çŠ¶æ€æå‡ - ä¸­ç­‰èŒƒå›´å…±äº«
function ParentComponent() {
  const [sharedState, setSharedState] = useState(initialValue);

  return (
    <div>
      <ChildA state={sharedState} setState={setSharedState} />
      <ChildB state={sharedState} setState={setSharedState} />
    </div>
  );
}

// Context - å¹¿æ³›èŒƒå›´å…±äº«
function App() {
  return (
    <GlobalContext.Provider value={globalState}>
      <Component1 />
      <Component2 />
      <Component3 />
    </GlobalContext.Provider>
  );
}

// çŠ¶æ€ç®¡ç†åº“ - å¤æ‚å…¨å±€çŠ¶æ€
const store = createStore(reducer, initialState);

function App() {
  return (
    <Provider store={store}>
      <Component1 />
      <Component2 />
    </Provider>
  );
}
```

</Compare>

### 4.2 Contextæ¨¡å¼æœ€ä½³å®è·µ

<CodeBlock>

```jsx
// æœ€ä½³å®è·µ1ï¼šæ‹†åˆ†Context
const AuthContext = createContext();
const ThemeContext = createContext();
const NotificationContext = createContext();

// è€Œä¸æ˜¯ä¸€ä¸ªå¤§è€Œå…¨çš„Context
const AppContext = createContext(); // âŒ é¿å…

// æœ€ä½³å®è·µ2ï¼šä½¿ç”¨Providerç»„åˆ
function AppProviders({ children }) {
  return (
    <AuthProvider>
      <ThemeProvider>
        <NotificationProvider>
          {children}
        </NotificationProvider>
      </ThemeProvider>
    </AuthProvider>
  );
}

// æœ€ä½³å®è·µ3ï¼šæä¾›è‡ªå®šä¹‰Hook
function useAuth() {
  const context = useContext(AuthContext);
  if (!context) {
    throw new Error('useAuth must be used within AuthProvider');
  }
  return context;
}

// ä½¿ç”¨
function Header() {
  const { user, logout } = useAuth();
  // ä¸éœ€è¦ç›´æ¥ä½¿ç”¨useContext
  return <div>{user.name}</div>;
}
```

</CodeBlock>

---

## 5. å®é™…åº”ç”¨åœºæ™¯

### 5.1 éœ€è¦å…¨å±€çŠ¶æ€çš„åœºæ™¯

<Box style={{ padding: '20px', background: '#e8f5e9', borderRadius: '8px', margin: '20px 0' }}>
  <h4 style={{ margin: 0, color: '#2e7d32' }}>âœ… é€‚åˆå…¨å±€çŠ¶æ€çš„åœºæ™¯</h4>
  <p style={{ margin: '10px 0 0 0' }}>
    ä»¥ä¸‹åœºæ™¯é€šå¸¸éœ€è¦è€ƒè™‘å…¨å±€çŠ¶æ€ç®¡ç†ï¼š
  </p>
</Box>

<CodeBlock>

```jsx
// åœºæ™¯1ï¼šç”¨æˆ·è®¤è¯çŠ¶æ€
// éœ€è¦åœ¨å¤šä¸ªç»„ä»¶ä¸­æ£€æŸ¥ç”¨æˆ·æ˜¯å¦ç™»å½•
function useAuth() {
  const [user, setUser] = useState(null);
  const [token, setToken] = useState(null);

  return { user, token, isAuthenticated: !!user };
}

// åœºæ™¯2ï¼šä¸»é¢˜å’Œå›½é™…åŒ–
// åº”ç”¨çš„å¤–è§‚å’Œè¯­è¨€è®¾ç½®éœ€è¦å…¨å±€ä¸€è‡´
function useTheme() {
  const [theme, setTheme] = useState('light');
  const [locale, setLocale] = useState('en');

  return { theme, setTheme, locale, setLocale };
}

// åœºæ™¯3ï¼šè´­ç‰©è½¦çŠ¶æ€
// è´­ç‰©è½¦æ•°æ®éœ€è¦åœ¨å¤šä¸ªé¡µé¢é—´ä¿æŒä¸€è‡´
function useCart() {
  const [items, setItems] = useState([]);
  const [total, setTotal] = useState(0);

  const addItem = (item) => {
    setItems(prev => [...prev, item]);
    setTotal(prev => prev + item.price);
  };

  const removeItem = (itemId) => {
    setItems(prev => prev.filter(item => item.id !== itemId));
  };

  return { items, total, addItem, removeItem };
}

// åœºæ™¯4ï¼šå…¨å±€åŠ è½½çŠ¶æ€
// æ˜¾ç¤ºå…¨å±€çš„åŠ è½½æŒ‡ç¤ºå™¨
function useGlobalLoading() {
  const [loadingCount, setLoadingCount] = useState(0);
  const isLoading = loadingCount > 0;

  const startLoading = () => setLoadingCount(c => c + 1);
  const stopLoading = () => setLoadingCount(c => Math.max(0, c - 1));

  return { isLoading, startLoading, stopLoading };
}
```

</CodeBlock>

### 5.2 ä¿æŒæœ¬åœ°çŠ¶æ€çš„åœºæ™¯

<Box style={{ padding: '20px', background: '#fff3e0', borderRadius: '8px', margin: '20px 0' }}>
  <h4 style={{ margin: 0, color: '#e65100' }}>âš ï¸ é€‚åˆæœ¬åœ°çŠ¶æ€çš„åœºæ™¯</h4>
  <p style={{ margin: '10px 0 0 0' }}>
    ä»¥ä¸‹åœºæ™¯åº”è¯¥ä¿æŒçŠ¶æ€ä¸ºæœ¬åœ°çŠ¶æ€ï¼š
  </p>
</Box>

<CodeBlock>

```jsx
// åœºæ™¯1ï¼šè¡¨å•è¾“å…¥
// æ¯ä¸ªè¡¨å•å­—æ®µéƒ½æ˜¯ç‹¬ç«‹çš„ï¼Œä¸éœ€è¦å…±äº«
function FormField({ label, type = 'text' }) {
  const [value, setValue] = useState('');
  const [error, setError] = useState('');

  return (
    <div>
      <label>{label}</label>
      <input
        type={type}
        value={value}
        onChange={(e) => setValue(e.target.value)}
      />
      {error && <span className="error">{error}</span>}
    </div>
  );
}

// åœºæ™¯2ï¼šç»„ä»¶å†…éƒ¨UIçŠ¶æ€
// ä¾‹å¦‚æ¨¡æ€æ¡†çš„æ‰“å¼€/å…³é—­çŠ¶æ€
function Modal({ isOpen, onClose, children }) {
  const [isAnimating, setIsAnimating] = useState(false);

  if (!isOpen) return null;

  return (
    <div className="modal-overlay" onClick={onClose}>
      <div
        className="modal-content"
        onClick={(e) => e.stopPropagation()}
      >
        {children}
      </div>
    </div>
  );
}

// åœºæ™¯3ï¼šä¸´æ—¶è®¡ç®—çŠ¶æ€
// ä¸éœ€è¦æŒä¹…åŒ–çš„ä¸­é—´è®¡ç®—ç»“æœ
function DataProcessor({ data }) {
  const [sortConfig, setSortConfig] = useState({ key: null, direction: 'asc' });
  const [filter, setFilter] = useState('');

  // è¿™äº›çŠ¶æ€åªåœ¨å½“å‰ç»„ä»¶ä¸­ä½¿ç”¨
  const processedData = useMemo(() => {
    let result = [...data];

    if (filter) {
      result = result.filter(item =>
        item.name.toLowerCase().includes(filter.toLowerCase())
      );
    }

    if (sortConfig.key) {
      result.sort((a, b) => {
        if (a[sortConfig.key] < b[sortConfig.key]) {
          return sortConfig.direction === 'asc' ? -1 : 1;
        }
        if (a[sortConfig.key] > b[sortConfig.key]) {
          return sortConfig.direction === 'asc' ? 1 : -1;
        }
        return 0;
      });
    }

    return result;
  }, [data, filter, sortConfig]);

  return <DataList data={processedData} />;
}
```

</CodeBlock>

---

## 6. çŠ¶æ€ç®¡ç†åº“é€‰æ‹©æŒ‡å—

ä¸åŒçš„çŠ¶æ€ç®¡ç†æ–¹æ¡ˆé€‚åˆä¸åŒçš„åœºæ™¯ã€‚é€‰æ‹©æ­£ç¡®çš„å·¥å…·å¯ä»¥ç®€åŒ–å¼€å‘å¹¶æé«˜æ€§èƒ½ã€‚

<CodeBlock>

```jsx
// 1. Reactå†…ç½®æ–¹æ¡ˆ - Context API
// é€‚åˆï¼šä¸­ç­‰å¤æ‚åº¦çš„å…¨å±€çŠ¶æ€
// ä¼˜ç‚¹ï¼šæ— éœ€é¢å¤–ä¾èµ–ï¼ŒReactåŸç”Ÿæ”¯æŒ
// ç¼ºç‚¹ï¼šæ€§èƒ½éœ€è¦æ‰‹åŠ¨ä¼˜åŒ–

const SimpleContext = createContext();

// ä½¿ç”¨
function SimpleProvider({ children }) {
  const [state, setState] = useState(initialValue);
  const value = useMemo(() => ({ state, setState }), [state]);

  return (
    <SimpleContext.Provider value={value}>
      {children}
    </SimpleContext.Provider>
  );
}

// 2. Zustand - è½»é‡çº§çŠ¶æ€ç®¡ç†
// é€‚åˆï¼šç®€å•åˆ°ä¸­ç­‰å¤æ‚åº¦çš„çŠ¶æ€
// ä¼˜ç‚¹ï¼šAPIç®€å•ï¼Œæ ·æ¿ä»£ç å°‘ï¼Œæ€§èƒ½å¥½
// ç¼ºç‚¹ï¼šç”Ÿæ€ç³»ç»Ÿè¾ƒå°

import { create } from 'zustand';

const useStore = create((set) => ({
  user: null,
  setUser: (user) => set({ user }),
  clearUser: () => set({ user: null }),
}));

// ä½¿ç”¨
function MyComponent() {
  const { user, setUser } = useStore();
  // è‡ªåŠ¨ä¼˜åŒ–æ›´æ–°ï¼Œåªæœ‰ä½¿ç”¨çš„å­—æ®µå˜åŒ–æ—¶æ‰é‡æ¸²æŸ“
}

// 3. Redux Toolkit - å·¥ä¸šçº§çŠ¶æ€ç®¡ç†
// é€‚åˆï¼šå¤æ‚åº”ç”¨ï¼Œå›¢é˜Ÿåä½œ
// ä¼˜ç‚¹ï¼šç”Ÿæ€ç³»ç»Ÿæˆç†Ÿï¼Œå¼€å‘å·¥å…·å®Œå–„
// ç¼ºç‚¹ï¼šå­¦ä¹ æ›²çº¿é™¡å³­ï¼Œæ ·æ¿ä»£ç å¤š

import { createSlice, configureStore } from '@reduxjs/toolkit';

const userSlice = createSlice({
  name: 'user',
  initialState: { user: null, status: 'idle' },
  reducers: {
    setUser: (state, action) => {
      state.user = action.payload;
    },
    clearUser: (state) => {
      state.user = null;
    },
  },
});

const store = configureStore({
  reducer: {
    user: userSlice.reducer,
  },
});

// 4. Jotai - åŸå­åŒ–çŠ¶æ€
// é€‚åˆï¼šç»†ç²’åº¦çŠ¶æ€ç®¡ç†ï¼Œå¤æ‚ä¾èµ–
// ä¼˜ç‚¹ï¼šåŸå­åŒ–ï¼Œä¾èµ–è¿½è¸ªç²¾ç»†
// ç¼ºç‚¹ï¼šæ¦‚å¿µæ–°é¢–ï¼Œè°ƒè¯•å›°éš¾

import { atom, useAtom } from 'jotai';

const userAtom = atom(null);
const userNameAtom = atom((get) => get(userAtom)?.name);

function MyComponent() {
  const [user, setUser] = useAtom(userAtom);
  const [userName] = useAtom(userNameAtom);
  // åªåœ¨å®é™…ä½¿ç”¨çš„åŸå­å˜åŒ–æ—¶é‡æ¸²æŸ“
}
```

</CodeBlock>

### 6.1 é€‰æ‹©å†³ç­–æ ‘

<CodeBlock>

```jsx
function chooseStateManagement(requirements) {
  const {
    teamSize,
    complexity,
    performance,
    learningCurve,
    ecosystem
  } = requirements;

  // å†³ç­–é€»è¾‘
  if (complexity === 'low' && teamSize <= 3) {
    if (performance === 'high') {
      return 'zustand'; // è½»é‡ä¸”é«˜æ€§èƒ½
    }
    return 'context'; // ç®€å•ç”¨Reactå†…ç½®
  }

  if (complexity === 'medium' && teamSize <= 5) {
    if (performance === 'high') {
      return 'zustand'; // æ€§èƒ½å¥½
    }
    return 'redux-toolkit'; // åŠŸèƒ½å…¨é¢
  }

  if (complexity === 'high' || teamSize > 5) {
    return 'redux-toolkit'; // å·¥ä¸šçº§è§£å†³æ–¹æ¡ˆ
  }

  if (requiresAtomicUpdates) {
    return 'jotai'; // åŸå­åŒ–æ›´æ–°
  }

  return 'context'; // é»˜è®¤é€‰æ‹©
}

// ä½¿ç”¨ç¤ºä¾‹
const requirements = {
  teamSize: 3,
  complexity: 'medium',
  performance: 'high',
  learningCurve: 'low',
  ecosystem: 'mature'
};

const solution = chooseStateManagement(requirements);
console.log(`æ¨èä½¿ç”¨: ${solution}`);
```

</CodeBlock>

### 6.2 å¯¹æ¯”è¡¨

<Table>

| æ–¹æ¡ˆ | å­¦ä¹ æ›²çº¿ | æ€§èƒ½ | æ ·æ¿ä»£ç  | ç”Ÿæ€ç³»ç»Ÿ | é€‚ç”¨åœºæ™¯ |
|------|----------|------|----------|----------|----------|
| Context API | ä½ | ä¸­ | ä½ | åŸç”Ÿ | ç®€å•å…¨å±€çŠ¶æ€ |
| Zustand | ä½ | é«˜ | æä½ | ä¸­ç­‰ | è½»é‡çº§åº”ç”¨ |
| Redux Toolkit | ä¸­ | é«˜ | ä¸­ | æˆç†Ÿ | å¤æ‚ä¼ä¸šåº”ç”¨ |
| Jotai | ä¸­ | é«˜ | ä½ | æ–°å…´ | ç»†ç²’åº¦çŠ¶æ€ |

</Table>

---

## 7. çŠ¶æ€æŒä¹…åŒ–

æŸäº›çŠ¶æ€éœ€è¦æŒä¹…åŒ–åˆ°æœ¬åœ°å­˜å‚¨ï¼ˆlocalStorageã€sessionStorageï¼‰æˆ–æœåŠ¡å™¨ï¼Œä»¥åœ¨é¡µé¢åˆ·æ–°åä¿æŒçŠ¶æ€ã€‚

<CodeBlock>

```jsx
// æœ¬åœ°å­˜å‚¨æŒä¹…åŒ–
function useLocalStorageState(key, initialValue) {
  const [state, setState] = useState(() => {
    try {
      const item = window.localStorage.getItem(key);
      return item ? JSON.parse(item) : initialValue;
    } catch (error) {
      console.error(`Error reading localStorage key "${key}":`, error);
      return initialValue;
    }
  });

  const setValue = (value) => {
    try {
      setState(value);
      window.localStorage.setItem(key, JSON.stringify(value));
    } catch (error) {
      console.error(`Error setting localStorage key "${key}":`, error);
    }
  };

  return [state, setValue];
}

// ä½¿ç”¨
function Settings() {
  const [theme, setTheme] = useLocalStorageState('theme', 'light');
  const [language, setLanguage] = useLocalStorageState('language', 'en');

  return (
    <div>
      <select value={theme} onChange={(e) => setTheme(e.target.value)}>
        <option value="light">Light</option>
        <option value="dark">Dark</option>
      </select>
    </div>
  );
}

// æœåŠ¡å™¨æŒä¹…åŒ–
function useServerSync(key, initialValue) {
  const [state, setState] = useState(initialValue);
  const [isSyncing, setIsSyncing] = useState(false);

  useEffect(() => {
    // ä»æœåŠ¡å™¨åŠ è½½çŠ¶æ€
    const loadState = async () => {
      try {
        const response = await fetch(`/api/state/${key}`);
        const data = await response.json();
        setState(data);
      } catch (error) {
        console.error('Failed to load state:', error);
      }
    };

    loadState();
  }, [key]);

  const updateState = async (newValue) => {
    setIsSyncing(true);
    try {
      setState(newValue);
      await fetch(`/api/state/${key}`, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(newValue),
      });
    } catch (error) {
      console.error('Failed to sync state:', error);
      // å›æ»šåˆ°ä¹‹å‰çš„çŠ¶æ€
      setState(state);
    } finally {
      setIsSyncing(false);
    }
  };

  return [state, updateState, isSyncing];
}
```

</CodeBlock>

### 7.1 æŒä¹…åŒ–ç­–ç•¥

<CodeBlock>

```jsx
// ç­–ç•¥1ï¼šå»¶è¿ŸæŒä¹…åŒ–
function useDelayedPersist(key, initialValue, delay = 1000) {
  const [state, setState] = useState(initialValue);
  const timeoutRef = useRef();

  const setValue = (value) => {
    setState(value);

    // æ¸…é™¤ä¹‹å‰çš„å®šæ—¶å™¨
    if (timeoutRef.current) {
      clearTimeout(timeoutRef.current);
    }

    // è®¾ç½®æ–°çš„å®šæ—¶å™¨
    timeoutRef.current = setTimeout(() => {
      localStorage.setItem(key, JSON.stringify(value));
    }, delay);
  };

  useEffect(() => {
    return () => {
      if (timeoutRef.current) {
        clearTimeout(timeoutRef.current);
      }
    };
  }, []);

  return [state, setValue];
}

// ç­–ç•¥2ï¼šæ¡ä»¶æŒä¹…åŒ–
function useConditionalPersist(key, initialValue, shouldPersist) {
  const [state, setState] = useState(initialValue);

  useEffect(() => {
    if (shouldPersist(state)) {
      localStorage.setItem(key, JSON.stringify(state));
    }
  }, [key, state, shouldPersist]);

  return [state, setState];
}

// ä½¿ç”¨ç¤ºä¾‹ï¼šåªæœ‰å½“ç”¨æˆ·å·²ç™»å½•æ—¶æ‰æŒä¹…åŒ–
function useAuthenticatedPersist(key, initialValue) {
  const { isAuthenticated } = useAuth();

  return useConditionalPersist(
    key,
    initialValue,
    () => isAuthenticated
  );
}
```

</CodeBlock>

---

## 8. æ€§èƒ½ä¼˜åŒ–ä¸çŠ¶æ€ç®¡ç†

çŠ¶æ€ç®¡ç†ç›´æ¥å½±å“åº”ç”¨æ€§èƒ½ã€‚äº†è§£ä½•æ—¶ä»¥åŠå¦‚ä½•ä¼˜åŒ–çŠ¶æ€æ›´æ–°æ˜¯è‡³å…³é‡è¦çš„ã€‚

<CodeBlock>

```jsx
// ä¼˜åŒ–1ï¼šæœ€å°åŒ–çŠ¶æ€æ›´æ–°èŒƒå›´
function OptimizedList({ items }) {
  const [selectedId, setSelectedId] = useState(null);
  const [hoveredId, setHoveredId] = useState(null);

  return (
    <ul>
      {items.map(item => (
        <ListItem
          key={item.id}
          item={item}
          isSelected={item.id === selectedId}
          isHovered={item.id === hoveredId}
          onSelect={() => setSelectedId(item.id)}
          onHover={() => setHoveredId(item.id)}
          onLeave={() => setHoveredId(null)}
        />
      ))}
    </ul>
  );
}

// ä¼˜åŒ–2ï¼šä½¿ç”¨é€‰æ‹©å™¨é¿å…ä¸å¿…è¦çš„é‡æ¸²æŸ“
function useSelector(store, selector) {
  const [, forceUpdate] = useReducer(x => x + 1, 0);
  const latestSelector = useRef(selector);
  const latestSelectedValue = useRef();

  useEffect(() => {
    latestSelector.current = selector;
  }, [selector]);

  const value = store.getState();
  const selectedValue = latestSelector.current(value);

  if (!shallowEqual(latestSelectedValue.current, selectedValue)) {
    latestSelectedValue.current = selectedValue;
    forceUpdate();
  }

  return latestSelectedValue.current;
}

// ä¼˜åŒ–3ï¼šçŠ¶æ€å½’ä¸€åŒ–
function useNormalizedState() {
  const [state, setState] = useState({
    byId: {},
    allIds: []
  });

  const addItem = (item) => {
    setState(prev => ({
      byId: {
        ...prev.byId,
        [item.id]: item
      },
      allIds: [...prev.allIds, item.id]
    }));
  };

  const updateItem = (id, updates) => {
    setState(prev => ({
      ...prev,
      byId: {
        ...prev.byId,
        [id]: { ...prev.byId[id], ...updates }
      }
    }));
  };

  const getItem = (id) => state.byId[id];
  const getAllItems = () => state.allIds.map(id => state.byId[id]);

  return { state, addItem, updateItem, getItem, getAllItems };
}
```

</CodeBlock>

### 8.1 çŠ¶æ€æ›´æ–°æ¨¡å¼

<CodeBlock>

```jsx
// æ‰¹é‡æ›´æ–° - å‡å°‘é‡æ¸²æŸ“æ¬¡æ•°
function useBatchUpdate() {
  const [state, setState] = useState(initialState);
  const updateQueue = useRef([]);
  const [batchedState, setBatchedState] = useState(initialState);

  const queueUpdate = (update) => {
    updateQueue.current.push(update);
  };

  const flushUpdates = () => {
    setState(prev => {
      const nextState = updateQueue.current.reduce(
        (state, update) => update(state),
        prev
      );
      updateQueue.current = [];
      return nextState;
    });
  };

  // è‡ªåŠ¨æ‰¹é‡æ›´æ–°
  useEffect(() => {
    const timeoutId = setTimeout(() => {
      flushUpdates();
    }, 0);

    return () => clearTimeout(timeoutId);
  }, [state]);

  return [state, queueUpdate];
}

// ä¸å¯å˜æ›´æ–°
function useImmutableUpdates() {
  const [state, setState] = useState({
    user: { name: '', email: '' },
    settings: { theme: 'light' }
  });

  const updateUser = (updates) => {
    setState(prev => ({
      ...prev,
      user: { ...prev.user, ...updates }
    }));
  };

  const updateNestedSettings = (path, value) => {
    setState(prev => {
      const newState = { ...prev };
      let current = newState;

      for (let i = 0; i < path.length - 1; i++) {
        current[path[i]] = { ...current[path[i]] };
        current = current[path[i]];
      }

      current[path[path.length - 1]] = value;
      return newState;
    });
  };

  return { state, updateUser, updateNestedSettings };
}
```

</CodeBlock>

---

## 9. å¸¸è§é™·é˜±ä¸è§£å†³æ–¹æ¡ˆ

### é™·é˜±1ï¼šè¿‡åº¦ä½¿ç”¨å…¨å±€çŠ¶æ€

<ErrorBox>

```jsx
// âŒ é”™è¯¯ - æ‰€æœ‰çŠ¶æ€éƒ½å…¨å±€åŒ–
const GlobalAppState = createContext();

function App() {
  const [counter, setCounter] = useState(0);
  const [formData, setFormData] = useState({});
  const [filter, setFilter] = useState('');

  return (
    <GlobalAppState.Provider value={{
      counter, setCounter,
      formData, setFormData,
      filter, setFilter
    }}>
      <Counter />
      <Form />
      <Filter />
    </GlobalAppState.Provider>
  );
}

// âœ… æ­£ç¡® - åªå°†æœ‰æ„ä¹‰çš„çŠ¶æ€å…¨å±€åŒ–
const AuthContext = createContext();

function App() {
  const [user, setUser] = useState(null);

  return (
    <AuthContext.Provider value={{ user, setUser }}>
      <Counter /> {/* è‡ªå·±çš„æœ¬åœ°çŠ¶æ€ */}
      <Form /> {/* è‡ªå·±çš„æœ¬åœ°çŠ¶æ€ */}
      <Header user={user} /> {/* åªä¼ é€’éœ€è¦çš„ */}
    </AuthContext.Provider>
  );
}
```

</ErrorBox>

### é™·é˜±2ï¼šçŠ¶æ€æ›´æ–°å¯¼è‡´çº§è”é‡æ¸²æŸ“

<ErrorBox>

```jsx
// âŒ é”™è¯¯ - é¢‘ç¹æ›´æ–°å…¨å±€çŠ¶æ€
function BadGlobalCounter() {
  const [count, setCount] = useState(0);
  const [timestamp, setTimestamp] = useState(Date.now());

  const increment = () => {
    setCount(c => c + 1);
    setTimestamp(Date.now()); // æ¯æ¬¡éƒ½æ›´æ–°ï¼Œå¯¼è‡´æ‰€æœ‰è®¢é˜…ç»„ä»¶é‡æ¸²æŸ“
  };

  return <button onClick={increment}>Count: {count}</button>;
}

// âœ… æ­£ç¡® - åªæ›´æ–°å¿…è¦çš„éƒ¨åˆ†
function GoodGlobalCounter() {
  const [count, setCount] = useState(0);

  const increment = useCallback(() => {
    setCount(c => c + 1);
  }, []);

  return <button onClick={increment}>Count: {count}</button>;
}

// æˆ–è€…åˆ†ç¦»å…³æ³¨ç‚¹
const CountContext = createContext();
const TimestampContext = createContext();
```

</ErrorBox>

### é™·é˜±3ï¼šå¿˜è®°æ¸…ç†å‰¯ä½œç”¨

<ErrorBox>

```jsx
// âŒ é”™è¯¯ - å†…å­˜æ³„æ¼
function BadComponent() {
  const [data, setData] = useState(null);

  useEffect(() => {
    let isMounted = true;

    fetchData().then(result => {
      if (isMounted) {
        setData(result);
      }
    });

    return () => {
      // ç¼ºå°‘æ¸…ç†
    };
  }, []);

  return <div>{data}</div>;
}

// âœ… æ­£ç¡® - æ¸…ç†å‰¯ä½œç”¨
function GoodComponent() {
  const [data, setData] = useState(null);

  useEffect(() => {
    let isMounted = true;
    let timeoutId;

    const loadData = async () => {
      const result = await fetchData();
      if (isMounted) {
        setData(result);
      }
    };

    loadData();

    return () => {
      isMounted = false;
      if (timeoutId) {
        clearTimeout(timeoutId);
      }
    };
  }, []);

  return <div>{data}</div>;
}
```

</ErrorBox>

---

## 10. å®è·µç»ƒä¹ 

### ç»ƒä¹ 1ï¼šçŠ¶æ€èŒƒå›´å†³ç­–

<Expandable title="ç‚¹å‡»æŸ¥çœ‹è¦æ±‚">

**åŠŸèƒ½è¦æ±‚**ï¼š
- åˆ†æç»™å®šçš„åº”ç”¨åœºæ™¯
- åˆ¤æ–­æ¯ä¸ªçŠ¶æ€åº”è¯¥æ˜¯æœ¬åœ°è¿˜æ˜¯å…¨å±€
- è§£é‡Šå†³ç­–ç†ç”±

**åœºæ™¯åˆ—è¡¨**ï¼š
1. ç”¨æˆ·åœ¨è¡¨å•ä¸­è¾“å…¥çš„ä¸´æ—¶æ–‡æœ¬
2. å½“å‰ç™»å½•ç”¨æˆ·çš„ä¿¡æ¯
3. æ¨¡æ€æ¡†çš„æ‰“å¼€/å…³é—­çŠ¶æ€
4. è´­ç‰©è½¦ä¸­çš„å•†å“åˆ—è¡¨
5. ä¸»é¢˜åˆ‡æ¢è®¾ç½®
6. ç»„ä»¶å†…éƒ¨çš„è®¡æ•°å™¨

**ä»»åŠ¡**ï¼š
- ä¸ºæ¯ä¸ªåœºæ™¯æä¾›çŠ¶æ€èŒƒå›´å»ºè®®
- è§£é‡Šä¸ºä»€ä¹ˆé€‰æ‹©è¯¥èŒƒå›´
- æå‡ºå®ç°æ–¹æ¡ˆ

</Expandable>

### ç»ƒä¹ 2ï¼šå®ç°çŠ¶æ€ç®¡ç†æ–¹æ¡ˆ

<Expandable title="ç‚¹å‡»æŸ¥çœ‹è¦æ±‚">

**åŠŸèƒ½è¦æ±‚**ï¼š
- é€‰æ‹©åˆé€‚çš„çŠ¶æ€ç®¡ç†æ–¹æ¡ˆ
- å®ç°ä¸€ä¸ªç”¨æˆ·åå¥½è®¾ç½®ç³»ç»Ÿ
- åŒ…å«ä¸»é¢˜ã€è¯­è¨€ã€å­—ä½“å¤§å°ç­‰è®¾ç½®
- çŠ¶æ€éœ€è¦æŒä¹…åŒ–åˆ°localStorage

**å®ç°è¦æ±‚**ï¼š
```javascript
// éœ€è¦å®ç°çš„åŠŸèƒ½
- usePreferences Hookï¼šç®¡ç†æ‰€æœ‰åå¥½è®¾ç½®
- åå¥½è®¾ç½®ç»„ä»¶ï¼šå¯ä¿®æ”¹å„ç§è®¾ç½®
- è®¾ç½®é¢æ¿ï¼šæ˜¾ç¤ºæ‰€æœ‰å½“å‰è®¾ç½®
- æŒä¹…åŒ–ï¼šåˆ·æ–°é¡µé¢åè®¾ç½®ä¿æŒä¸å˜
```

**æŠ€æœ¯é€‰æ‹©**ï¼š
- Context API
- Zustand
- æˆ–å…¶ä»–é€‚åˆçš„æ–¹æ¡ˆ

</Expandable>

### ç»ƒä¹ 3ï¼šæ€§èƒ½ä¼˜åŒ–å®è·µ

<Expandable title="ç‚¹å‡»æŸ¥çœ‹è¦æ±‚">

**åŠŸèƒ½è¦æ±‚**ï¼š
- å®ç°ä¸€ä¸ªå¤§åˆ—è¡¨ç»„ä»¶ï¼ˆ1000+é¡¹ï¼‰
- åŒ…å«æœç´¢å’Œè¿‡æ»¤åŠŸèƒ½
- å®ç°è™šæ‹Ÿæ»šåŠ¨
- ä¼˜åŒ–çŠ¶æ€æ›´æ–°

**å®ç°è¦æ±‚**ï¼š
```javascript
// éœ€è¦å®ç°çš„åŠŸèƒ½
- VirtualList ç»„ä»¶ï¼šè™šæ‹Ÿæ»šåŠ¨åˆ—è¡¨
- useSearch Hookï¼šæœç´¢å’Œè¿‡æ»¤
- çŠ¶æ€ä¼˜åŒ–ï¼šé¿å…ä¸å¿…è¦çš„é‡æ¸²æŸ“
- æ€§èƒ½ç›‘æ§ï¼šæµ‹é‡æ¸²æŸ“æ—¶é—´
```

**æ€§èƒ½ç›®æ ‡**ï¼š
- åˆå§‹æ¸²æŸ“æ—¶é—´ < 100ms
- æœç´¢å“åº”æ—¶é—´ < 50ms
- æ»šåŠ¨å¸§ç‡ > 50fps

</Expandable>

### ç»ƒä¹ 4ï¼šçŠ¶æ€æŒä¹…åŒ–ç³»ç»Ÿ

<Expandable title="ç‚¹å‡»æŸ¥çœ‹è¦æ±‚">

**åŠŸèƒ½è¦æ±‚**ï¼š
- å®ç°ä¸€ä¸ªè¡¨å•Wizardï¼ˆå¤šæ­¥éª¤è¡¨å•ï¼‰
- æ¯ä¸ªæ­¥éª¤çš„çŠ¶æ€éœ€è¦ä¿å­˜
- æ”¯æŒå‰è¿›/åé€€
- åˆ·æ–°é¡µé¢åæ¢å¤ä¹‹å‰è¿›åº¦

**å®ç°è¦æ±‚**ï¼š
```javascript
// éœ€è¦å®ç°çš„åŠŸèƒ½
- MultiStepForm ç»„ä»¶ï¼šå¤šæ­¥éª¤è¡¨å•
- useWizardState Hookï¼šç®¡ç†WizardçŠ¶æ€
- æŒä¹…åŒ–ç­–ç•¥ï¼šlocalStorage + æœåŠ¡å™¨
- çŠ¶æ€æ¢å¤ï¼šé¡µé¢åŠ è½½æ—¶è‡ªåŠ¨æ¢å¤è¿›åº¦
```

**æŠ€æœ¯è¦æ±‚**ï¼š
- ä½¿ç”¨IndexedDBå­˜å‚¨å¤§é‡æ•°æ®
- å®ç°é˜²æŠ–ä¿å­˜
- é”™è¯¯å¤„ç†å’Œæ¢å¤æœºåˆ¶

</Expandable>

---

## 11. æœ¬ç« å°ç»“

### å…³é”®è¦ç‚¹

<Checklist>

- âœ… æœ¬åœ°çŠ¶æ€é€‚ç”¨äºç»„ä»¶å†…éƒ¨ä½¿ç”¨ï¼Œä¸éœ€è¦å…±äº«
- âœ… å…¨å±€çŠ¶æ€é€‚ç”¨äºå¤šä¸ªç»„ä»¶éœ€è¦è®¿é—®çš„æ•°æ®
- âœ… çŠ¶æ€èŒƒå›´å†³ç­–è¦è€ƒè™‘å…±äº«èŒƒå›´ã€æ›´æ–°é¢‘ç‡å’Œæ€§èƒ½å½±å“
- âœ… çŠ¶æ€æå‡æ˜¯ä¸­ç­‰çš„å…±äº«æ–¹æ¡ˆï¼Œé¿å…è¿‡åº¦å…¨å±€åŒ–
- âœ… Context APIæ˜¯Reactå†…ç½®çš„å…¨å±€çŠ¶æ€è§£å†³æ–¹æ¡ˆ
- âœ… ä¸åŒçš„çŠ¶æ€ç®¡ç†åº“é€‚ç”¨äºä¸åŒçš„åœºæ™¯
- âœ… çŠ¶æ€æŒä¹…åŒ–å¯ä»¥åœ¨æœ¬åœ°æˆ–æœåŠ¡å™¨ç«¯å®ç°
- âœ… æ€§èƒ½ä¼˜åŒ–éœ€è¦æœ€å°åŒ–çŠ¶æ€æ›´æ–°èŒƒå›´
- âœ… é¿å…å¸¸è§é™·é˜±ï¼šè¿‡åº¦å…¨å±€åŒ–ã€é¢‘ç¹æ›´æ–°ã€å†…å­˜æ³„æ¼
- âœ… æ ¹æ®å›¢é˜Ÿè§„æ¨¡å’Œé¡¹ç›®å¤æ‚åº¦é€‰æ‹©åˆé€‚çš„çŠ¶æ€ç®¡ç†æ–¹æ¡ˆ

</Checklist>

### çŠ¶æ€èŒƒå›´é€‰æ‹©æŒ‡å—

<BestPractices>

**ä½¿ç”¨æœ¬åœ°çŠ¶æ€**ï¼š
1. ç»„ä»¶å†…éƒ¨ä½¿ç”¨çš„çŠ¶æ€
2. ä¸éœ€è¦ä¸å…¶ä»–ç»„ä»¶å…±äº«çš„æ•°æ®
3. ä¸´æ—¶è®¡ç®—ç»“æœ
4. è¡¨å•è¾“å…¥å­—æ®µ
5. UIçŠ¶æ€ï¼ˆæ¨¡æ€æ¡†ã€æŠ˜å é¢æ¿ç­‰ï¼‰

**ä½¿ç”¨å…¨å±€çŠ¶æ€**ï¼š
1. ç”¨æˆ·è®¤è¯ä¿¡æ¯
2. ä¸»é¢˜å’Œå›½é™…åŒ–è®¾ç½®
3. è´­ç‰©è½¦æ•°æ®
4. å…¨å±€åŠ è½½çŠ¶æ€
5. éœ€è¦è·¨è·¯ç”±å…±äº«çš„æ•°æ®

**çŠ¶æ€ç®¡ç†åº“é€‰æ‹©**ï¼š
1. **Context API** - ç®€å•é¡¹ç›®ï¼ŒReactå†…ç½®
2. **Zustand** - è½»é‡çº§ï¼Œæ€§èƒ½å¥½
3. **Redux Toolkit** - å¤æ‚åº”ç”¨ï¼Œå›¢é˜Ÿåä½œ
4. **Jotai** - ç»†ç²’åº¦æ§åˆ¶ï¼ŒåŸå­åŒ–æ›´æ–°

</BestPractices>

### ä¸‹ä¸€æ­¥å­¦ä¹ 

ç°åœ¨ä½ å·²ç»æŒæ¡äº†çŠ¶æ€èŒƒå›´å†³ç­–çš„åŸºç¡€çŸ¥è¯†ï¼Œæ¥ä¸‹æ¥å¯ä»¥æ·±å…¥å­¦ä¹ ï¼š

1. **[Context APIæ·±åº¦è§£æ](../intermediate/context-api)** - æ·±å…¥ç†è§£Contextçš„é«˜çº§ç”¨æ³•
2. **[ReduxåŸºç¡€](../intermediate/redux-fundamentals)** - å­¦ä¹ å·¥ä¸šçº§çŠ¶æ€ç®¡ç†
3. **[Zustandè½»é‡æ–¹æ¡ˆ](../intermediate/zustand)** - æŒæ¡ç°ä»£çŠ¶æ€ç®¡ç†
4. **[æ€§èƒ½ä¼˜åŒ–åŸºç¡€](../basics/react-memo)** - ä¼˜åŒ–çŠ¶æ€æ›´æ–°æ€§èƒ½

---

## 12. å»¶ä¼¸é˜…è¯»

### å®˜æ–¹èµ„æº

- [State: A Component's Memory](https://react.dev/reference/react/useState) - Reactå®˜æ–¹æ–‡æ¡£
- [Context](https://react.dev/reference/react/useContext) - Contextä½¿ç”¨æŒ‡å—
- [Sharing State Between Components](https://react.dev/learn/sharing-state-between-components) - çŠ¶æ€å…±äº«

### æ¨èé˜…è¯»

- [A (Mostly) Complete Guide to React Rendering Behavior](https://blog.isquaredsoftware.com/2020/05/11/react-redux-troubleshooting-guide/#table-of-contents) - Reactæ¸²æŸ“æœºåˆ¶
- [State Management with React](https://kentcdodds.com/blog/application-state-management-with-react) - çŠ¶æ€ç®¡ç†æœ€ä½³å®è·µ
- [Why React Context is Not a "State Management" Solution](https://blog.logrocket.com/react-context-api-not-state-management-solution/) - Context vs çŠ¶æ€ç®¡ç†åº“

### ç›¸å…³è¯é¢˜

- [çŠ¶æ€æå‡](../basics/lifting-state-up) - Reactå®˜æ–¹æ–‡æ¡£
- [useReduceræ·±åº¦ä½¿ç”¨](../advanced/useReducer) - å¤æ‚çŠ¶æ€é€»è¾‘
- [æ€§èƒ½ä¼˜åŒ–](../performance/) - å®Œæ•´æ€§èƒ½ä¼˜åŒ–æŒ‡å—

---

[â† ä¸Šä¸€ç« ï¼šç»„ä»¶æ¨¡å¼æ€»ç»“](../patterns/) | [ä¸‹ä¸€ç« ï¼šContext APIæ·±åº¦è§£æ â†’](../intermediate/context-api)
