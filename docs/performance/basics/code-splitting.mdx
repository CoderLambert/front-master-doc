# ä»£ç åˆ†å‰² - æŒ‰éœ€åŠ è½½ä¼˜åŒ–é¦–å±æ€§èƒ½

import { Tabs, TabItem } from '@docusaurus/theme-common';

ä»£ç åˆ†å‰²ï¼ˆCode Splittingï¼‰æ˜¯ç°ä»£Reactåº”ç”¨ä¸­è‡³å…³é‡è¦çš„æ€§èƒ½ä¼˜åŒ–æŠ€æœ¯ï¼Œå®ƒé€šè¿‡å°†ä»£ç æ‹†åˆ†ä¸ºå¤šä¸ª bundle å¹¶æŒ‰éœ€åŠ è½½ï¼Œå¤§å¹…å‡å°‘åˆå§‹åŠ è½½æ—¶é—´ï¼Œæå‡ç”¨æˆ·ä½“éªŒã€‚æœ¬ç« å°†æ·±å…¥æ¢è®¨ä»£ç åˆ†å‰²çš„åŸç†ã€å®ç°æ–¹å¼ã€æœ€ä½³å®è·µå’Œå®é™…åº”ç”¨åœºæ™¯ã€‚

## æœ¬ç« å­¦ä¹ ç›®æ ‡

- ç†è§£ä»£ç åˆ†å‰²çš„æ ¸å¿ƒåŸç†å’Œæ€§èƒ½æ”¶ç›Š
- æŒæ¡React.lazyå’ŒSuspenseçš„ä½¿ç”¨æ–¹æ³•
- å­¦ä¼šä½¿ç”¨åŠ¨æ€importè¿›è¡Œä»£ç åˆ†å‰²
- ç†è§£è·¯ç”±çº§åˆ«çš„ä»£ç åˆ†å‰²
- æŒæ¡Bundleåˆ†æå’Œä¼˜åŒ–å·¥å…·
- å­¦ä¼šä½¿ç”¨Webpacã€Viteç­‰æ„å»ºå·¥å…·çš„ä»£ç åˆ†å‰²
- ç†è§£é¢„åŠ è½½å’Œé¢„è·å–ç­–ç•¥
- æŒæ¡ä»£ç åˆ†å‰²çš„æœ€ä½³å®è·µ
- å­¦ä¼šåœ¨çœŸå®é¡¹ç›®ä¸­åº”ç”¨ä»£ç åˆ†å‰²
- ç†è§£ä»£ç åˆ†å‰²çš„é™·é˜±å’Œè§£å†³æ–¹æ¡ˆ

---

## 1. ä»£ç åˆ†å‰²æ¦‚è¿°

ä»£ç åˆ†å‰²æ˜¯ä¸€ç§å°†å¤§å‹åº”ç”¨ç¨‹åºä»£ç åº“æ‹†åˆ†ä¸ºå¤šä¸ªå°å—çš„æŠ€æœ¯ï¼Œè¿™äº›å°å—å¯ä»¥åœ¨éœ€è¦æ—¶å•ç‹¬åŠ è½½ï¼Œè€Œä¸æ˜¯åœ¨åˆå§‹åŠ è½½æ—¶ä¸€æ¬¡æ€§åŠ è½½æ•´ä¸ªåº”ç”¨ç¨‹åºã€‚

<Box style={{ padding: '20px', background: '#e3f2fd', borderRadius: '8px', margin: '20px 0' }}>
  <h4 style={{ margin: 0, color: '#1976d2' }}>ğŸ’¡ æ ¸å¿ƒç†å¿µ</h4>
  <p style={{ margin: '10px 0 0 0' }}>
    <strong>æŒ‰éœ€åŠ è½½</strong> - åªåŠ è½½å½“å‰é¡µé¢éœ€è¦çš„ä»£ç <br />
    <strong>å‡å°‘åˆå§‹åŒ…å¤§å°</strong> - ç¼©çŸ­é¦–å±åŠ è½½æ—¶é—´<br />
    <strong>æå‡ç”¨æˆ·ä½“éªŒ</strong> - é¿å…é•¿æ—¶é—´ç™½å±<br />
    <strong>æé«˜ç¼“å­˜æ•ˆç‡</strong> - ç¨³å®šä»£ç å¯é•¿æœŸç¼“å­˜
  </p>
</Box>

<CodeBlock>

```jsx
// âŒ æœªä½¿ç”¨ä»£ç åˆ†å‰² - æ‰€æœ‰ä»£ç åœ¨åˆå§‹åŠ è½½
// bundle.js (800KB)
// - Appç»„ä»¶
// - Dashboardç»„ä»¶
// - Settingsç»„ä»¶
// - Analyticsç»„ä»¶
// - Reportsç»„ä»¶
function App() {
  return (
    <Routes>
      <Route path="/" element={<Home />} />
      <Route path="/dashboard" element={<Dashboard />} />
      <Route path="/settings" element={<Settings />} />
      <Route path="/analytics" element={<Analytics />} />
      <Route path="/reports" element={<Reports />} />
    </Routes>
  );
}

// âœ… ä½¿ç”¨ä»£ç åˆ†å‰² - æŒ‰éœ€åŠ è½½
// åˆå§‹ bundle.js (200KB) - åªåŒ…å«Appå’ŒHome
// dashboard.js (150KB) - è®¿é—®/dashboardæ—¶åŠ è½½
// settings.js (100KB) - è®¿é—®/settingsæ—¶åŠ è½½
// analytics.js (200KB) - è®¿é—®/analyticsæ—¶åŠ è½½
// reports.js (180KB) - è®¿é—®/reportsæ—¶åŠ è½½

import { lazy, Suspense } from 'react';

const Dashboard = lazy(() => import('./Dashboard'));
const Settings = lazy(() => import('./Settings'));
const Analytics = lazy(() => import('./Analytics'));
const Reports = lazy(() => import('./Reports'));

function App() {
  return (
    <Routes>
      <Route path="/" element={<Home />} />
      <Route
        path="/dashboard"
        element={
          <Suspense fallback={<Loading />}>
            <Dashboard />
          </Suspense>
        }
      />
      <Route
        path="/settings"
        element={
          <Suspense fallback={<Loading />}>
            <Settings />
          </Suspense>
        }
      />
      {/* ... å…¶ä»–è·¯ç”± */}
    </Routes>
  );
}
```

</CodeBlock>

### 1.1 ä»£ç åˆ†å‰²çš„å·¥ä½œåŸç†

<Grid>

<div>
  <h4>ğŸ“¦ ä¼ ç»Ÿæ‰“åŒ…</h4>
  <ul>
    <li>æ‰€æœ‰ä»£ç æ‰“åŒ…åˆ°ä¸€ä¸ªæ–‡ä»¶</li>
    <li>ç”¨æˆ·å¿…é¡»ä¸‹è½½å®Œæ•´ä»£ç </li>
    <li>é¦–å±åŠ è½½æ—¶é—´é•¿</li>
    <li>ç¼“å­˜æ›´æ–°å½±å“å¤§</li>
  </ul>
</div>

<div>
  <h4>ğŸ”€ ä»£ç åˆ†å‰²</h4>
  <ul>
    <li>ä»£ç æ‹†åˆ†ä¸ºå¤šä¸ªchunk</li>
    <li>åªä¸‹è½½å½“å‰éœ€è¦çš„chunk</li>
    <li>é¦–å±åŠ è½½æ—¶é—´çŸ­</li>
    <li>ç¨³å®šéƒ¨åˆ†å¯é•¿æœŸç¼“å­˜</li>
  </ul>
</div>

<div>
  <h4>âš¡ æ€§èƒ½æå‡</h4>
  <ul>
    <li>é¦–å±åŠ è½½æ—¶é—´å‡å°‘50%+</li>
    <li>äº¤äº’æ—¶é—´æ˜æ˜¾æå‰</li>
    <li>å¸¦å®½èŠ‚çœæ˜¾è‘—</li>
    <li>ç§»åŠ¨ç«¯ä½“éªŒæ”¹å–„</li>
  </ul>
</div>

<div>
  <h4>ğŸ¯ é€‚ç”¨åœºæ™¯</h4>
  <ul>
    <li>å¤šé¡µé¢åº”ç”¨</li>
    <li>å¤§å‹åº”ç”¨</li>
    <li>åŠŸèƒ½æ¨¡å—åŒ–</li>
    <li>ç¬¬ä¸‰æ–¹åº“éš”ç¦»</li>
  </ul>
</div>

</Grid>

<CodeBlock>

```jsx
// ä»£ç åˆ†å‰²åŸç†è¯¦ç»†è§£æ
const loadComponent = (importFunc) => {
  // è¿”å›ä¸€ä¸ªReactç»„ä»¶
  return function LazyComponent(props) {
    const [component, setComponent] = useState(null);
    const [error, setError] = useState(null);
    const [isLoading, setIsLoading] = useState(true);

    useEffect(() => {
      // å¼€å§‹åŠ è½½
      setIsLoading(true);

      // æ‰§è¡ŒåŠ¨æ€å¯¼å…¥
      importFunc()
        .then((module) => {
          // å¯¼å…¥æˆåŠŸï¼Œæå–ç»„ä»¶
          const ExportedComponent = module.default || module;
          setComponent(() => ExportedComponent);
          setIsLoading(false);
        })
        .catch((err) => {
          // å¯¼å…¥å¤±è´¥
          setError(err);
          setIsLoading(false);
        });
    }, []);

    // æ¸²æŸ“çŠ¶æ€
    if (error) {
      return <ErrorComponent error={error} />;
    }

    if (isLoading) {
      return <LoadingComponent />;
    }

    if (component) {
      // æ¸²æŸ“åŠ è½½çš„ç»„ä»¶
      return React.createElement(component, props);
    }

    return null;
  };
};

// ä½¿ç”¨ç¤ºä¾‹
const LazyDashboard = loadComponent(() => import('./Dashboard'));
```

</CodeBlock>

### 1.2 ä»£ç åˆ†å‰²çš„ä¼˜åŠ¿ä¸é™åˆ¶

<Grid>

<div>
  <h4>âœ… ä¼˜åŠ¿</h4>
  <ul>
    <li>å¤§å¹…å‡å°‘é¦–å±åŠ è½½æ—¶é—´</li>
    <li>æå‡é¦–æ¬¡å†…å®¹ç»˜åˆ¶é€Ÿåº¦</li>
    <li>å‡å°‘åˆå§‹JavaScriptæ‰§è¡Œæ—¶é—´</li>
    <li>æé«˜ç¼“å­˜å‘½ä¸­ç‡</li>
    <li>æ”¯æŒæ¸è¿›å¼åŠŸèƒ½åŠ è½½</li>
  </ul>
</div>

<div>
  <h4>âš ï¸ é™åˆ¶</h4>
  <ul>
    <li>å¢åŠ ä»£ç å¤æ‚åº¦</li>
    <li>éœ€è¦å¤„ç†åŠ è½½çŠ¶æ€</li>
    <li>å¯èƒ½å½±å“SEO</li>
    <li>é¦–æ¬¡è®¿é—®å¯èƒ½è¾ƒæ…¢</li>
    <li>éœ€è¦åˆç†çš„åˆ†å‰²ç­–ç•¥</li>
  </ul>
</div>

</Grid>

<CodeBlock>

```jsx
// é€‚ç”¨åœºæ™¯åˆ¤æ–­
const shouldUseCodeSplitting = {
  // é€‚åˆä»£ç åˆ†å‰²çš„åœºæ™¯
  goodCases: [
    'å¤šé¡µé¢åº”ç”¨ï¼ˆMPAï¼‰',
    'å¤§å‹å•é¡µåº”ç”¨ï¼ˆSPAï¼‰',
    'åŠŸèƒ½æ¨¡å—ç‹¬ç«‹',
    'ç¬¬ä¸‰æ–¹åº“è¾ƒå¤§',
    'ä½é¢‘è®¿é—®åŠŸèƒ½',
    'ç”¨æˆ·å®šåˆ¶åŒ–åŠŸèƒ½'
  ],

  // ä¸é€‚åˆçš„åœºæ™¯
  badCases: [
    'ç®€å•å•é¡µåº”ç”¨',
    'æ ¸å¿ƒåŠŸèƒ½å¿…é¡»ç«‹å³å¯ç”¨',
    'é«˜åº¦SEOæ•æ„Ÿé¡µé¢',
    'é«˜é¢‘è®¿é—®åŠŸèƒ½',
    'æœåŠ¡ç«¯æ¸²æŸ“ï¼ˆSSRï¼‰',
    'å®æ—¶äº¤äº’åº”ç”¨'
  ]
};

// å†³ç­–ç¤ºä¾‹
function shouldSplitCode(route, traffic, isCoreFeature) {
  if (isCoreFeature && traffic > 0.8) {
    return false; // æ ¸å¿ƒé«˜é¢‘åŠŸèƒ½ä¸åˆ†å‰²
  }
  if (traffic < 0.3) {
    return true; // ä½é¢‘è®¿é—®åŠŸèƒ½å»ºè®®åˆ†å‰²
  }
  if (route.includes('admin') || route.includes('settings')) {
    return true; // ç®¡ç†åŠŸèƒ½å»ºè®®åˆ†å‰²
  }
  return true; // é»˜è®¤å»ºè®®åˆ†å‰²
}
```

</CodeBlock>

---

## 2. React.lazyå’ŒSuspense

React.lazyå’ŒSuspenseæ˜¯React 16.6å¼•å…¥çš„å†…ç½®åŠŸèƒ½ï¼Œç”¨äºå®ç°ç»„ä»¶çº§åˆ«çš„ä»£ç åˆ†å‰²ã€‚

### 2.1 React.lazyåŸºç¡€ç”¨æ³•

<CodeBlock>

```jsx
import { lazy } from 'react';

// åŸºç¡€ç”¨æ³•
const LazyComponent = lazy(() => import('./Component'));

// æŒ‡å®šå¯¼å‡º
const LazyComponentWithNamedExport = lazy(() =>
  import('./Component').then(module => ({
    default: module.NamedComponent
  }))
);

// å¼‚æ­¥åˆå§‹åŒ–
const LazyComponentWithInit = lazy(async () => {
  await initializeApp();
  return import('./Component');
});

// é”™è¯¯å¤„ç†
const LazyComponentWithErrorHandling = lazy(() =>
  import('./Component').catch(() =>
    import('./ErrorComponent')
  )
);

// ä½¿ç”¨ç¤ºä¾‹
import { Suspense } from 'react';

function App() {
  return (
    <div>
      <h1>My App</h1>
      <Suspense fallback={<div>Loading...</div>}>
        <LazyComponent />
      </Suspense>
    </div>
  );
}
```

</CodeBlock>

### 2.2 Suspenseé…ç½®

<CodeBlock>

```jsx
import { Suspense } from 'react';

// åŸºç¡€Suspense
<Suspense fallback={<div>Loading...</div>}>
  <LazyComponent />
</Suspense>

// è‡ªå®šä¹‰åŠ è½½ç»„ä»¶
<Suspense fallback={<LoadingSpinner color="primary" />}>
  <LazyComponent />
</Suspense>

// å¤šå±‚Suspense
<Suspense fallback={<PageLoader />}>
  <MainContent>
    <Suspense fallback={<SectionLoader />}>
      <LazySection />
    </Suspense>
  </MainContent>
</Suspense>

// å®Œæ•´åŠ è½½é¡µé¢
<Suspense fallback={<FullPageLoader />}>
  <Routes>
    <Route path="/" element={<Home />} />
    <Route
      path="/dashboard"
      element={
        <Suspense fallback={<DashboardSkeleton />}>
          <Dashboard />
        </Suspense>
      }
    />
  </Routes>
</Suspense>

// æ¡ä»¶æ¸²æŸ“
<Suspense fallback={null}>
  {shouldShow && <LazyHeavyComponent />}
</Suspense>
```

</CodeBlock>

### 2.3 åŠ¨æ€å¯¼å…¥æ¨¡å¼

<CodeBlock>

```jsx
// 1. åŸºç¡€åŠ¨æ€å¯¼å…¥
const loadUserProfile = () => import('./UserProfile');

// 2. å¸¦é¢„å–çš„åŠ¨æ€å¯¼å…¥
const loadUserProfileWithPrefetch = () => {
  const componentPromise = import('./UserProfile');

  // é¢„å–èµ„æº
  const link = document.createElement('link');
  link.rel = 'prefetch';
  link.href = './UserProfile.chunk.js';
  document.head.appendChild(link);

  return componentPromise;
};

// 3. æ¡ä»¶åŠ¨æ€å¯¼å…¥
const loadComponentConditionally = (condition) => {
  if (condition) {
    return import('./HeavyComponent');
  }
  return import('./LightComponent');
};

// 4. å¹¶è¡ŒåŠ è½½å¤šä¸ªç»„ä»¶
const loadMultipleComponents = async () => {
  const [componentA, componentB, componentC] = await Promise.all([
    import('./ComponentA'),
    import('./ComponentB'),
    import('./ComponentC')
  ]);

  return { componentA, componentB, componentC };
};

// 5. ç¼“å­˜åŠ è½½ç»“æœ
const componentCache = new Map();

const loadCachedComponent = (componentName) => {
  if (componentCache.has(componentName)) {
    return componentCache.get(componentName);
  }

  const promise = import(`./${componentName}`);
  componentCache.set(componentName, promise);
  return promise;
};
```

</CodeBlock>

### 2.4 é«˜çº§Suspenseæ¨¡å¼

<CodeBlock>

```jsx
// 1. Suspenseåˆ—è¡¨
function SuspenseList({ revealOrder = 'forwards', ...props }) {
  const [loadedItems, setLoadedItems] = useState([]);

  const loadItem = async (id) => {
    const item = await import(`./items/${id}`);
    setLoadedItems(prev => [...prev, item]);
  };

  return (
    <SuspenseList revealOrder={revealOrder}>
      {props.children}
    </SuspenseList>
  );
}

// 2. å¹¶è¡ŒSuspense
function ParallelSuspense() {
  return (
    <div>
      <Suspense fallback={<LoaderA />}>
        <ComponentA />
      </Suspense>
      <Suspense fallback={<LoaderB />}>
        <ComponentB />
      </Suspense>
    </div>
  );
}

// 3. Suspenseè¾¹ç•Œ
class ErrorBoundary extends React.Component {
  constructor(props) {
    super(props);
    this.state = { hasError: false, error: null };
  }

  static getDerivedStateFromError(error) {
    return { hasError: true, error };
  }

  componentDidCatch(error, errorInfo) {
    console.error('Lazy loading error:', error, errorInfo);
  }

  render() {
    if (this.state.hasError) {
      return (
        <div>
          <h1>Something went wrong.</h1>
          <details>
            <summary>Error details</summary>
            {this.state.error && this.state.error.message}
          </details>
        </div>
      );
    }

    return this.props.children;
  }
}

// ä½¿ç”¨é”™è¯¯è¾¹ç•Œ
<ErrorBoundary>
  <Suspense fallback={<div>Loading...</div>}>
    <LazyComponent />
  </Suspense>
</ErrorBoundary>

// 4. è‡ªå®šä¹‰Suspenseç»„ä»¶
function CustomSuspense({
  fallback: Fallback,
  children,
  minDisplayTime = 0
}) {
  const [isVisible, setIsVisible] = useState(false);

  useEffect(() => {
    const timer = setTimeout(() => setIsVisible(true), minDisplayTime);
    return () => clearTimeout(timer);
  }, [minDisplayTime]);

  return (
    <Suspense fallback={<Fallback />}>
      {isVisible && children}
    </Suspense>
  );
}
```

</CodeBlock>

---

## 3. è·¯ç”±çº§åˆ«ä»£ç åˆ†å‰²

è·¯ç”±çº§åˆ«çš„ä»£ç åˆ†å‰²æ˜¯æœ€å¸¸è§ä¸”æœ€æœ‰æ•ˆçš„ä»£ç åˆ†å‰²ç­–ç•¥ã€‚

### 3.1 React Router + ä»£ç åˆ†å‰²

<CodeBlock>

```jsx
import { lazy, Suspense } from 'react';
import { BrowserRouter, Routes, Route } from 'react-router-dom';
import Loading from './Loading';

// è·¯ç”±çº§ä»£ç åˆ†å‰²
const Home = lazy(() => import('../pages/Home'));
const About = lazy(() => import('../pages/About'));
const Dashboard = lazy(() => import('../pages/Dashboard'));
const Settings = lazy(() => import('../pages/Settings'));
const Profile = lazy(() => import('../pages/Profile'));
const Reports = lazy(() => import('../pages/Reports'));

// åµŒå¥—è·¯ç”±
const UserDashboard = lazy(() => import('../pages/user/Dashboard'));
const UserSettings = lazy(() => import('../pages/user/Settings'));
const UserProfile = lazy(() => import('../pages/user/Profile'));

// ç®¡ç†å‘˜è·¯ç”±
const AdminPanel = lazy(() => import('../pages/admin/Panel'));
const AdminUsers = lazy(() => import('../pages/admin/Users'));
const AdminSettings = lazy(() => import('../pages/admin/Settings'));

function App() {
  return (
    <BrowserRouter>
      <Suspense fallback={<Loading />}>
        <Routes>
          <Route path="/" element={<Home />} />
          <Route path="/about" element={<About />} />

          {/* ç”¨æˆ·è·¯ç”± */}
          <Route path="/dashboard/*" element={<Dashboard />}>
            <Route index element={<UserDashboard />} />
            <Route path="settings" element={<UserSettings />} />
            <Route path="profile" element={<UserProfile />} />
          </Route>

          {/* ç®¡ç†å‘˜è·¯ç”± */}
          <Route
            path="/admin/*"
            element={
              <Suspense fallback={<AdminLoading />}>
                <AdminPanel />
              </Suspense>
            }
          >
            <Route index element={<AdminUsers />} />
            <Route path="settings" element={<AdminSettings />} />
          </Route>

          {/* åŠ¨æ€è·¯ç”± */}
          <Route
            path="/settings/:section"
            element={
              <Suspense fallback={<SettingsSkeleton />}>
                <Settings />
              </Suspense>
            }
          />

          {/* æ‡’åŠ è½½çš„ç‹¬ç«‹é¡µé¢ */}
          <Route
            path="/reports"
            element={
              <Suspense fallback={<ReportLoader />}>
                <Reports />
              </Suspense>
            }
          />
        </Routes>
      </Suspense>
    </BrowserRouter>
  );
}

// ä½¿ç”¨Suspenseç»„ä»¶
function SuspenseRoute({ component: Component, ...rest }) {
  return (
    <Route
      {...rest}
      element={
        <Suspense fallback={<RouteLoader />}>
          <Component />
        </Suspense>
      }
    />
  );
}

// è¿›ä¸€æ­¥ä¼˜åŒ–çš„è·¯ç”±é…ç½®
function OptimizedRoutes() {
  return (
    <Routes>
      <SuspenseRoute path="/" component={Home} />
      <SuspenseRoute path="/about" component={About} />
      <SuspenseRoute
        path="/dashboard/*"
        component={Dashboard}
      />
    </Routes>
  );
}
```

</CodeBlock>

### 3.2 Next.jsè·¯ç”±ä»£ç åˆ†å‰²

<CodeBlock>

```jsx
// pages/index.js - é¦–é¡µ
export default function Home() {
  return <h1>Home Page</h1>;
}

// pages/about.js - å…³äºé¡µé¢
export default function About() {
  return <h1>About Page</h1>;
}

// pages/dashboard/index.js - ä»ªè¡¨æ¿ä¸»é¡µ
import { lazy, Suspense } from 'react';

const DashboardOverview = lazy(() =>
  import('../components/DashboardOverview')
);

const AnalyticsWidget = lazy(() =>
  import('../components/AnalyticsWidget')
);

const RecentActivity = lazy(() =>
  import('../components/RecentActivity')
);

export default function Dashboard() {
  return (
    <div>
      <h1>Dashboard</h1>

      <Suspense fallback={<div>Loading analytics...</div>}>
        <AnalyticsWidget />
      </Suspense>

      <Suspense fallback={<div>Loading overview...</div>}>
        <DashboardOverview />
      </Suspense>

      <Suspense fallback={<div>Loading activity...</div>}>
        <RecentActivity />
      </Suspense>
    </div>
  );
}

// pages/user/[id].js - åŠ¨æ€è·¯ç”±
import { useRouter } from 'next/router';

const UserProfile = lazy(() => import('../../components/UserProfile'));
const UserActivity = lazy(() => import('../../components/UserActivity'));

export default function UserPage() {
  const router = useRouter();
  const { id } = router.query;

  return (
    <div>
      <Suspense fallback={<UserSkeleton />}>
        <UserProfile userId={id} />
      </Suspense>

      <Suspense fallback={<ActivitySkeleton />}>
        <UserActivity userId={id} />
      </Suspense>
    </div>
  );
}

// pages/admin/index.js - ç®¡ç†å‘˜é¡µé¢
const AdminLayout = lazy(() => import('../../components/admin/Layout'));
const AdminPanel = lazy(() => import('../../components/admin/Panel'));

export default function AdminIndex() {
  return (
    <Suspense fallback={<AdminLoading />}>
      <AdminLayout>
        <AdminPanel />
      </AdminLayout>
    </Suspense>
  );
}
```

</CodeBlock>

### 3.3 æ¡ä»¶è·¯ç”±ä»£ç åˆ†å‰²

<CodeBlock>

```jsx
// åŸºäºç”¨æˆ·è§’è‰²çš„è·¯ç”±
const AdminRoutes = lazy(() => import('./AdminRoutes'));
const UserRoutes = lazy(() => import('./UserRoutes'));
const PublicRoutes = lazy(() => import('./PublicRoutes'));

function AppRoutes() {
  const { user, loading } = useAuth();

  if (loading) {
    return <Loading />;
  }

  return (
    <Suspense fallback={<RoutesLoader />}>
      {user?.role === 'admin' ? (
        <AdminRoutes />
      ) : user ? (
        <UserRoutes />
      ) : (
        <PublicRoutes />
      )}
    </Suspense>
  );
}

// åŸºäºç‰¹æ€§çš„è·¯ç”±
const FeatureFlaggedRoutes = () => {
  const [features, setFeatures] = useState({});

  useEffect(() => {
    // è·å–ç‰¹æ€§æ ‡å¿—
    fetchFeatures().then(setFeatures);
  }, []);

  return (
    <Routes>
      <Route path="/" element={<Home />} />

      {features.analytics && (
        <Route
          path="/analytics/*"
          element={
            <Suspense fallback={<AnalyticsLoader />}>
              <AnalyticsRoutes />
            </Suspense>
          }
        />
      )}

      {features.reports && (
        <Route
          path="/reports/*"
          element={
            <Suspense fallback={<ReportsLoader />}>
              <ReportsRoutes />
            </Suspense>
          }
        />
      )}
    </Routes>
  );
};

// åŸºäºè®¾å¤‡ç±»å‹çš„è·¯ç”±
const DesktopRoutes = lazy(() => import('./DesktopRoutes'));
const MobileRoutes = lazy(() => import('./MobileRoutes'));
const TabletRoutes = lazy(() => import('./TabletRoutes'));

function DeviceBasedRoutes() {
  const deviceType = useDeviceType();

  return (
    <Suspense fallback={<DeviceLoader />}>
      {deviceType === 'mobile' && <MobileRoutes />}
      {deviceType === 'tablet' && <TabletRoutes />}
      {deviceType === 'desktop' && <DesktopRoutes />}
    </Suspense>
  );
}
```

</CodeBlock>

---

## 4. ç»„ä»¶çº§ä»£ç åˆ†å‰²

é™¤äº†è·¯ç”±çº§åˆ«çš„ä»£ç åˆ†å‰²ï¼Œç»„ä»¶çº§åˆ«çš„ä»£ç åˆ†å‰²å¯ä»¥è¿›ä¸€æ­¥ä¼˜åŒ–æ€§èƒ½ã€‚

### 4.1 æ¡ä»¶ç»„ä»¶åˆ†å‰²

<CodeBlock>

```jsx
// 1. åŸºäºçŠ¶æ€çš„ç»„ä»¶åˆ†å‰²
function ConditionalComponent() {
  const [showAdvanced, setShowAdvanced] = useState(false);

  return (
    <div>
      <button onClick={() => setShowAdvanced(true)}>
        Show Advanced Features
      </button>

      <Suspense fallback={<AdvancedFeaturesSkeleton />}>
        {showAdvanced && (
          <lazyAdvancedFeatures />
        )}
      </Suspense>
    </div>
  );
}

// 2. åŸºäºpropsçš„ç»„ä»¶åˆ†å‰²
const LazyModal = lazy(() => import('./Modal'));
const LazyTooltip = lazy(() => import('./Tooltip'));

function UIRenderer({ type, ...props }) {
  if (type === 'modal') {
    return (
      <Suspense fallback={null}>
        <LazyModal {...props} />
      </Suspense>
    );
  }

  if (type === 'tooltip') {
    return (
      <Suspense fallback={null}>
        <LazyTooltip {...props} />
      </Suspense>
    );
  }

  return null;
}

// 3. Tabç»„ä»¶åˆ†å‰²
const TabContent = lazy(() => import('./TabContent'));

function LazyTab({ tabs }) {
  const [activeTab, setActiveTab] = useState(0);

  return (
    <div>
      <div className="tab-headers">
        {tabs.map((tab, index) => (
          <button
            key={index}
            onClick={() => setActiveTab(index)}
            className={activeTab === index ? 'active' : ''}
          >
            {tab.label}
          </button>
        ))}
      </div>

      <div className="tab-content">
        <Suspense fallback={<TabLoader />}>
          <TabContent content={tabs[activeTab].content} />
        </Suspense>
      </div>
    </div>
  );
}
```

</CodeBlock>

### 4.2 ç¬¬ä¸‰æ–¹åº“åˆ†å‰²

<CodeBlock>

```jsx
// 1. Chart.jsåŠ¨æ€å¯¼å…¥
const Chart = lazy(() =>
  import('chart.js').then(module => {
    // åŠ¨æ€æ³¨å†Œç»„ä»¶
    ChartJS.register(
      CategoryScale,
      LinearScale,
      PointElement,
      LineElement,
      Title,
      Tooltip,
      Legend
    );
    return { default: module.Chart };
  })
);

function ChartComponent({ data, type }) {
  return (
    <Suspense fallback={<ChartSkeleton />}>
      <Chart type={type} data={data} />
    </Suspense>
  );
}

// 2. å¯Œæ–‡æœ¬ç¼–è¾‘å™¨åˆ†å‰²
const RichTextEditor = lazy(() => import('react-quill'));
const ReactQuill = () => (
  <Suspense fallback={<EditorSkeleton />}>
    <RichTextEditor />
  </Suspense>
);

// 3. æ—¥æœŸé€‰æ‹©å™¨åˆ†å‰²
const DatePicker = lazy(() => import('react-datepicker'));
const ReactDatePicker = () => (
  <Suspense fallback={<DatePickerSkeleton />}>
    <DatePicker />
  </Suspense>
);

// 4. è§†é¢‘æ’­æ”¾å™¨åˆ†å‰²
const VideoPlayer = lazy(() => import('react-player'));

function VideoComponent({ src }) {
  return (
    <Suspense fallback={<VideoSkeleton />}>
      <VideoPlayer url={src} controls />
    </Suspense>
  );
}

// 5. ä»£ç ç¼–è¾‘å™¨åˆ†å‰²
const CodeEditor = lazy(() => import('@monaco-editor/react'));

function CodeEditorComponent({ value, onChange }) {
  return (
    <Suspense fallback={<CodeEditorSkeleton />}>
      <CodeEditor
        height="400px"
        defaultLanguage="javascript"
        value={value}
        onChange={onChange}
        theme="vs-dark"
      />
    </Suspense>
  );
}
```

</CodeBlock>

### 4.3 å¤æ‚ç»„ä»¶åˆ†å‰²

<CodeBlock>

```jsx
// 1. åµŒå¥—ç»„ä»¶åˆ†å‰²
const HeavyWidget = lazy(() => import('./HeavyWidget'));

function WidgetContainer() {
  const [isVisible, setIsVisible] = useState(false);

  return (
    <div>
      <button onClick={() => setIsVisible(true)}>
        Load Widget
      </button>

      <Suspense fallback={<WidgetSkeleton />}>
        {isVisible && <HeavyWidget />}
      </Suspense>
    </div>
  );
}

// 2. ç»„ä»¶æ ‘æ‡’åŠ è½½
const LazyComponentTree = () => {
  const [shouldLoadTree, setShouldLoadTree] = useState(false);

  const LazyTree = lazy(() => import('./Tree'));
  const LazyTreeNode = lazy(() => import('./TreeNode'));
  const LazyTreeLeaf = lazy(() => import('./TreeLeaf'));

  return (
    <div>
      <button onClick={() => setShouldLoadTree(true)}>
        Show Tree
      </button>

      {shouldLoadTree && (
        <Suspense fallback={<TreeLoader />}>
          <LazyTree>
            <Suspense fallback={null}>
              <LazyTreeNode>
                <Suspense fallback={null}>
                  <LazyTreeLeaf />
                </Suspense>
              </LazyTreeNode>
            </Suspense>
          </LazyTree>
        </Suspense>
      )}
    </div>
  );
};

// 3. åŠ¨æ€ç»„ä»¶åŠ è½½å™¨
function DynamicComponentLoader({
  componentName,
  props,
  fallback = <div>Loading...</div>
}) {
  const [Component, setComponent] = useState(null);
  const [error, setError] = useState(null);

  useEffect(() => {
    let mounted = true;

    const loadComponent = async () => {
      try {
        const module = await import(`./components/${componentName}`);
        if (mounted) {
          setComponent(() => module.default);
        }
      } catch (err) {
        if (mounted) {
          setError(err);
        }
      }
    };

    loadComponent();

    return () => {
      mounted = false;
    };
  }, [componentName]);

  if (error) {
    return <ErrorComponent error={error} />;
  }

  if (!Component) {
    return fallback;
  }

  return <Component {...props} />;
}

// ä½¿ç”¨ç¤ºä¾‹
<DynamicComponentLoader
  componentName="UserProfile"
  userId={123}
  fallback={<UserProfileSkeleton />}
/>
```

</CodeBlock>

---

## 5. Bundleåˆ†æä¸ä¼˜åŒ–

ç†è§£å’Œåˆ†æBundleæ˜¯ä»£ç åˆ†å‰²çš„å…³é”®ã€‚

### 5.1 Webpack Bundleåˆ†æ

<CodeBlock>

```bash
# å®‰è£…åˆ†æå·¥å…·
npm install --save-dev webpack-bundle-analyzer

# åœ¨webpack.config.jsä¸­é…ç½®
const BundleAnalyzerPlugin = require('webpack-bundle-analyzer').BundleAnalyzerPlugin;

module.exports = {
  plugins: [
    new BundleAnalyzerPlugin({
      analyzerMode: 'static',
      openAnalyzer: false,
      reportFilename: 'bundle-report.html',
    }),
  ],
  // ç”Ÿæˆstatsæ–‡ä»¶
  optimization: {
    splitChunks: {
      chunks: 'all',
      cacheGroups: {
        vendor: {
          test: /[\\/]node_modules[\\/]/,
          name: 'vendors',
          chunks: 'all',
        },
      },
    },
  },
};

# ä½¿ç”¨å‘½ä»¤ç”Ÿæˆåˆ†ææŠ¥å‘Š
npm run build
npx webpack-bundle-analyzer build/static/js/*.js
```

</CodeBlock>

<CodeBlock>

```jsx
// 2. Reactæ‰“åŒ…åˆ†æ
import { measurePerformance } from 'web-vitals';

// æ€§èƒ½æµ‹é‡ç»„ä»¶
function BundleSizeMonitor() {
  useEffect(() => {
    // æµ‹é‡åŠ è½½æ—¶é—´
    import('./HeavyComponent').then(module => {
      const loadTime = performance.now();
      console.log(`Bundle loaded in ${loadTime.toFixed(2)}ms`);

      // å‘é€æ€§èƒ½æ•°æ®
      if (typeof window !== 'undefined' && window.gtag) {
        window.gtag('event', 'bundle_loaded', {
          bundle_name: 'HeavyComponent',
          load_time: loadTime,
        });
      }
    });
  }, []);

  return null;
}

// Bundleå¤§å°è¿½è¸ª
function trackBundleSize() {
  if (typeof window === 'undefined') return;

  // è·å–å½“å‰chunkå¤§å°
  const scriptTags = document.querySelectorAll('script[src*="chunk"]');
  scriptTags.forEach(tag => {
    fetch(tag.src, { method: 'HEAD' })
      .then(response => {
        const size = response.headers.get('content-length');
        console.log(`Chunk: ${tag.src}, Size: ${size} bytes`);
      });
  });
}

// åˆ†ææœªä½¿ç”¨çš„ä»£ç 
function analyzeUnusedCode() {
  import('webpack-bundle-analyzer').then(({
    default: BundleAnalyzerPlugin
  }) => {
    // åˆ†ææœªä½¿ç”¨çš„æ¨¡å—
    const stats = require('../dist/bundle-stats.json');

    // æ‰¾å‡ºæœªä½¿ç”¨çš„æ¨¡å—
    const unusedModules = Object.keys(stats.modules)
      .filter(moduleName =>
        stats.modules[moduleName].used === false
      );

    console.log('Unused modules:', unusedModules);
  });
}
```

</CodeBlock>

### 5.2 Vite Bundleåˆ†æ

<CodeBlock>

```bash
# Viteå†…ç½®åˆ†æ
npm install --save-dev rollup-plugin-analyzer

# vite.config.js
import { defineConfig } from 'vite';
import { visualizer } from 'rollup-plugin-visualizer';

export default defineConfig({
  plugins: [
    visualizer({
      filename: 'dist/stats.html',
      open: true,
      gzipSize: true,
      brotliSize: true,
    }),
  ],
  build: {
    rollupOptions: {
      output: {
        manualChunks: {
          vendor: ['react', 'react-dom'],
          ui: ['antd', '@mui/material'],
        },
      },
    },
  },
});

# ç”ŸæˆæŠ¥å‘Š
npm run build
# è‡ªåŠ¨æ‰“å¼€ stats.html
```

</CodeBlock>

<CodeBlock>

```jsx
// Viteä»£ç åˆ†å‰²é…ç½®
import { defineConfig } from 'vite';
import react from '@vitejs/plugin-react';

export default defineConfig({
  plugins: [react()],
  build: {
    rollupOptions: {
      output: {
        manualChunks: {
          // Reactç”Ÿæ€
          'react-vendor': ['react', 'react-dom', 'react-router-dom'],

          // UIåº“
          'ui-vendor': ['antd', '@mui/material', 'chakra-ui'],

          // å·¥å…·åº“
          'utils': ['lodash', 'moment', 'axios'],

          // å›¾è¡¨åº“
          'charts': ['chart.js', 'd3', 'recharts'],

          // ç¼–è¾‘å™¨
          'editor': ['react-quill', '@monaco-editor/react'],
        },
      },
    },
  },
  optimizeDeps: {
    include: [
      'react',
      'react-dom',
      'react-router-dom',
    ],
  },
});
```

</CodeBlock>

### 5.3 åŠ¨æ€å¯¼å…¥ä¼˜åŒ–

<CodeBlock>

```jsx
// 1. é¢„åŠ è½½ç­–ç•¥
function preloadComponent(importFunc) {
  // é¢„å–ä½†ä¸æ‰§è¡Œ
  const promise = importFunc();

  // æ·»åŠ åˆ°é¢„å–é˜Ÿåˆ—
  if ('requestIdleCallback' in window) {
    requestIdleCallback(() => {
      promise.then(module => {
        // é¢„æ‰§è¡Œ
        if (module.default && typeof module.default.preload === 'function') {
          module.default.preload();
        }
      });
    });
  }

  return promise;
}

// ä½¿ç”¨é¢„åŠ è½½
const LazyComponent = lazy(() =>
  preloadComponent(() => import('./Component'))
);

// 2. é¢„è·å–ç­–ç•¥
function prefetchComponent(importFunc) {
  const link = document.createElement('link');
  link.rel = 'prefetch';
  link.href = importFunc.toString().match(/['"](.*)['"]/)[1];
  document.head.appendChild(link);
}

// åŸºäºç”¨æˆ·è¡Œä¸ºçš„é¢„è·å–
function PredictivePrefetch() {
  const router = useRouter();

  useEffect(() => {
    // ç”¨æˆ·æ‚¬åœåœ¨é“¾æ¥ä¸Šæ—¶é¢„è·å–
    const handleMouseEnter = (e) => {
      const href = e.target.getAttribute('href');
      if (href) {
        // é¢„è·å–ä¸‹ä¸€é¡µ
        prefetchComponent(() => import(`./pages${href}`));
      }
    };

    // é¢„æµ‹ç”¨æˆ·å¯èƒ½è®¿é—®çš„é¡µé¢
    const predictAndPrefetch = () => {
      const currentPath = router.pathname;
      const predictions = getPredictedNextPages(currentPath);

      predictions.forEach(path => {
        prefetchComponent(() => import(`./pages${path}`));
      });
    };

    // ç©ºé—²æ—¶é¢„è·å–
    if ('requestIdleCallback' in window) {
      requestIdleCallback(predictAndPrefetch);
    }

    document.addEventListener('mouseenter', handleMouseEnter, true);

    return () => {
      document.removeEventListener('mouseenter', handleMouseEnter, true);
    };
  }, [router.pathname]);

  return null;
}

// 3. ç¼“å­˜ç­–ç•¥
const componentCache = new Map();
const CACHE_TTL = 5 * 60 * 1000; // 5åˆ†é’Ÿ

function cachedImport(importFunc, key) {
  const cached = componentCache.get(key);

  if (cached && Date.now() - cached.timestamp < CACHE_TTL) {
    return cached.promise;
  }

  const promise = importFunc();
  componentCache.set(key, {
    promise,
    timestamp: Date.now(),
  });

  return promise;
}

// ä½¿ç”¨ç¼“å­˜çš„æ‡’åŠ è½½
const CachedLazyComponent = lazy(() =>
  cachedImport(() => import('./Component'), 'component-key')
);
```

</CodeBlock>

---

## 6. é¢„åŠ è½½å’Œé¢„è·å–

é¢„åŠ è½½å’Œé¢„è·å–æ˜¯æå‡ç”¨æˆ·ä½“éªŒçš„é‡è¦ç­–ç•¥ã€‚

### 6.1 èµ„æºé¢„åŠ è½½

<CodeBlock>

```jsx
// 1. Linkç»„ä»¶é¢„åŠ è½½
import { Link } from 'react-router-dom';

function PrefetchLink({ to, children, ...props }) {
  return (
    <Link
      to={to}
      {...props}
      onMouseEnter={() => {
        // é¢„è·å–èµ„æº
        const link = document.createElement('link');
        link.rel = 'prefetch';
        link.href = to;
        document.head.appendChild(link);
      }}
    >
      {children}
    </Link>
  );
}

// 2. åŸºäºè·¯ç”±çš„é¢„åŠ è½½
const routes = [
  { path: '/dashboard', chunk: 'dashboard' },
  { path: '/reports', chunk: 'reports' },
  { path: '/settings', chunk: 'settings' },
];

function RoutePrefetcher() {
  const [currentRoute, setCurrentRoute] = useState('/');

  useEffect(() => {
    // é¢„åŠ è½½å½“å‰è·¯ç”±
    const currentChunk = routes.find(r => r.path === currentRoute);
    if (currentChunk) {
      import(`./pages${currentChunk.path}`);
    }

    // é¢„åŠ è½½ç›¸é‚»è·¯ç”±
    const currentIndex = routes.findIndex(r => r.path === currentRoute);
    const nextRoute = routes[currentIndex + 1];
    const prevRoute = routes[currentIndex - 1];

    if (nextRoute) {
      import(`./pages${nextRoute.path}`);
    }
    if (prevRoute) {
      import(`./pages${prevRoute.path}`);
    }
  }, [currentRoute]);

  return <Router onRouteChange={setCurrentRoute} />;
}

// 3. æ™ºèƒ½é¢„åŠ è½½
function SmartPreloader() {
  const [userPreferences, setUserPreferences] = useState({});
  const [isLoaded, setIsLoaded] = useState(false);

  useEffect(() => {
    // åˆ†æç”¨æˆ·è¡Œä¸º
    const analyzeUserBehavior = () => {
      const frequentlyVisited = getFrequentlyVisitedPages();
      const timeSpent = getAverageTimeSpent();
      const navigationPattern = getNavigationPattern();

      return {
        frequentlyVisited,
        timeSpent,
        navigationPattern,
      };
    };

    // åŸºäºç”¨æˆ·è¡Œä¸ºé¢„åŠ è½½
    const userPrefs = analyzeUserBehavior();
    setUserPreferences(userPrefs);
    setIsLoaded(true);

    // é¢„åŠ è½½ç”¨æˆ·å¯èƒ½è®¿é—®çš„é¡µé¢
    userPrefs.frequentlyVisited.forEach(page => {
      import(`./pages${page.path}`);
    });
  }, []);

  return null;
}
```

</CodeBlock>

### 6.2 Service Workeré¢„ç¼“å­˜

<CodeBlock>

```jsx
// 1. æ³¨å†ŒService Worker
if ('serviceWorker' in navigator) {
  window.addEventListener('load', () => {
    navigator.serviceWorker
      .register('/sw.js')
      .then(registration => {
        console.log('SW registered: ', registration);
      })
      .catch(registrationError => {
        console.log('SW registration failed: ', registrationError);
      });
  });
}

// 2. sw.js - é¢„ç¼“å­˜ç­–ç•¥
const CACHE_NAME = 'my-app-v1';
const urlsToCache = [
  '/',
  '/static/js/bundle.js',
  '/static/css/main.css',
  // ä¸é¢„ç¼“å­˜å¤§å‹chunk
];

self.addEventListener('install', event => {
  event.waitUntil(
    caches.open(CACHE_NAME)
      .then(cache => {
        // åªç¼“å­˜æ ¸å¿ƒèµ„æº
        return cache.addAll(urlsToCache);
      })
  );
});

self.addEventListener('fetch', event => {
  event.respondWith(
    caches.match(event.request)
      .then(response => {
        // ç¼“å­˜å‘½ä¸­åˆ™è¿”å›
        if (response) {
          return response;
        }

        // ç½‘ç»œè¯·æ±‚å¹¶ç¼“å­˜
        return fetch(event.request)
          .then(response => {
            // ä¸ç¼“å­˜chunkæ–‡ä»¶
            if (event.request.url.includes('.chunk.')) {
              return response;
            }

            const responseToCache = response.clone();
            caches.open(CACHE_NAME)
              .then(cache => {
                cache.put(event.request, responseToCache);
              });

            return response;
          });
      })
  );
});

// 3. Workboxé¢„ç¼“å­˜
import { precacheAndRoute, cleanupOutdatedCaches } from 'workbox-precaching';
import { registerRoute } from 'workbox-routing';
import { StaleWhileRevalidate } from 'workbox-strategies';

precacheAndRoute(self.__WB_MANIFEST);
cleanupOutdatedCaches();

// ç¼“å­˜ç­–ç•¥
registerRoute(
  ({ request }) => request.destination === 'script',
  new StaleWhileRevalidate()
);
```

</CodeBlock>

### 6.3 HTTP/2 Push

<CodeBlock>

```jsx
// 1. æœåŠ¡å™¨ç«¯æ¨é€ï¼ˆéœ€è¦æœåŠ¡å™¨æ”¯æŒï¼‰
// Node.js/Expressç¤ºä¾‹
app.get('/', (req, res) => {
  // æ¨é€å…³é”®èµ„æº
  res.push('/static/js/main.js');
  res.push('/static/css/main.css');

  // æ¨é€å¯èƒ½éœ€è¦çš„è·¯ç”±
  res.push('/dashboard.js');
  res.push('/settings.js');

  res.send(`
    <!DOCTYPE html>
    <html>
    <head>
      <link rel="preload" href="/static/js/main.js" as="script">
      <link rel="preload" href="/dashboard.js" as="script">
    </head>
    <body>
      <div id="root"></div>
      <script src="/static/js/main.js"></script>
    </body>
    </html>
  `);
});

// 2. å‰ç«¯é¢„åŠ è½½æç¤º
function ResourceHint({ children, to, type = 'prefetch' }) {
  return (
    <>
      <link rel={type} href={to} />
      {children}
    </>
  );
}

// ä½¿ç”¨ç¤ºä¾‹
<ResourceHint to="/dashboard" type="prefetch">
  <Link to="/dashboard">Dashboard</Link>
</ResourceHint>

// 3. åŸºäºæ€§èƒ½çš„é¢„åŠ è½½
function PerformanceBasedPreloader() {
  const [connection, setConnection] = useState(null);

  useEffect(() => {
    // æ£€æµ‹ç½‘ç»œçŠ¶æ€
    if ('connection' in navigator) {
      const conn = navigator.connection;
      setConnection(conn);

      // åŸºäºç½‘ç»œçŠ¶å†µè°ƒæ•´é¢„åŠ è½½ç­–ç•¥
      if (conn.effectiveType === '4g') {
        // å¿«é€Ÿç½‘ç»œï¼šé¢„åŠ è½½æ›´å¤šèµ„æº
        prefetchHeavyResources();
      } else if (conn.effectiveType === '3g') {
        // æ…¢é€Ÿç½‘ç»œï¼šåªé¢„åŠ è½½å¿…è¦èµ„æº
        prefetchEssentialResources();
      } else {
        // æ…¢é€Ÿç½‘ç»œï¼šè·³è¿‡é¢„åŠ è½½
        skipPreloading();
      }
    }
  }, []);

  return null;
}
```

</CodeBlock>

---

## 7. æœ€ä½³å®è·µ

### 7.1 ä»£ç åˆ†å‰²ç­–ç•¥

<BestPractices>

```jsx
// âœ… å¥½çš„åˆ†å‰²ç­–ç•¥

// 1. è·¯ç”±çº§åˆ†å‰²
// æ¯ä¸ªä¸»è¦é¡µé¢ä¸€ä¸ªchunk
const Home = lazy(() => import('../pages/Home'));
const Dashboard = lazy(() => import('../pages/Dashboard'));
const Settings = lazy(() => import('../pages/Settings'));

// 2. ç¬¬ä¸‰æ–¹åº“åˆ†ç¦»
const vendorChunk = {
  react: ['react', 'react-dom', 'react-router-dom'],
  ui: ['antd', '@mui/material'],
  charts: ['chart.js', 'recharts'],
};

// 3. åŠŸèƒ½æ¨¡å—åˆ†å‰²
const AdminPanel = lazy(() => import('./admin/Panel'));
const Reports = lazy(() => import('./reports/Reports'));

// 4. æ¡ä»¶åˆ†å‰²
const Component = lazy(() =>
  import('./Component').then(module => ({
    default: module.ConditionalComponent
  }))
);

// 5. åˆç†å¤§å°çš„chunk
// é¿å…è¿‡å°çš„chunkï¼ˆå¢åŠ è¯·æ±‚å¼€é”€ï¼‰
// é¿å…è¿‡å¤§çš„chunkï¼ˆå¤±å»åˆ†å‰²æ„ä¹‰ï¼‰
// ç›®æ ‡ï¼šæ¯ä¸ªchunk 50-200KB

// âŒ é¿å…çš„åˆ†å‰²ç­–ç•¥

// 1. è¿‡åº¦åˆ†å‰²
const Button = lazy(() => import('./Button'));
const Input = lazy(() => import('./Input'));
const Card = lazy(() => import('./Card'));
// æ¯ä¸ªå°ç»„ä»¶éƒ½åˆ†å‰²ä¼šå¢åŠ è¯·æ±‚æ•°é‡

// 2. åˆ†å‰²æ ¸å¿ƒåŠŸèƒ½
const App = lazy(() => import('./App'));
// ä¸è¦åˆ†å‰²åº”ç”¨æ ¸å¿ƒï¼Œå¦åˆ™é¦–å±åŠ è½½æ…¢

// 3. ä¸è€ƒè™‘ä¾èµ–å…³ç³»
const ModuleA = lazy(() => import('./ModuleA'));
const ModuleB = lazy(() => import('./ModuleB'));
// ModuleAå’ŒModuleBå…±äº«ä¾èµ–ï¼Œé‡å¤æ‰“åŒ…

// 4. æ²¡æœ‰åŠ è½½çŠ¶æ€
<Suspense fallback={null}>
  <LazyComponent />
</Suspense>
// å¿…é¡»æä¾›æœ‰æ„ä¹‰çš„åŠ è½½UI
```

</BestPractices>

### 7.2 åŠ è½½çŠ¶æ€ç®¡ç†

<BestPractices>

```jsx
// âœ… å¥½çš„åŠ è½½çŠ¶æ€

// 1. å¤šçº§åŠ è½½çŠ¶æ€
<Suspense fallback={<PageLoader />}>
  <Page>
    <Suspense fallback={<SectionLoader />}>
      <Section />
    </Suspense>
  </Page>
</Suspense>

// 2. éª¨æ¶å±
function SkeletonLoader({ type }) {
  if (type === 'page') {
    return (
      <div className="skeleton page-skeleton">
        <div className="skeleton-header" />
        <div className="skeleton-content">
          <div className="skeleton-line" />
          <div className="skeleton-line" />
          <div className="skeleton-line" />
        </div>
      </div>
    );
  }

  if (type === 'card') {
    return (
      <div className="skeleton card-skeleton">
        <div className="skeleton-image" />
        <div className="skeleton-title" />
        <div className="skeleton-text" />
      </div>
    );
  }

  return <div className="skeleton" />;
}

// 3. è¿›åº¦æŒ‡ç¤º
function ProgressLoader({ progress }) {
  return (
    <div className="loader">
      <div
        className="progress-bar"
        style={{ width: `${progress}%` }}
      />
      <div className="progress-text">{progress}% loaded</div>
    </div>
  );
}

// 4. æ™ºèƒ½åŠ è½½ç­–ç•¥
const loadWithRetry = async (importFunc, maxRetries = 3) => {
  for (let i = 0; i < maxRetries; i++) {
    try {
      return await importFunc();
    } catch (error) {
      if (i === maxRetries - 1) {
        throw error;
      }
      await new Promise(resolve => setTimeout(resolve, 1000 * (i + 1)));
    }
  }
};

// 5. è¶…æ—¶å¤„ç†
function SuspenseWithTimeout({
  children,
  fallback,
  timeout = 10000
}) {
  const [timedOut, setTimedOut] = useState(false);

  useEffect(() => {
    const timer = setTimeout(() => {
      setTimedOut(true);
    }, timeout);

    return () => clearTimeout(timer);
  }, [timeout]);

  if (timedOut) {
    return <div>Loading timed out</div>;
  }

  return (
    <Suspense fallback={fallback}>
      {children}
    </Suspense>
  );
}
```

</BestPractices>

### 7.3 é”™è¯¯å¤„ç†

<BestPractices>

```jsx
// âœ… å®Œæ•´çš„é”™è¯¯å¤„ç†

// 1. é”™è¯¯è¾¹ç•Œ
class LazyLoadErrorBoundary extends React.Component {
  constructor(props) {
    super(props);
    this.state = { hasError: false, error: null };
  }

  static getDerivedStateFromError(error) {
    return { hasError: true, error };
  }

  componentDidCatch(error, errorInfo) {
    // è®°å½•é”™è¯¯
    console.error('Lazy loading failed:', error, errorInfo);

    // å‘é€é”™è¯¯æŠ¥å‘Š
    if (window.gtag) {
      window.gtag('event', 'exception', {
        description: error.message,
        fatal: false,
      });
    }
  }

  render() {
    if (this.state.hasError) {
      return (
        <div className="error-fallback">
          <h2>Something went wrong</h2>
          <details>
            <summary>Error details</summary>
            <pre>{this.state.error?.stack}</pre>
          </details>
          <button onClick={() => window.location.reload()}>
            Reload page
          </button>
        </div>
      );
    }

    return this.props.children;
  }
}

// 2. é™çº§æ–¹æ¡ˆ
const LazyComponent = lazy(() =>
  import('./Component')
    .catch(() => import('./ComponentFallback'))
);

// 3. é‡è¯•æœºåˆ¶
function RetryableLazyComponent({ importFunc }) {
  const [retryCount, setRetryCount] = useState(0);
  const [Component, setComponent] = useState(null);
  const [error, setError] = useState(null);

  const attemptLoad = useCallback(async () => {
    try {
      const module = await importFunc();
      setComponent(() => module.default);
      setError(null);
    } catch (err) {
      setError(err);
      if (retryCount < 3) {
        setRetryCount(count => count + 1);
        setTimeout(attemptLoad, 1000 * retryCount);
      }
    }
  }, [importFunc, retryCount]);

  useEffect(() => {
    attemptLoad();
  }, [attemptLoad]);

  if (error) {
    return (
      <div className="error-state">
        <p>Failed to load component</p>
        <button onClick={attemptLoad}>
          Retry ({retryCount}/3)
        </button>
      </div>
    );
  }

  if (!Component) {
    return <LoadingSpinner />;
  }

  return <Component />;
}

// 4. é”™è¯¯ç›‘æ§
function withErrorMonitoring(WrappedComponent) {
  return function MonitoredComponent(props) {
    return (
      <ErrorBoundary>
        <WrappedComponent {...props} />
      </ErrorBoundary>
    );
  };
}
```

</BestPractices>

---

## 8. å®é™…åº”ç”¨æ¡ˆä¾‹

### 8.1 ç”µå•†å¹³å°ä»£ç åˆ†å‰²

<CodeBlock>

```jsx
// ç”µå•†å¹³å°åˆ†å‰²ç­–ç•¥
import { lazy } from 'react';

// é¦–é¡µç»„ä»¶
const Home = lazy(() => import('./pages/Home'));

// å•†å“ç›¸å…³
const ProductList = lazy(() => import('./products/ProductList'));
const ProductDetail = lazy(() => import('./products/ProductDetail'));
const ProductReviews = lazy(() => import('./products/ProductReviews'));

// è´­ç‰©è½¦
const Cart = lazy(() => import('./cart/Cart'));

// ç”¨æˆ·ç›¸å…³
const UserProfile = lazy(() => import('./user/Profile'));
const UserOrders = lazy(() => import('./user/Orders'));
const UserSettings = lazy(() => import('./user/Settings'));

// æ”¯ä»˜
const Checkout = lazy(() => import('./checkout/Checkout'));
const Payment = lazy(() => import('./checkout/Payment'));

// ç®¡ç†åå°
const AdminPanel = lazy(() => import('./admin/Panel'));
const AdminProducts = lazy(() => import('./admin/Products'));
const AdminOrders = lazy(() => import('./admin/Orders'));

// æŠ¥è¡¨
const SalesReport = lazy(() => import('./reports/SalesReport'));
const InventoryReport = lazy(() => import('./reports/InventoryReport'));

// ç¬¬ä¸‰æ–¹åº“åˆ†å‰²
const RichTextEditor = lazy(() => import('react-quill'));
const DatePicker = lazy(() => import('react-datepicker'));
const Chart = lazy(() => import('chart.js'));

// è·¯ç”±é…ç½®
function App() {
  return (
    <Router>
      <Suspense fallback={<AppLoader />}>
        <Routes>
          {/* å…¬å…±é¡µé¢ */}
          <Route path="/" element={<Home />} />
          <Route path="/products" element={<ProductList />} />
          <Route
            path="/products/:id"
            element={
              <Suspense fallback={<ProductDetailSkeleton />}>
                <ProductDetail />
              </Suspense>
            }
          />

          {/* éœ€è¦ç™»å½•çš„é¡µé¢ */}
          <PrivateRoute path="/cart" element={
            <Suspense fallback={<CartSkeleton />}>
              <Cart />
            </Suspense>
          } />

          <PrivateRoute path="/checkout" element={
            <Suspense fallback={<CheckoutSkeleton />}>
              <Checkout />
            </Suspense>
          } />

          {/* ç”¨æˆ·ä¸­å¿ƒ */}
          <PrivateRoute path="/profile" element={
            <Suspense fallback={<UserProfileSkeleton />}>
              <UserProfile />
            </Suspense>
          } />

          <PrivateRoute path="/orders" element={
            <Suspense fallback={<UserOrdersSkeleton />}>
              <UserOrders />
            </Suspense>
          } />

          {/* ç®¡ç†å‘˜é¡µé¢ */}
          <AdminRoute path="/admin" element={
            <Suspense fallback={<AdminLoader />}>
              <AdminPanel />
            </Suspense>
          } />

          {/* æŠ¥è¡¨é¡µé¢ï¼ˆä½é¢‘è®¿é—®ï¼‰ */}
          <AdminRoute path="/reports/sales" element={
            <Suspense fallback={<SalesReportSkeleton />}>
              <SalesReport />
            </Suspense>
          } />
        </Routes>
      </Suspense>
    </Router>
  );
}

// ä»£ç åˆ†å‰²é…ç½®
// webpack.config.js
module.exports = {
  optimization: {
    splitChunks: {
      cacheGroups: {
        vendor: {
          test: /[\\/]node_modules[\\/]/,
          name: 'vendors',
          chunks: 'all',
        },
        ecommerce: {
          test: /[\\/]src[\\/](products|cart|checkout)[\\/]/,
          name: 'ecommerce',
          chunks: 'all',
        },
        admin: {
          test: /[\\/]src[\\/]admin[\\/]/,
          name: 'admin',
          chunks: 'all',
        },
      },
    },
  },
};
```

</CodeBlock>

### 8.2 SaaSä»ªè¡¨æ¿åˆ†å‰²

<CodeBlock>

```jsx
// SaaSåº”ç”¨åˆ†å‰²ç­–ç•¥
import { lazy, Suspense } from 'react';

// æ ¸å¿ƒåŠŸèƒ½
const Dashboard = lazy(() => import('./dashboard/Dashboard'));
const Analytics = lazy(() => import('./analytics/Analytics'));
const UserManagement = lazy(() => import('./users/UserManagement'));

// æ’ä»¶ç³»ç»Ÿ
const PluginHost = lazy(() => import('./plugins/PluginHost'));

// å¯æ’æ‹”åŠŸèƒ½
const installableModules = {
  crm: {
    component: lazy(() => import('./plugins/crm/CRM')),
    routes: ['/crm', '/crm/leads', '/crm/customers'],
  },
  projectManagement: {
    component: lazy(() => import('./plugins/pm/ProjectManager')),
    routes: ['/projects', '/projects/:id'],
  },
  inventory: {
    component: lazy(() => import('./plugins/inventory/Inventory')),
    routes: ['/inventory', '/inventory/items'],
  },
};

// åŠ¨æ€æ’ä»¶åŠ è½½å™¨
function PluginLoader({ pluginName }) {
  const [isInstalled, setIsInstalled] = useState(false);
  const [isLoading, setIsLoading] = useState(false);

  const installPlugin = async (name) => {
    setIsLoading(true);
    try {
      await loadPluginResources(name);
      setIsInstalled(true);
    } catch (error) {
      console.error(`Failed to install plugin: ${name}`, error);
    } finally {
      setIsLoading(false);
    }
  };

  useEffect(() => {
    if (isInstalled) {
      // é¢„åŠ è½½æ’ä»¶èµ„æº
      installableModules[pluginName].component.preload?.();
    }
  }, [isInstalled, pluginName]);

  if (isLoading) {
    return <PluginLoaderSkeleton />;
  }

  if (!isInstalled) {
    return (
      <div className="plugin-installer">
        <h3>{pluginName} Plugin</h3>
        <p>This plugin is not installed</p>
        <button onClick={() => installPlugin(pluginName)}>
          Install Plugin
        </button>
      </div>
    );
  }

  const Component = installableModules[pluginName].component;

  return (
    <Suspense fallback={<PluginSkeleton />}>
      <Component />
    </Suspense>
  );
}

// ä¸»åº”ç”¨
function SaaSApp() {
  const [activeModules, setActiveModules] = useState(['dashboard']);

  return (
    <div className="saas-app">
      <header>
        <nav>
          <button onClick={() => setActiveModules(['dashboard'])}>
            Dashboard
          </button>
          <button onClick={() => setActiveModules(['analytics'])}>
            Analytics
          </button>
          {Object.keys(installableModules).map(module => (
            <button
              key={module}
              onClick={() => setActiveModules([module])}
            >
              {module}
            </button>
          ))}
        </nav>
      </header>

      <main>
        {activeModules.map(module => (
          <Suspense key={module} fallback={<ModuleLoader />}>
            {module === 'dashboard' && <Dashboard />}
            {module === 'analytics' && <Analytics />}
            {module === 'crm' && <PluginLoader pluginName="crm" />}
            {module === 'projectManagement' && (
              <PluginLoader pluginName="projectManagement" />
            )}
            {module === 'inventory' && (
              <PluginLoader pluginName="inventory" />
            )}
          </Suspense>
        ))}
      </main>
    </div>
  );
}
```

</CodeBlock>

### 8.3 CMSå†…å®¹ç®¡ç†ç³»ç»Ÿåˆ†å‰²

<CodeBlock>

```jsx
// CMSåˆ†å‰²ç­–ç•¥
import { lazy } from 'react';

// ç¼–è¾‘å™¨ç›¸å…³
const RichTextEditor = lazy(() => import('./editor/RichTextEditor'));
const MarkdownEditor = lazy(() => import('./editor/MarkdownEditor'));
const CodeEditor = lazy(() => import('./editor/CodeEditor'));

// å†…å®¹ç®¡ç†
const ContentList = lazy(() => import('./content/ContentList'));
const ContentEditor = lazy(() => import('./content/ContentEditor'));
const MediaLibrary = lazy(() => import('./content/MediaLibrary'));

// ä¸»é¢˜ç³»ç»Ÿ
const ThemeEditor = lazy(() => import('./themes/ThemeEditor'));
const ThemeCustomizer = lazy(() => import('./themes/ThemeCustomizer'));

// SEOå·¥å…·
const SEOManager = lazy(() => import('./seo/SEOManager'));

// æ€§èƒ½ç›‘æ§
const PerformanceMonitor = lazy(() => import('./monitoring/Performance'));

// å¤šåª’ä½“å¤„ç†
const ImageEditor = lazy(() => import('./media/ImageEditor'));
const VideoProcessor = lazy(() => import('./media/VideoProcessor'));

// å›½é™…åŒ–
const i18n = {
  en: lazy(() => import('./i18n/en')),
  zh: lazy(() => import('./i18n/zh')),
  es: lazy(() => import('./i18n/es')),
};

// æ ¹æ®å†…å®¹ç±»å‹é€‰æ‹©ç¼–è¾‘å™¨
function EditorSelector({ contentType }) {
  return (
    <Suspense fallback={<EditorLoader />}>
      {contentType === 'rich-text' && <RichTextEditor />}
      {contentType === 'markdown' && <MarkdownEditor />}
      {contentType === 'code' && <CodeEditor />}
    </Suspense>
  );
}

// CMSä¸»ç•Œé¢
function CMSApp() {
  const [currentView, setCurrentView] = useState('content');
  const [selectedLanguage, setSelectedLanguage] = useState('en');

  return (
    <div className="cms-app">
      <aside className="sidebar">
        <nav>
          <button onClick={() => setCurrentView('content')}>
            Content
          </button>
          <button onClick={() => setCurrentView('media')}>
            Media Library
          </button>
          <button onClick={() => setCurrentView('themes')}>
            Themes
          </button>
          <button onClick={() => setCurrentView('seo')}>
            SEO
          </button>
          <button onClick={() => setCurrentView('analytics')}>
            Analytics
          </button>
        </nav>
      </aside>

      <main className="content-area">
        <Suspense fallback={<ViewLoader />}>
          {currentView === 'content' && <ContentList />}
          {currentView === 'media' && <MediaLibrary />}
          {currentView === 'themes' && <ThemeEditor />}
          {currentView === 'seo' && <SEOManager />}
          {currentView === 'analytics' && <PerformanceMonitor />}
        </Suspense>
      </main>

      <footer className="language-switcher">
        <select
          value={selectedLanguage}
          onChange={(e) => setSelectedLanguage(e.target.value)}
        >
          <option value="en">English</option>
          <option value="zh">ä¸­æ–‡</option>
          <option value="es">EspaÃ±ol</option>
        </select>
        <Suspense fallback={null}>
          {React.createElement(i18n[selectedLanguage])}
        </Suspense>
      </footer>
    </div>
  );
}
```

</CodeBlock>

---

## 9. æ€§èƒ½ç›‘æ§ä¸ä¼˜åŒ–

### 9.1 æ€§èƒ½æŒ‡æ ‡ç›‘æ§

<CodeBlock>

```jsx
// 1. BundleåŠ è½½æ—¶é—´ç›‘æ§
function BundlePerformanceTracker() {
  useEffect(() => {
    const observer = new PerformanceObserver((list) => {
      for (const entry of list.getEntries()) {
        if (entry.initiatorType === 'script') {
          // è®°å½•chunkåŠ è½½æ—¶é—´
          console.log(`Chunk: ${entry.name}, Load time: ${entry.duration}ms`);

          // å‘é€åˆ°åˆ†ææœåŠ¡
          if (window.gtag) {
            window.gtag('event', 'chunk_loaded', {
              chunk_name: entry.name,
              load_time: entry.duration,
              transfer_size: entry.transferSize,
            });
          }
        }
      }
    });

    observer.observe({ entryTypes: ['resource'] });

    return () => observer.disconnect();
  }, []);

  return null;
}

// 2. å®é™…ç”¨æˆ·ä½“éªŒç›‘æ§
function UserExperienceMonitor() {
  useEffect(() => {
    // é¦–å±æ¸²æŸ“æ—¶é—´
    const paintEntries = performance.getEntriesByType('paint');
    paintEntries.forEach((entry) => {
      console.log(`${entry.name}: ${entry.startTime}ms`);
    });

    // äº¤äº’æ—¶é—´
    let interactiveTime = 0;
    const navigation = performance.getEntriesByType('navigation')[0];
    interactiveTime = navigation.domInteractive - navigation.navigationStart;
    console.log(`Interactive: ${interactiveTime}ms`);

    // å‘é€æŒ‡æ ‡
    if (window.webVitals) {
      import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {
        getCLS(console.log);
        getFID(console.log);
        getFCP(console.log);
        getLCP(console.log);
        getTTFB(console.log);
      });
    }
  }, []);

  return null;
}

// 3. ä»£ç åˆ†å‰²æ•ˆæœå¯¹æ¯”
function CodeSplittingAnalyzer() {
  const [metrics, setMetrics] = useState({
    initialBundleSize: 0,
    loadedChunks: [],
    cacheHits: 0,
  });

  useEffect(() => {
    // åˆ†æåˆå§‹åŒ…å¤§å°
    const scripts = document.querySelectorAll('script[src*=".js"]:not([src*=".chunk"])');
    scripts.forEach((script) => {
      fetch(script.src, { method: 'HEAD' })
        .then((response) => {
          const size = parseInt(response.headers.get('content-length') || '0');
          setMetrics((prev) => ({
            ...prev,
            initialBundleSize: prev.initialBundleSize + size,
          }));
        });
    });

    // ç›‘æ§chunkåŠ è½½
    const chunkObserver = new PerformanceObserver((list) => {
      const chunks = list.getEntries()
        .filter(entry => entry.name.includes('.chunk'))
        .map(entry => ({
          name: entry.name,
          size: entry.transferSize,
          duration: entry.duration,
        }));

      setMetrics((prev) => ({
        ...prev,
        loadedChunks: chunks,
      }));
    });

    chunkObserver.observe({ entryTypes: ['resource'] });

    return () => chunkObserver.disconnect();
  }, []);

  return (
    <div className="metrics-panel">
      <h3>Code Splitting Metrics</h3>
      <p>Initial Bundle: {(metrics.initialBundleSize / 1024).toFixed(2)} KB</p>
      <p>Loaded Chunks: {metrics.loadedChunks.length}</p>
      <p>
        Total Chunk Size: {(
          metrics.loadedChunks.reduce((sum, chunk) => sum + chunk.size, 0) / 1024
        ).toFixed(2)} KB
      </p>
    </div>
  );
}
```

</CodeBlock>

### 9.2 è‡ªåŠ¨åŒ–æ€§èƒ½ä¼˜åŒ–

<CodeBlock>

```jsx
// 1. æ™ºèƒ½é¢„åŠ è½½
function IntelligentPreloader() {
  const [userBehavior, setUserBehavior] = useState({});

  useEffect(() => {
    // åˆ†æç”¨æˆ·è¡Œä¸º
    const trackUserInteraction = (e) => {
      const { type, target } = e;
      const path = getElementPath(target);

      // è®°å½•ç”¨æˆ·äº¤äº’
      analytics.track('user_interaction', {
        type,
        path,
        timestamp: Date.now(),
      });
    };

    document.addEventListener('click', trackUserInteraction, true);
    document.addEventListener('mouseover', trackUserInteraction, true);
    document.addEventListener('touchstart', trackUserInteraction, true);

    return () => {
      document.removeEventListener('click', trackUserInteraction, true);
      document.removeEventListener('mouseover', trackUserInteraction, true);
      document.removeEventListener('touchstart', trackUserInteraction, true);
    };
  }, []);

  useEffect(() => {
    // åŸºäºåˆ†æç»“æœé¢„åŠ è½½
    const predictAndPrefetch = async () => {
      const predictions = await getUserBehaviorPredictions();

      predictions.forEach((prediction) => {
        if (prediction.probability > 0.7) {
          // é«˜æ¦‚ç‡é¢„æµ‹ï¼Œé¢„åŠ è½½
          import(`./pages${prediction.path}`).then((module) => {
            console.log(`Prefetched: ${prediction.path}`);
          });
        }
      });
    };

    predictAndPrefetch();
  }, [userBehavior]);

  return null;
}

// 2. è‡ªé€‚åº”åŠ è½½ç­–ç•¥
function AdaptiveLoader() {
  const [connection, setConnection] = useState(null);
  const [deviceInfo, setDeviceInfo] = useState(null);

  useEffect(() => {
    // æ£€æµ‹ç½‘ç»œçŠ¶å†µ
    if ('connection' in navigator) {
      setConnection(navigator.connection);
    }

    // æ£€æµ‹è®¾å¤‡ä¿¡æ¯
    setDeviceInfo({
      isMobile: /Mobi|Android/i.test(navigator.userAgent),
      isLowEnd: navigator.hardwareConcurrency < 4,
      memory: navigator.deviceMemory,
    });
  }, []);

  const getLoadingStrategy = useCallback(() => {
    if (!connection || !deviceInfo) {
      return 'default';
    }

    const isSlowConnection = ['slow-2g', '2g'].includes(connection.effectiveType);
    const isLowEndDevice = deviceInfo.isLowEnd || deviceInfo.memory < 4;
    const isMobile = deviceInfo.isMobile;

    if (isSlowConnection || isLowEndDevice) {
      return 'conservative'; // ä¿å®ˆåŠ è½½
    }

    if (isMobile) {
      return 'balanced'; // å¹³è¡¡æ¨¡å¼
    }

    return 'aggressive'; // æ¿€è¿›æ¨¡å¼
  }, [connection, deviceInfo]);

  const strategy = getLoadingStrategy();

  useEffect(() => {
    switch (strategy) {
      case 'conservative':
        // åªé¢„åŠ è½½æ ¸å¿ƒèµ„æº
        prefetchEssential();
        break;
      case 'balanced':
        // é¢„åŠ è½½æ ¸å¿ƒå’Œå¸¸è§èµ„æº
        prefetchCommon();
        break;
      case 'aggressive':
        // ç§¯æé¢„åŠ è½½
        prefetchAggressive();
        break;
    }
  }, [strategy]);

  return null;
}
```

</CodeBlock>

---

## 10. å¸¸è§é™·é˜±å’Œè§£å†³æ–¹æ¡ˆ

### 10.1 åŠ¨æ€å¯¼å…¥é”™è¯¯

<ErrorBox>

```jsx
// âŒ é”™è¯¯ - å¿½ç•¥åŠ è½½å¤±è´¥
const BadComponent = lazy(() => import('./Component'));

function BadApp() {
  return (
    <Suspense fallback={<div>Loading...</div>}>
      <BadComponent />
    </Suspense>
  );
}

// âœ… æ­£ç¡® - å¤„ç†åŠ è½½é”™è¯¯
const GoodComponent = lazy(() =>
  import('./Component').catch(err => {
    console.error('Failed to load component:', err);
    return { default: ErrorFallback };
  })
);

function GoodApp() {
  return (
    <ErrorBoundary>
      <Suspense fallback={<div>Loading...</div>}>
        <GoodComponent />
      </Suspense>
    </ErrorBoundary>
  );
}

// âŒ é”™è¯¯ - æ²¡æœ‰é”™è¯¯è¾¹ç•Œ
const ComponentWithoutErrorBoundary = lazy(() =>
  import('./MightFailComponent')
);

// âœ… æ­£ç¡® - å®Œæ•´çš„é”™è¯¯å¤„ç†
class ErrorBoundary extends React.Component {
  state = { hasError: false, error: null };

  static getDerivedStateFromError(error) {
    return { hasError: true, error };
  }

  componentDidCatch(error, errorInfo) {
    console.error('Lazy loading error:', error, errorInfo);
  }

  render() {
    if (this.state.hasError) {
      return <ErrorFallback error={this.state.error} />;
    }
    return this.props.children;
  }
}

const SafeComponent = lazy(() => import('./MightFailComponent'));
```

</ErrorBox>

### 10.2 è¿‡åº¦åˆ†å‰²

<ErrorBox>

```jsx
// âŒ é”™è¯¯ - è¿‡åº¦åˆ†å‰²
const Button = lazy(() => import('./Button'));
const Input = lazy(() => import('./Input'));
const Card = lazy(() => import('./Card'));
const Modal = lazy(() => import('./Modal'));

function Form() {
  return (
    <>
      <Suspense fallback={null}><Button /></Suspense>
      <Suspense fallback={null}><Input /></Suspense>
      <Suspense fallback={null}><Card /></Suspense>
      <Suspense fallback={null}><Modal /></Suspense>
    </>
  );
}

// é—®é¢˜ï¼šæ¯ä¸ªå°ç»„ä»¶éƒ½å•ç‹¬è¯·æ±‚ï¼Œå¢åŠ ç½‘ç»œå¼€é”€

// âœ… æ­£ç¡® - åˆç†åˆ†å‰²
// 1. æŒ‰åŠŸèƒ½æ¨¡å—åˆ†å‰²
const FormModule = lazy(() => import('./form/FormModule'));

// 2. æŒ‰è·¯ç”±åˆ†å‰²
const SettingsPage = lazy(() => import('./pages/Settings'));

// 3. æŒ‰ä½¿ç”¨é¢‘ç‡åˆ†å‰²
const HighFrequencyModule = lazy(() => import('./common/HighFrequency'));
const LowFrequencyModule = lazy(() => import('./admin/LowFrequency'));

// 4. æŒ‰å¤§å°åˆ†å‰²
const SmallUtility = lazy(() => import('./utils/SmallUtility')); // å°äº5KB
// ä¸åˆ†å‰²ï¼Œç›´æ¥å¼•å…¥
import { helperFunction } from './utils/helper';

// 5. ç¬¬ä¸‰æ–¹åº“åˆ†ç»„
const UIChunks = {
  antd: ['antd', '@ant-design/icons'],
  material: ['@mui/material', '@mui/icons-material'],
  chart: ['chart.js', 'react-chartjs-2'],
};

// webpacké…ç½®
module.exports = {
  optimization: {
    splitChunks: {
      chunks: 'all',
      minSize: 20000, // æœ€å°20KBæ‰åˆ†å‰²
      cacheGroups: {
        // åˆå¹¶å°çš„å·¥å…·å‡½æ•°
        utils: {
          test: /[\\/]src[\\/]utils[\\/]/,
          name: 'utils',
          chunks: 'all',
          enforce: true,
        },
      },
    },
  },
};
```

</ErrorBox>

### 10.3 åŠ è½½çŠ¶æ€é—®é¢˜

<ErrorBox>

```jsx
// âŒ é”™è¯¯ - åŠ è½½çŠ¶æ€ä¸å‹å¥½
const BadComponent = lazy(() => import('./Component'));

function BadApp() {
  return (
    <Suspense fallback={<div>Loading...</div>}>
      <BadComponent />
    </Suspense>
  );
}

// âœ… æ­£ç¡® - æœ‰æ„ä¹‰çš„åŠ è½½çŠ¶æ€
const GoodComponent = lazy(() => import('./Component'));

function GoodApp() {
  return (
    <Suspense
      fallback={
        <ComponentSkeleton>
          <div className="skeleton-header" />
          <div className="skeleton-content">
            <div className="skeleton-line" />
            <div className="skeleton-line" />
            <div className="skeleton-line" />
          </div>
        </ComponentSkeleton>
      }
    >
      <GoodComponent />
    </Suspense>
  );
}

// âŒ é”™è¯¯ - æ²¡æœ‰æœ€å°æ˜¾ç¤ºæ—¶é—´
function InstantHideLoader() {
  const [isLoaded, setIsLoaded] = useState(false);

  useEffect(() => {
    // å¿«é€ŸåŠ è½½æ—¶ï¼Œé—ªä¸€ä¸‹å°±æ¶ˆå¤±
    import('./Component').then(() => setIsLoaded(true));
  }, []);

  if (isLoaded) return <Component />;
  return <div>Loading...</div>;
}

// âœ… æ­£ç¡® - æœ€å°æ˜¾ç¤ºæ—¶é—´
function StableLoader({ minDisplayTime = 500 }) {
  const [isVisible, setIsVisible] = useState(true);

  useEffect(() => {
    const timer = setTimeout(() => {
      setIsVisible(false);
    }, minDisplayTime);

    return () => clearTimeout(timer);
  }, [minDisplayTime]);

  if (!isVisible) return null;
  return <LoadingSpinner />;
}

// âœ… æ­£ç¡® - å¤šçº§åŠ è½½çŠ¶æ€
function MultiLevelLoader() {
  return (
    <div>
      <Suspense fallback={<PageLoader />}>
        <Page>
          <Suspense fallback={<SectionLoader />}>
            <Section />
          </Suspense>
        </Page>
      </Suspense>
    </div>
  );
}
```

</ErrorBox>

### 10.4 ç¼“å­˜é—®é¢˜

<ErrorBox>

```jsx
// âŒ é”™è¯¯ - æ²¡æœ‰ç¼“å­˜ç­–ç•¥
const NoCacheComponent = lazy(() => import('./Component'));

function NoCacheApp() {
  const [show, setShow] = useState(false);

  return (
    <>
      <button onClick={() => setShow(true)}>Show</button>
      {show && (
        <Suspense fallback={<div>Loading...</div>}>
          <NoCacheComponent />
        </Suspense>
      )}
    </>
  );
}

// é—®é¢˜ï¼šæ¯æ¬¡showå˜ä¸ºtrueéƒ½é‡æ–°åŠ è½½

// âœ… æ­£ç¡® - ä½¿ç”¨ç¼“å­˜
const cachedImports = new Map();

function cachedImport(importFunc, key) {
  if (cachedImports.has(key)) {
    return cachedImports.get(key);
  }

  const promise = importFunc();
  cachedImports.set(key, promise);
  return promise;
}

const CachedComponent = lazy(() =>
  cachedImport(() => import('./Component'), 'component-key')
);

function CachedApp() {
  const [show, setShow] = useState(false);
  const [loaded, setLoaded] = useState(false);

  useEffect(() => {
    if (show && !loaded) {
      // é¢„å…ˆåŠ è½½
      cachedImport(() => import('./Component'), 'component-key')
        .then(() => setLoaded(true));
    }
  }, [show, loaded]);

  return (
    <>
      <button onClick={() => setShow(true)}>Show</button>
      {show && (
        <Suspense fallback={<div>Loading...</div>}>
          <CachedComponent />
        </Suspense>
      )}
    </>
  );
}

// âœ… æ­£ç¡® - å†…å­˜ç®¡ç†
function MemoryManagedApp() {
  const [cache, setCache] = useState(new Map());

  const loadComponent = useCallback(async (key) => {
    if (cache.has(key)) {
      return cache.get(key);
    }

    const module = await import(`./${key}`);
    setCache(prev => new Map(prev.set(key, module)));

    // æ¸…ç†æ—§ç¼“å­˜ï¼ˆé™åˆ¶å¤§å°ï¼‰
    if (cache.size > 10) {
      const entries = Array.from(cache.entries());
      const [oldestKey] = entries[0];
      setCache(prev => {
        const newCache = new Map(prev);
        newCache.delete(oldestKey);
        return newCache;
      });
    }

    return module;
  }, [cache]);

  return <ComponentLoader loadComponent={loadComponent} />;
}
```

</ErrorBox>

---

## 11. å®è·µç»ƒä¹ 

### ç»ƒä¹ 1ï¼šå®ç°åŸºç¡€ä»£ç åˆ†å‰²

<Expandable title="ç‚¹å‡»æŸ¥çœ‹è¦æ±‚">

**åŠŸèƒ½è¦æ±‚**ï¼š
- åˆ›å»ºåŒ…å«å¤šä¸ªé¡µé¢çš„Reactåº”ç”¨
- å®ç°è·¯ç”±çº§åˆ«çš„ä»£ç åˆ†å‰²
- ä¸ºæ¯ä¸ªé¡µé¢æ·»åŠ åŠ è½½çŠ¶æ€
- ä¼˜åŒ–é¦–å±åŠ è½½æ—¶é—´

**å®ç°è¦æ±‚**ï¼š
```javascript
// éœ€è¦å®ç°çš„åŠŸèƒ½
import { lazy, Suspense } from 'react';

const Home = lazy(() => import('./pages/Home'));
const About = lazy(() => import('./pages/About'));
const Dashboard = lazy(() => import('./pages/Dashboard'));

// è·¯ç”±é…ç½®
function App() {
  return (
    <BrowserRouter>
      <Suspense fallback={<Loading />}>
        <Routes>
          <Route path="/" element={<Home />} />
          <Route path="/about" element={<About />} />
          <Route path="/dashboard" element={<Dashboard />} />
        </Routes>
      </Suspense>
    </BrowserRouter>
  );
}
```

**æç¤º**ï¼š
- ä½¿ç”¨React.lazyè¿›è¡Œæ‡’åŠ è½½
- ç”¨SuspenseåŒ…è£…æ‡’åŠ è½½ç»„ä»¶
- åˆ›å»ºæœ‰æ„ä¹‰çš„åŠ è½½UI
- æµ‹é‡é¦–å±åŠ è½½æ—¶é—´

</Expandable>

### ç»ƒä¹ 2ï¼šå®ç°ç»„ä»¶çº§ä»£ç åˆ†å‰²

<Expandable title="ç‚¹å‡»æŸ¥çœ‹è¦æ±‚">

**åŠŸèƒ½è¦æ±‚**ï¼š
- åˆ›å»ºæ¡ä»¶æ¸²æŸ“çš„ç»„ä»¶
- å®ç°æŒ‰éœ€åŠ è½½ç¬¬ä¸‰æ–¹åº“
- æ·»åŠ é”™è¯¯å¤„ç†å’Œé‡è¯•æœºåˆ¶
- ä¼˜åŒ–bundleå¤§å°

**å®ç°è¦æ±‚**ï¼š
```javascript
// éœ€è¦å®ç°çš„åŠŸèƒ½
const HeavyWidget = lazy(() => import('./HeavyWidget'));
const Chart = lazy(() => import('chart.js'));

function Dashboard() {
  const [showWidget, setShowWidget] = useState(false);
  const [showChart, setShowChart] = useState(false);

  return (
    <div>
      <button onClick={() => setShowWidget(true)}>
        Load Widget
      </button>
      <button onClick={() => setShowChart(true)}>
        Show Chart
      </button>

      <Suspense fallback={<WidgetSkeleton />}>
        {showWidget && <HeavyWidget />}
      </Suspense>

      <Suspense fallback={<ChartSkeleton />}>
        {showChart && <Chart />}
      </Suspense>
    </div>
  );
}
```

**æç¤º**ï¼š
- åŒºåˆ†æ ¸å¿ƒåŠŸèƒ½å’Œå¯é€‰åŠŸèƒ½
- åˆç†è®¾ç½®Suspenseè¾¹ç•Œ
- å®ç°é”™è¯¯è¾¹ç•Œ
- ç›‘æ§bundleå¤§å°

</Expandable>

### ç»ƒä¹ 3ï¼šå®ç°æ™ºèƒ½é¢„åŠ è½½ç³»ç»Ÿ

<Expandable title="ç‚¹å‡»æŸ¥çœ‹è¦æ±‚">

**åŠŸèƒ½è¦æ±‚**ï¼š
- å®ç°åŸºäºç”¨æˆ·è¡Œä¸ºçš„é¢„åŠ è½½
- æ·»åŠ é¢„è·å–å’Œé¢„åŠ è½½ç­–ç•¥
- æ ¹æ®ç½‘ç»œçŠ¶å†µè°ƒæ•´åŠ è½½ç­–ç•¥
- å®ç°ç¼“å­˜æœºåˆ¶

**å®ç°è¦æ±‚**ï¼š
```javascript
// éœ€è¦å®ç°çš„åŠŸèƒ½
function IntelligentPreloader() {
  const [userBehavior, setUserBehavior] = useState({});

  useEffect(() => {
    // åˆ†æç”¨æˆ·è¡Œä¸º
    const trackUserInteraction = (e) => {
      // å®ç°ç”¨æˆ·è¡Œä¸ºè¿½è¸ª
    };

    // åŸºäºè¡Œä¸ºé¢„åŠ è½½
    const predictAndPrefetch = () => {
      // å®ç°é¢„æµ‹å’Œé¢„åŠ è½½é€»è¾‘
    };

    document.addEventListener('click', trackUserInteraction);
    predictAndPrefetch();

    return () => {
      document.removeEventListener('click', trackUserInteraction);
    };
  }, [userBehavior]);

  return null;
}
```

**æç¤º**ï¼š
- æ”¶é›†ç”¨æˆ·è¡Œä¸ºæ•°æ®
- å®ç°é¢„æµ‹ç®—æ³•
- é¢„è·å–å¸¸ç”¨èµ„æº
- ç¼“å­˜å’Œæ¸…ç†ç­–ç•¥

</Expandable>

### ç»ƒä¹ 4ï¼šå®ç°æ€§èƒ½ç›‘æ§ä»ªè¡¨æ¿

<Expandable title="ç‚¹å‡»æŸ¥çœ‹è¦æ±‚">

**åŠŸèƒ½è¦æ±‚**ï¼š
- ç›‘æ§bundleåŠ è½½æ—¶é—´
- è¿½è¸ªä»£ç åˆ†å‰²æ•ˆæœ
- åˆ†æé¦–å±æ€§èƒ½æŒ‡æ ‡
- æä¾›ä¼˜åŒ–å»ºè®®

**å®ç°è¦æ±‚**ï¼š
```javascript
// éœ€è¦å®ç°çš„åŠŸèƒ½
function PerformanceDashboard() {
  const [metrics, setMetrics] = useState({
    bundleSize: 0,
    loadTime: 0,
    cacheHitRate: 0,
  });

  useEffect(() => {
    // æ”¶é›†æ€§èƒ½æŒ‡æ ‡
    const collectMetrics = () => {
      // å®ç°æŒ‡æ ‡æ”¶é›†
    };

    // åˆ†æä¼˜åŒ–å»ºè®®
    const generateRecommendations = () => {
      // å®ç°ä¼˜åŒ–å»ºè®®ç”Ÿæˆ
    };

    collectMetrics();
    generateRecommendations();
  }, []);

  return (
    <div className="performance-dashboard">
      <h2>Performance Metrics</h2>
      <div className="metric-card">
        <h3>Bundle Size</h3>
        <p>{metrics.bundleSize} KB</p>
      </div>
      <div className="metric-card">
        <h3>Load Time</h3>
        <p>{metrics.loadTime} ms</p>
      </div>
      <div className="metric-card">
        <h3>Cache Hit Rate</h3>
        <p>{metrics.cacheHitRate}%</p>
      </div>
    </div>
  );
}
```

**æç¤º**ï¼š
- ä½¿ç”¨Performance API
- è¿½è¸ªå…³é”®æŒ‡æ ‡
- å¯è§†åŒ–æ•°æ®
- æä¾›ä¼˜åŒ–å»ºè®®

</Expandable>

---

## 12. æœ¬ç« å°ç»“

### å…³é”®è¦ç‚¹

<Checklist>

- âœ… ä»£ç åˆ†å‰²æ˜¯æå‡åº”ç”¨æ€§èƒ½çš„å…³é”®æŠ€æœ¯
- âœ… React.lazyå’ŒSuspenseæ˜¯å®ç°ä»£ç åˆ†å‰²çš„æ ¸å¿ƒAPI
- âœ… è·¯ç”±çº§ä»£ç åˆ†å‰²æ˜¯æœ€å¸¸è§ä¸”æœ‰æ•ˆçš„ç­–ç•¥
- âœ… ç»„ä»¶çº§ä»£ç åˆ†å‰²å¯ä»¥è¿›ä¸€æ­¥ä¼˜åŒ–æ€§èƒ½
- âœ… åˆç†è®¾ç½®åŠ è½½çŠ¶æ€å¯¹ç”¨æˆ·ä½“éªŒè‡³å…³é‡è¦
- âœ… é”™è¯¯å¤„ç†å’Œé‡è¯•æœºåˆ¶æ˜¯ä»£ç åˆ†å‰²çš„é‡è¦ç»„æˆéƒ¨åˆ†
- âœ… Bundleåˆ†æå·¥å…·å¸®åŠ©ä¼˜åŒ–åˆ†å‰²ç­–ç•¥
- âœ… é¢„åŠ è½½å’Œé¢„è·å–å¯ä»¥è¿›ä¸€æ­¥æå‡æ€§èƒ½
- âœ… é¿å…è¿‡åº¦åˆ†å‰²å¯¼è‡´è¯·æ±‚è¿‡å¤š
- âœ… ç›‘æ§æ€§èƒ½æŒ‡æ ‡æŒç»­ä¼˜åŒ–

</Checklist>

### ä»£ç åˆ†å‰²æœ€ä½³å®è·µ

<BestPractices>

1. **åˆç†åˆ†å‰²** - æŒ‰åŠŸèƒ½æ¨¡å—å’Œè·¯ç”±åˆ†å‰²ï¼Œé¿å…è¿‡åº¦åˆ†å‰²
2. **åŠ è½½çŠ¶æ€** - æä¾›æœ‰æ„ä¹‰çš„åŠ è½½UIå’Œéª¨æ¶å±
3. **é”™è¯¯å¤„ç†** - ä½¿ç”¨é”™è¯¯è¾¹ç•Œå’Œå¤„ç†åŠ è½½å¤±è´¥
4. **æ€§èƒ½ç›‘æ§** - æŒç»­ç›‘æ§Bundleå¤§å°å’ŒåŠ è½½æ—¶é—´
5. **é¢„åŠ è½½ç­–ç•¥** - åŸºäºç”¨æˆ·è¡Œä¸ºé¢„åŠ è½½å¸¸ç”¨èµ„æº
6. **ç¼“å­˜æœºåˆ¶** - å®ç°æ™ºèƒ½ç¼“å­˜é¿å…é‡å¤åŠ è½½
7. **åˆ†æä¼˜åŒ–** - å®šæœŸåˆ†æBundleå’Œä¼˜åŒ–åˆ†å‰²ç­–ç•¥
8. **æ¸è¿›å¢å¼º** - ç¡®ä¿åŸºæœ¬åŠŸèƒ½åœ¨æ— JSæ—¶ä¹Ÿèƒ½å·¥ä½œ

</BestPractices>

### ä½•æ—¶ä½¿ç”¨ä»£ç åˆ†å‰²

<BestPractices>

**æ¨èä½¿ç”¨ä»£ç åˆ†å‰²çš„åœºæ™¯**ï¼š
- å¤šé¡µé¢åº”ç”¨ï¼ˆMPAï¼‰
- å¤§å‹å•é¡µåº”ç”¨ï¼ˆSPAï¼‰
- åŠŸèƒ½æ¨¡å—ç›¸å¯¹ç‹¬ç«‹
- æœ‰å¤§å‹ç¬¬ä¸‰æ–¹åº“ä¾èµ–
- ä½é¢‘è®¿é—®çš„ç®¡ç†åŠŸèƒ½
- ç”¨æˆ·å®šåˆ¶åŒ–åŠŸèƒ½

**ä¸éœ€è¦ä»£ç åˆ†å‰²çš„åœºæ™¯**ï¼š
- ç®€å•å•é¡µåº”ç”¨
- æ ¸å¿ƒåŠŸèƒ½å¿…é¡»ç«‹å³å¯ç”¨
- é«˜åº¦SEOæ•æ„Ÿçš„é¡µé¢
- å®æ—¶äº¤äº’åº”ç”¨
- é¦–å±å¿…é¡»å®Œæ•´å±•ç¤º

</BestPractices>

### ä¸‹ä¸€æ­¥å­¦ä¹ 

ç°åœ¨ä½ å·²ç»æŒæ¡äº†ä»£ç åˆ†å‰²çš„åŸºç¡€å’Œåº”ç”¨ï¼Œæ¥ä¸‹æ¥å¯ä»¥å­¦ä¹ ï¼š

1. **[æ€§èƒ½ç›‘æ§å·¥å…·]** - æ·±åº¦æ€§èƒ½åˆ†æ
2. **[React Profiler]** - æ¸²æŸ“æ€§èƒ½åˆ†æ
3. **[æœåŠ¡ç«¯æ¸²æŸ“(SSR)]** - é¦–å±æ€§èƒ½ä¼˜åŒ–
4. **[æ¸è¿›å¼Webåº”ç”¨(PWA)]** - ç¦»çº¿ç¼“å­˜å’Œæ€§èƒ½

---

## 13. å»¶ä¼¸é˜…è¯»

### å®˜æ–¹èµ„æº

- [React.lazyæ–‡æ¡£](https://react.dev/reference/react/lazy) - å®˜æ–¹æ‡’åŠ è½½API
- [Suspenseæ–‡æ¡£](https://react.dev/reference/react/Suspense) - å®˜æ–¹SuspenseæŒ‡å—
- [Webpackä»£ç åˆ†å‰²](https://webpack.js.org/guides/code-splitting/) - æ„å»ºå·¥å…·åˆ†å‰²æŒ‡å—
- [Viteæ„å»ºä¼˜åŒ–](https://vitejs.dev/guide/build.html) - Viteåˆ†å‰²ç­–ç•¥

### æ¨èé˜…è¯»

- [Code Splitting Patterns](https://patterns.dev/) - ç°ä»£ä»£ç åˆ†å‰²æ¨¡å¼
- [Bundle Analysis Guide](https://web.dev/find-and-fix-performance-issues/) - Bundleåˆ†ææŒ‡å—
- [Loading Performance](https://web.dev/loading-performance/) - åŠ è½½æ€§èƒ½ä¼˜åŒ–

### ç›¸å…³è¯é¢˜

- [React.memo](../react-memo) - ç»„ä»¶è®°å¿†åŒ–
- [è™šæ‹ŸåŒ–æŠ€æœ¯](../virtualization) - å¤§æ•°æ®æ¸²æŸ“ä¼˜åŒ–
- [æ€§èƒ½ä¼˜åŒ–è¿›é˜¶](../advanced/advanced-optimization) - æ·±å…¥æ€§èƒ½ä¼˜åŒ–

---

[â† ä¸Šä¸€ç« ï¼šè™šæ‹ŸåŒ–æŠ€æœ¯](virtualization) | [ä¸‹ä¸€ç« ï¼šæ€§èƒ½ç›‘æ§å·¥å…· â†’](../)
