# åˆ—è¡¨æ¸²æŸ“ä¸Keys

import { Tabs, TabItem } from '@docusaurus/theme-common';

åˆ—è¡¨æ¸²æŸ“æ˜¯Reactä¸­çš„æ ¸å¿ƒæ¦‚å¿µä¹‹ä¸€ï¼Œå®ƒå…è®¸ä½ åŠ¨æ€åœ°æ¸²æŸ“ä¸€ç»„æ•°æ®ã€‚åœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬å°†å­¦ä¹ å¦‚ä½•é«˜æ•ˆåœ°æ¸²æŸ“åˆ—è¡¨ã€ç†è§£Keysçš„ä½œç”¨ï¼Œä»¥åŠé¿å…å¸¸è§çš„æ€§èƒ½é—®é¢˜ã€‚

## æœ¬ç« å­¦ä¹ ç›®æ ‡

- æŒæ¡ä½¿ç”¨`Array.map()`æ¸²æŸ“åˆ—è¡¨
- ç†è§£Keysçš„ä½œç”¨å’Œé‡è¦æ€§
- å­¦ä¼šé€‰æ‹©åˆé€‚çš„Keyå€¼
- æŒæ¡åˆ—è¡¨çš„è¿‡æ»¤ã€æ’åºå’ŒåŠ¨æ€æ›´æ–°
- ç†è§£è™šæ‹ŸåŒ–åˆ—è¡¨ä¼˜åŒ–æ€§èƒ½
- é¿å…åˆ—è¡¨æ¸²æŸ“çš„å¸¸è§é”™è¯¯

---

## 1. ä¸ºä»€ä¹ˆéœ€è¦åˆ—è¡¨æ¸²æŸ“ï¼Ÿ

åœ¨Reactåº”ç”¨ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦åŠ¨æ€åœ°æ¸²æŸ“ä¸€ç»„æ•°æ®ï¼Œæ¯”å¦‚ç”¨æˆ·åˆ—è¡¨ã€äº§å“åˆ—è¡¨ã€è¯„è®ºåˆ—è¡¨ç­‰ã€‚åˆ—è¡¨æ¸²æŸ“è®©æˆ‘ä»¬å¯ä»¥æ ¹æ®æ•°æ®åŠ¨æ€ç”ŸæˆUIå…ƒç´ ã€‚

<Box style={{ padding: '20px', background: '#e3f2fd', borderRadius: '8px', margin: '20px 0' }}>
  <h4 style={{ margin: 0, color: '#1976d2' }}>ğŸ’¡ æ ¸å¿ƒæ¦‚å¿µ</h4>
  <p style={{ margin: '10px 0 0 0' }}>
    åˆ—è¡¨æ¸²æŸ“å°†<strong>æ•°æ®æ•°ç»„</strong>è½¬æ¢ä¸º<strong>Reactå…ƒç´ æ•°ç»„</strong>ï¼Œæ¯ä¸ªæ•°æ®é¡¹å¯¹åº”ä¸€ä¸ªUIå…ƒç´ ã€‚
  </p>
</Box>

<Example>

```jsx
// æ•°æ®æ•°ç»„
const users = [
  { id: 1, name: 'Alice' },
  { id: 2, name: 'Bob' },
  { id: 3, name: 'Charlie' }
];

// è½¬æ¢ä¸ºReactå…ƒç´ æ•°ç»„
const userList = users.map(user => (
  <li key={user.id}>{user.name}</li>
));

// æ¸²æŸ“åˆ°DOM
<ul>{userList}</ul>
```

</Example>

---

## 2. åŸºç¡€åˆ—è¡¨æ¸²æŸ“

### 2.1 ä½¿ç”¨Array.map()

æœ€å¸¸è§çš„åˆ—è¡¨æ¸²æŸ“æ–¹æ³•æ˜¯ä½¿ç”¨`Array.map()`æ–¹æ³•ï¼Œå®ƒåˆ›å»ºä¸€ä¸ªæ–°æ•°ç»„ï¼ŒåŒ…å«å¯¹æ¯ä¸ªå…ƒç´ è°ƒç”¨å‡½æ•°åçš„ç»“æœã€‚

<CodeBlock>

```jsx
function UserList() {
  const users = [
    { id: 1, name: 'Alice', email: 'alice@example.com' },
    { id: 2, name: 'Bob', email: 'bob@example.com' },
    { id: 3, name: 'Charlie', email: 'charlie@example.com' }
  ];

  return (
    <div>
      <h2>ç”¨æˆ·åˆ—è¡¨</h2>
      <ul>
        {users.map(user => (
          <li key={user.id}>
            <strong>{user.name}</strong>
            <p>{user.email}</p>
          </li>
        ))}
      </ul>
    </div>
  );
}
```

</CodeBlock>

### 2.2 å†…è”æ¸²æŸ“

ä½ ä¹Ÿå¯ä»¥ç›´æ¥åœ¨JSXä¸­å†…è”æ¸²æŸ“åˆ—è¡¨ï¼Œæ— éœ€å…ˆåˆ›å»ºå˜é‡ã€‚

<CodeBlock>

```jsx
function ProductList() {
  const products = [
    { id: 1, name: 'Laptop', price: 999 },
    { id: 2, name: 'Phone', price: 699 },
    { id: 3, name: 'Tablet', price: 399 }
  ];

  return (
    <div>
      <h2>äº§å“åˆ—è¡¨</h2>
      {products.map(product => (
        <div key={product.id} style={{ marginBottom: '20px' }}>
          <h3>{product.name}</h3>
          <p>ä»·æ ¼: Â¥{product.price}</p>
        </div>
      ))}
    </div>
  );
}
```

</CodeBlock>

### 2.3 å¤æ‚åˆ—è¡¨é¡¹

åˆ—è¡¨é¡¹å¯ä»¥æ˜¯å¤æ‚çš„JSXç»“æ„ï¼ŒåŒ…å«å¤šä¸ªå…ƒç´ å’Œæ¡ä»¶æ¸²æŸ“ã€‚

<LiveCode
  code={`
function TaskListDemo() {
  const [tasks, setTasks] = React.useState([
    { id: 1, text: 'å­¦ä¹ React Hooks', completed: true, priority: 'high' },
    { id: 2, text: 'æ„å»ºé¡¹ç›®ç»„ä»¶', completed: false, priority: 'medium' },
    { id: 3, text: 'é˜…è¯»å®˜æ–¹æ–‡æ¡£', completed: false, priority: 'low' },
    { id: 4, text: 'å®Œæˆä»£ç å®¡æŸ¥', completed: true, priority: 'medium' }
  ]);
  const [newTask, setNewTask] = React.useState('');

  const addTask = () => {
    if (newTask.trim()) {
      setTasks([...tasks, {
        id: Date.now(),
        text: newTask,
        completed: false,
        priority: 'medium'
      }]);
      setNewTask('');
    }
  };

  const toggleTask = (id) => {
    setTasks(tasks.map(task =>
      task.id === id ? { ...task, completed: !task.completed } : task
    ));
  };

  const deleteTask = (id) => {
    setTasks(tasks.filter(task => task.id !== id));
  };

  const completedCount = tasks.filter(t => t.completed).length;

  return (
    <div style={{ padding: '20px' }}>
      <h3 style={{ marginTop: 0 }}>ğŸ“ ä»»åŠ¡åˆ—è¡¨</h3>

      <div style={{ marginBottom: '20px', display: 'flex', gap: '10px' }}>
        <input
          type="text"
          value={newTask}
          onChange={(e) => setNewTask(e.target.value)}
          onKeyPress={(e) => e.key === 'Enter' && addTask()}
          placeholder="æ·»åŠ æ–°ä»»åŠ¡..."
          style={{
            flex: 1,
            padding: '10px',
            fontSize: '16px',
            border: '2px solid #ddd',
            borderRadius: '6px'
          }}
        />
        <button
          onClick={addTask}
          style={{
            padding: '10px 20px',
            background: '#4caf50',
            color: 'white',
            border: 'none',
            borderRadius: '6px',
            cursor: 'pointer',
            fontWeight: 'bold'
          }}
        >
          â• æ·»åŠ 
        </button>
      </div>

      <div style={{
        marginBottom: '20px',
        padding: '15px',
        background: '#f5f5f5',
        borderRadius: '6px',
        textAlign: 'center'
      }}>
        <strong>è¿›åº¦ï¼š</strong> {completedCount} / {tasks.length} å·²å®Œæˆ
        <div style={{
          marginTop: '10px',
          height: '10px',
          background: '#e0e0e0',
          borderRadius: '5px',
          overflow: 'hidden'
        }}>
          <div style={{
            height: '100%',
            width: \`${tasks.length > 0 ? (completedCount / tasks.length) * 100 : 0}%\`,
            background: '#4caf50',
            transition: 'width 0.3s'
          }} />
        </div>
      </div>

      <div style={{ display: 'flex', flexDirection: 'column', gap: '10px' }}>
        {tasks.map(task => (
          <div
            key={task.id}
            style={{
              display: 'flex',
              alignItems: 'center',
              padding: '12px',
              background: task.completed ? '#e8f5e9' : '#fff',
              border: '2px solid ' + (
                task.priority === 'high' ? '#f44336' :
                task.priority === 'medium' ? '#ff9800' : '#9e9e9e'
              ),
              borderRadius: '6px',
              transition: 'all 0.2s'
            }}
          >
            <input
              type="checkbox"
              checked={task.completed}
              onChange={() => toggleTask(task.id)}
              style={{
                width: '20px',
                height: '20px',
                cursor: 'pointer'
              }}
            />
            <span style={{
              flex: 1,
              marginLeft: '12px',
              textDecoration: task.completed ? 'line-through' : 'none',
              color: task.completed ? '#666' : '#333',
              fontSize: '16px'
            }}>
              {task.text}
            </span>
            <span style={{
              padding: '4px 8px',
              borderRadius: '4px',
              fontSize: '12px',
              fontWeight: 'bold',
              marginRight: '10px',
              backgroundColor: task.priority === 'high' ? '#f44336' :
                              task.priority === 'medium' ? '#ff9800' : '#9e9e9e',
              color: 'white'
            }}>
              {task.priority === 'high' && 'ğŸ”¥ é«˜'}
              {task.priority === 'medium' && 'âš¡ ä¸­'}
              {task.priority === 'low' && 'ğŸ’¤ ä½'}
            </span>
            <button
              onClick={() => deleteTask(task.id)}
              style={{
                padding: '5px 10px',
                background: '#f44336',
                color: 'white',
                border: 'none',
                borderRadius: '4px',
                cursor: 'pointer',
                fontSize: '14px'
              }}
            >
              ğŸ—‘ï¸
            </button>
          </div>
        ))}
      </div>

      {tasks.length === 0 && (
        <div style={{
          padding: '30px',
          textAlign: 'center',
          color: '#999',
          fontSize: '18px'
        }}>
          ğŸ“­ æš‚æ— ä»»åŠ¡ï¼Œæ·»åŠ ä¸€ä¸ªæ–°ä»»åŠ¡å¼€å§‹å§ï¼
        </div>
      )}
    </div>
  );
}
`}
  scope={{ React }}
/>

---

## 3. Keysçš„é‡è¦æ€§

### 3.1 ä»€ä¹ˆæ˜¯Keysï¼Ÿ

Keysæ˜¯Reactç”¨æ¥è¯†åˆ«å“ªäº›é¡¹ç›®å‘ç”Ÿäº†å˜åŒ–ã€æ·»åŠ äº†æˆ–åˆ é™¤äº†çš„ç‰¹æ®Šå±æ€§ã€‚ä½ éœ€è¦ä¸ºåˆ—è¡¨ä¸­çš„æ¯ä¸ªå…ƒç´ æä¾›Keyï¼Œä»¥ä¾¿Reactå¯ä»¥è·Ÿè¸ªå…ƒç´ ã€‚

<Box style={{ padding: '20px', background: '#fff3e0', borderRadius: '8px', margin: '20px 0' }}>
  <h4 style={{ margin: 0, color: '#e65100' }}>âš ï¸ é‡è¦æç¤º</h4>
  <p style={{ margin: '10px 0 0 0' }}>
    <strong>Keysæ˜¯å¿…é¡»çš„</strong> - æ¸²æŸ“åˆ—è¡¨æ—¶<strong>å¿…é¡»</strong>æä¾›Keyå±æ€§ã€‚ç¼ºå°‘Keyä¼šå¯¼è‡´æ§åˆ¶å°è­¦å‘Šå’Œæ€§èƒ½é—®é¢˜ã€‚
  </p>
</Box>

### 3.2 ä¸ºä»€ä¹ˆéœ€è¦Keysï¼Ÿ

Reactä½¿ç”¨Keysæ¥é«˜æ•ˆåœ°æ›´æ–°DOMã€‚å½“åˆ—è¡¨é¡ºåºæ”¹å˜æ—¶ï¼ŒKeyså¸®åŠ©Reactç¡®å®šå“ªäº›é¡¹ç›®å·²ç»ç§»åŠ¨ï¼Œè€Œä¸æ˜¯å®Œå…¨é‡æ–°åˆ›å»ºã€‚

<Compare>

```jsx
// âŒ é”™è¯¯ - æ²¡æœ‰Key
{items.map((item, index) => <div>{item}</div>)}

// âœ… æ­£ç¡® - æœ‰Key
{items.map((item, index) => <div key={index}>{item}</div>)}

// âœ… æ›´å¥½ - ä½¿ç”¨å”¯ä¸€ID
{items.map(item => <div key={item.id}>{item}</div>)}
```

</Compare>

### 3.3 å¦‚ä½•é€‰æ‹©Keyå€¼

#### æœ€ä½³å®è·µï¼šä½¿ç”¨å”¯ä¸€ID

<CodeBlock>

```jsx
// âœ… æœ€ä½³ - ä½¿ç”¨æ•°æ®åº“IDæˆ–å”¯ä¸€æ ‡è¯†ç¬¦
const users = [
  { id: 'user-123', name: 'Alice' },
  { id: 'user-456', name: 'Bob' }
];

return (
  <ul>
    {users.map(user => (
      <li key={user.id}>{user.name}</li>
    ))}
  </ul>
);
```

</CodeBlock>

#### æ¬¡é€‰ï¼šä½¿ç”¨ç´¢å¼•ï¼ˆä»…é™ç‰¹å®šæƒ…å†µï¼‰

<CodeBlock>

```jsx
// âœ… å¯æ¥å— - åˆ—è¡¨æ˜¯é™æ€çš„ï¼Œä¸ä¼šé‡æ–°æ’åº
const colors = ['red', 'blue', 'green'];

return (
  <ul>
    {colors.map((color, index) => (
      <li key={index}>{color}</li>
    ))}
  </ul>
);
```

</CodeBlock>

<ErrorBox>

```jsx
// âŒ é¿å… - åˆ—è¡¨ä¼šåŠ¨æ€æ”¹å˜ï¼Œå¯èƒ½å¯¼è‡´æ¸²æŸ“é—®é¢˜
const [items, setItems] = useState(initialItems);

return (
  <ul>
    {items.map((item, index) => (
      <li key={index}>{item}</li>  // ç´¢å¼•å¯èƒ½æ”¹å˜
    ))}
  </ul>
);
```

</ErrorBox>

---

## 4. åŠ¨æ€åˆ—è¡¨æ“ä½œ

### 4.1 æ·»åŠ åˆ—è¡¨é¡¹

<CodeBlock>

```jsx
function TodoList() {
  const [todos, setTodos] = useState([
    { id: 1, text: 'å­¦ä¹ React', completed: false }
  ]);
  const [inputValue, setInputValue] = useState('');

  const addTodo = () => {
    if (inputValue.trim()) {
      setTodos([
        ...todos,
        {
          id: Date.now(), // ç®€å•IDç”Ÿæˆ
          text: inputValue,
          completed: false
        }
      ]);
      setInputValue('');
    }
  };

  return (
    <div>
      <div>
        <input
          value={inputValue}
          onChange={(e) => setInputValue(e.target.value)}
          placeholder="æ·»åŠ æ–°ä»»åŠ¡..."
        />
        <button onClick={addTodo}>æ·»åŠ </button>
      </div>
      <ul>
        {todos.map(todo => (
          <li key={todo.id}>
            {todo.text}
          </li>
        ))}
      </ul>
    </div>
  );
}
```

</CodeBlock>

### 4.2 åˆ é™¤åˆ—è¡¨é¡¹

<CodeBlock>

```jsx
function ItemList() {
  const [items, setItems] = useState([
    { id: 1, name: 'è‹¹æœ' },
    { id: 2, name: 'é¦™è•‰' },
    { id: 3, name: 'æ©™å­' }
  ]);

  const deleteItem = (id) => {
    setItems(items.filter(item => item.id !== id));
  };

  return (
    <ul>
      {items.map(item => (
        <li key={item.id}>
          {item.name}
          <button
            onClick={() => deleteItem(item.id)}
            style={{ marginLeft: '10px' }}
          >
            åˆ é™¤
          </button>
        </li>
      ))}
    </ul>
  );
}
```

</CodeBlock>

### 4.3 æ›´æ–°åˆ—è¡¨é¡¹

<CodeBlock>

```jsx
function EditableList() {
  const [items, setItems] = useState([
    { id: 1, text: 'ä»»åŠ¡1', completed: false },
    { id: 2, text: 'ä»»åŠ¡2', completed: true }
  ]);

  const toggleComplete = (id) => {
    setItems(items.map(item =>
      item.id === id
        ? { ...item, completed: !item.completed }
        : item
    ));
  };

  return (
    <ul>
      {items.map(item => (
        <li
          key={item.id}
          style={{
            textDecoration: item.completed ? 'line-through' : 'none',
            cursor: 'pointer'
          }}
          onClick={() => toggleComplete(item.id)}
        >
          {item.text}
        </li>
      ))}
    </ul>
  );
}
```

</CodeBlock>

---

## 5. åˆ—è¡¨è¿‡æ»¤ä¸æ’åº

### 5.1 è¿‡æ»¤åˆ—è¡¨

<CodeBlock>

```jsx
function ProductFilter() {
  const [products] = useState([
    { id: 1, name: 'Laptop', category: 'Electronics', price: 999 },
    { id: 2, name: 'Shirt', category: 'Clothing', price: 29 },
    { id: 3, name: 'Phone', category: 'Electronics', price: 699 },
    { id: 4, name: 'Pants', category: 'Clothing', price: 59 }
  ]);
  const [filter, setFilter] = useState('All');

  const filteredProducts = filter === 'All'
    ? products
    : products.filter(p => p.category === filter);

  return (
    <div>
      <div>
        <button onClick={() => setFilter('All')}>å…¨éƒ¨</button>
        <button onClick={() => setFilter('Electronics')}>ç”µå­äº§å“</button>
        <button onClick={() => setFilter('Clothing')}>æœè£…</button>
      </div>
      <ul>
        {filteredProducts.map(product => (
          <li key={product.id}>
            {product.name} - Â¥{product.price}
          </li>
        ))}
      </ul>
    </div>
  );
}
```

</CodeBlock>

### 5.2 æ’åºåˆ—è¡¨

<CodeBlock>

```jsx
function SortedList() {
  const [sortBy, setSortBy] = useState('name'); // 'name' or 'age'
  const [people] = useState([
    { id: 1, name: 'Alice', age: 25 },
    { id: 2, name: 'Bob', age: 30 },
    { id: 3, name: 'Charlie', age: 20 }
  ]);

  const sortedPeople = [...people].sort((a, b) => {
    if (sortBy === 'name') {
      return a.name.localeCompare(b.name);
    } else {
      return a.age - b.age;
    }
  });

  return (
    <div>
      <div>
        <button onClick={() => setSortBy('name')}>æŒ‰åå­—æ’åº</button>
        <button onClick={() => setSortBy('age')}>æŒ‰å¹´é¾„æ’åº</button>
      </div>
      <ul>
        {sortedPeople.map(person => (
          <li key={person.id}>
            {person.name} - {person.age}å²
          </li>
        ))}
      </ul>
    </div>
  );
}
```

</CodeBlock>

### 5.3 å¤æ‚è¿‡æ»¤ä¸æ’åº

<CodeBlock>

```jsx
function AdvancedFilter() {
  const [searchTerm, setSearchTerm] = useState('');
  const [minPrice, setMinPrice] = useState(0);
  const [sortBy, setSortBy] = useState('name');

  const products = [
    { id: 1, name: 'Laptop', price: 999, category: 'Electronics' },
    { id: 2, name: 'Shirt', price: 29, category: 'Clothing' },
    { id: 3, name: 'Phone', price: 699, category: 'Electronics' }
  ];

  // è¿‡æ»¤
  const filteredProducts = products.filter(p => {
    const matchesSearch = p.name.toLowerCase().includes(searchTerm.toLowerCase());
    const matchesPrice = p.price >= minPrice;
    return matchesSearch && matchesPrice;
  });

  // æ’åº
  const sortedProducts = [...filteredProducts].sort((a, b) => {
    if (sortBy === 'price') {
      return a.price - b.price;
    }
    return a.name.localeCompare(b.name);
  });

  return (
    <div>
      <input
        type="text"
        value={searchTerm}
        onChange={(e) => setSearchTerm(e.target.value)}
        placeholder="æœç´¢äº§å“..."
      />
      <input
        type="number"
        value={minPrice}
        onChange={(e) => setMinPrice(Number(e.target.value))}
        placeholder="æœ€ä½ä»·æ ¼"
      />
      <ul>
        {sortedProducts.map(product => (
          <li key={product.id}>
            {product.name} - Â¥{product.price}
          </li>
        ))}
      </ul>
    </div>
  );
}
```

</CodeBlock>

---

## 6. æ¡ä»¶åˆ—è¡¨æ¸²æŸ“

### 6.1 ç©ºåˆ—è¡¨å¤„ç†

<CodeBlock>

```jsx
function UserList({ users }) {
  return (
    <div>
      <h2>ç”¨æˆ·åˆ—è¡¨</h2>
      {users.length === 0 ? (
        <p>æš‚æ— ç”¨æˆ·</p>
      ) : (
        <ul>
          {users.map(user => (
            <li key={user.id}>{user.name}</li>
          ))}
        </ul>
      )}
    </div>
  );
}
```

</CodeBlock>

### 6.2 åŠ è½½çŠ¶æ€

<CodeBlock>

```jsx
function DataList({ data, loading, error }) {
  if (loading) {
    return <div>åŠ è½½ä¸­...</div>;
  }

  if (error) {
    return <div>é”™è¯¯: {error}</div>;
  }

  return (
    <ul>
      {data.map(item => (
        <li key={item.id}>{item.name}</li>
      ))}
    </ul>
  );
}
```

</CodeBlock>

### 6.3 æ¡ä»¶æ˜¾ç¤ºåˆ—è¡¨é¡¹

<CodeBlock>

```jsx
function FilteredUserList({ users, showActiveOnly }) {
  return (
    <ul>
      {users
        .filter(user => !showActiveOnly || user.isActive)
        .map(user => (
          <li key={user.id}>
            {user.name}
            {user.isActive && <span style={{ color: 'green' }}>âœ“</span>}
          </li>
        ))}
    </ul>
  );
}
```

</CodeBlock>

---

## 7. åµŒå¥—åˆ—è¡¨

### 7.1 äºŒç»´åˆ—è¡¨

<CodeBlock>

```jsx
function CategoryList({ categories }) {
  return (
    <div>
      {categories.map(category => (
        <div key={category.id} style={{ marginBottom: '20px' }}>
          <h3>{category.name}</h3>
          <ul>
            {category.items.map(item => (
              <li key={item.id}>
                {item.name}
              </li>
            ))}
          </ul>
        </div>
      ))}
    </div>
  );
}
```

</CodeBlock>

### 7.2 åµŒå¥—åŠ¨æ€æ›´æ–°

<CodeBlock>

```jsx
function ExpandableList({ data }) {
  const [expandedItems, setExpandedItems] = useState([]);

  const toggleExpand = (id) => {
    setExpandedItems(prev =>
      prev.includes(id)
        ? prev.filter(item => item !== id)
        : [...prev, id]
    );
  };

  return (
    <ul>
      {data.map(item => (
        <li key={item.id}>
          <div onClick={() => toggleExpand(item.id)}>
            {item.name} {expandedItems.includes(item.id) ? 'â–¼' : 'â–¶'}
          </div>
          {expandedItems.includes(item.id) && (
            <ul style={{ marginLeft: '20px' }}>
              {item.children.map(child => (
                <li key={child.id}>{child.name}</li>
              ))}
            </ul>
          )}
        </li>
      ))}
    </ul>
  );
}
```

</CodeBlock>

---

## 8. æ€§èƒ½ä¼˜åŒ–

### 8.1 ä½¿ç”¨React.memo

å¯¹äºå¤§å‹åˆ—è¡¨ï¼Œä½¿ç”¨`React.memo`æ¥é¿å…ä¸å¿…è¦çš„é‡æ¸²æŸ“ã€‚

<CodeBlock>

```jsx
// åŒ…è£…åˆ—è¡¨é¡¹ç»„ä»¶
const ListItem = React.memo(({ item }) => {
  return <div>{item.name}</div>;
});

function ItemList({ items }) {
  return (
    <ul>
      {items.map(item => (
        <ListItem key={item.id} item={item} />
      ))}
    </ul>
  );
}
```

</CodeBlock>

### 8.2 ä½¿ç”¨useMemoä¼˜åŒ–è¿‡æ»¤

<CodeBlock>

```jsx
function OptimizedList({ items, filter }) {
  const filteredItems = useMemo(() => {
    return items.filter(item => item.category === filter);
  }, [items, filter]);

  return (
    <ul>
      {filteredItems.map(item => (
        <li key={item.id}>{item.name}</li>
      ))}
    </ul>
  );
}
```

</CodeBlock>

### 8.3 è™šæ‹ŸåŒ–ï¼ˆé’ˆå¯¹è¶…é•¿åˆ—è¡¨ï¼‰

å¯¹äºåŒ…å«æˆåƒä¸Šä¸‡é¡¹çš„åˆ—è¡¨ï¼Œè€ƒè™‘ä½¿ç”¨è™šæ‹ŸåŒ–æŠ€æœ¯ã€‚

<CodeBlock>

```jsx
// ç®€åŒ–çš„è™šæ‹ŸåŒ–ç¤ºä¾‹
function VirtualizedList({ items, itemHeight = 50, visibleCount = 10 }) {
  const [scrollTop, setScrollTop] = useState(0);

  const startIndex = Math.floor(scrollTop / itemHeight);
  const endIndex = Math.min(startIndex + visibleCount, items.length);
  const visibleItems = items.slice(startIndex, endIndex);

  return (
    <div
      style={{ height: items.length * itemHeight, position: 'relative' }}
      onScroll={(e) => setScrollTop(e.target.scrollTop)}
    >
      <div style={{ transform: `translateY(${startIndex * itemHeight}px)` }}>
        {visibleItems.map(item => (
          <div key={item.id} style={{ height: itemHeight }}>
            {item.name}
          </div>
        ))}
      </div>
    </div>
  );
}
```

</CodeBlock>

<Box style={{ padding: '15px', background: '#e8f5e9', borderRadius: '8px', margin: '20px 0' }}>
  <h4 style={{ margin: 0, color: '#2e7d32' }}>ğŸ’¡ æ€§èƒ½æç¤º</h4>
  <p style={{ margin: '10px 0 0 0' }}>
    å¯¹äºå¤§å‹åˆ—è¡¨ï¼ˆ>100é¡¹ï¼‰ï¼Œè€ƒè™‘ä½¿ç”¨ä¸“é—¨çš„è™šæ‹ŸåŒ–åº“å¦‚<strong>react-window</strong>æˆ–<strong>react-virtualized</strong>ã€‚
  </p>
</Box>

---

## 9. Keysçš„æœ€ä½³å®è·µ

### 9.1 Keyå€¼è§„åˆ™

<Rules>

1. **Keyå€¼å¿…é¡»å”¯ä¸€**
   ```jsx
   // âœ… æ­£ç¡® - æ¯ä¸ªkeyå”¯ä¸€
   items.map(item => <div key={item.id}>...</div>)
   ```

2. **Keyå€¼åº”è¯¥æ˜¯ç¨³å®šçš„**
   ```jsx
   // âœ… ç¨³å®š - IDä¸ä¼šæ”¹å˜
   items.map(item => <div key={item.id}>...</div>)

   // âŒ ä¸ç¨³å®š - ç´¢å¼•å¯èƒ½æ”¹å˜
   items.map((item, index) => <div key={index}>...</div>)
   ```

3. **Keyå€¼åº”è¯¥æ˜¯å¯é¢„æµ‹çš„**
   ```jsx
   // âœ… å¯é¢„æµ‹ - åŸºäºæ•°æ®çš„å†…åœ¨æ ‡è¯†
   items.map(item => <div key={`item-${item.id}`}>...</div>)
   ```

</Rules>

### 9.2 å¸¸è§é”™è¯¯

<ErrorBox>

```jsx
// âŒ é”™è¯¯1 - é‡å¤Key
items.map(item => <div key={item.id}>{item.name}</div>)
items.map(item => <div key={item.id}>{item.name}</div>) // é‡å¤ï¼

// âŒ é”™è¯¯2 - ä½¿ç”¨éšæœºå€¼ä½œä¸ºKey
items.map(item => <div key={Math.random()}>{item.name}</div>)

// âŒ é”™è¯¯3 - ä½¿ç”¨Indexä½œä¸ºåŠ¨æ€åˆ—è¡¨çš„Key
const [items, setItems] = useState(initialItems);
return items.map((item, index) => <div key={index}>{item}</div>)
```

</ErrorBox>

### 9.3 ç‰¹æ®Šåœºæ™¯çš„Keyé€‰æ‹©

<Compare>

```jsx
// åœºæ™¯1: é™æ€åˆ—è¡¨ï¼ˆæ¨èä½¿ç”¨Indexï¼‰
const colors = ['red', 'blue', 'green'];
colors.map((color, index) => <li key={index}>{color}</li>)

// åœºæ™¯2: æœ‰å”¯ä¸€IDçš„åŠ¨æ€åˆ—è¡¨ï¼ˆå¿…é¡»ä½¿ç”¨IDï¼‰
const users = [{ id: 1, name: 'Alice' }, { id: 2, name: 'Bob' }];
users.map(user => <li key={user.id}>{user.name}</li>)

// åœºæ™¯3: æ²¡æœ‰å”¯ä¸€IDä½†éœ€è¦ç¨³å®šKey
const [items, setItems] = useState(initialItems);
const getStableId = (item) => {
  // åŸºäºå†…å®¹ç”Ÿæˆç¨³å®šID
  return `${item.type}-${item.name}`;
};
items.map(item => <li key={getStableId(item)}>{item.name}</li>)
```

</Compare>

---

## 10. å®è·µç»ƒä¹ 

### ç»ƒä¹ 1ï¼šå¾…åŠäº‹é¡¹ç®¡ç†å™¨

åˆ›å»ºä¸€ä¸ªåŠŸèƒ½å®Œæ•´çš„å¾…åŠäº‹é¡¹åˆ—è¡¨ï¼Œæ”¯æŒæ·»åŠ ã€åˆ é™¤ã€å®Œæˆå’Œè¿‡æ»¤ã€‚

<Expandable title="ç‚¹å‡»æŸ¥çœ‹è¦æ±‚">

**åŠŸèƒ½è¦æ±‚**ï¼š
- æ˜¾ç¤ºå¾…åŠäº‹é¡¹åˆ—è¡¨
- æ·»åŠ æ–°äº‹é¡¹
- åˆ é™¤äº‹é¡¹
- æ ‡è®°å®Œæˆ/æœªå®Œæˆ
- è¿‡æ»¤æ˜¾ç¤ºï¼ˆå…¨éƒ¨/å·²å®Œæˆ/æœªå®Œæˆï¼‰
- ç»Ÿè®¡ä¿¡æ¯

**æ•°æ®ç»“æ„**ï¼š
```javascript
{
  id: number,
  text: string,
  completed: boolean,
  createdAt: Date
}
```

</Expandable>

### ç»ƒä¹ 2ï¼šç”¨æˆ·æœç´¢ç³»ç»Ÿ

åˆ›å»ºä¸€ä¸ªç”¨æˆ·åˆ—è¡¨ï¼Œæ”¯æŒæœç´¢ã€æ’åºå’Œåˆ†é¡µã€‚

<Expandable title="ç‚¹å‡»æŸ¥çœ‹è¦æ±‚">

**åŠŸèƒ½è¦æ±‚**ï¼š
- æ˜¾ç¤ºç”¨æˆ·åˆ—è¡¨
- å®æ—¶æœç´¢ï¼ˆæŒ‰å§“åï¼‰
- æŒ‰å¹´é¾„æ’åº
- åˆ†é¡µæ˜¾ç¤ºï¼ˆæ¯é¡µ5æ¡ï¼‰
- æ˜¾ç¤ºæ€»æ•°å’Œå½“å‰é¡µ

**æ•°æ®ç»“æ„**ï¼š
```javascript
{
  id: number,
  name: string,
  email: string,
  age: number,
  avatar: string
}
```

</Expandable>

### ç»ƒä¹ 3ï¼šäº§å“ç›®å½•

åˆ›å»ºä¸€ä¸ªäº§å“ç›®å½•ï¼Œæ”¯æŒåˆ†ç±»è¿‡æ»¤ã€ä»·æ ¼èŒƒå›´å’Œæ’åºã€‚

<Expandable title="ç‚¹å‡»æŸ¥çœ‹è¦æ±‚">

**åŠŸèƒ½è¦æ±‚**ï¼š
- äº§å“åˆ—è¡¨å±•ç¤º
- åˆ†ç±»è¿‡æ»¤ï¼ˆå…¨éƒ¨/ç”µå­äº§å“/æœè£…/å®¶å±…ï¼‰
- ä»·æ ¼èŒƒå›´è¿‡æ»¤
- æŒ‰ä»·æ ¼æ’åºï¼ˆå‡åº/é™åºï¼‰
- æŒ‰åç§°æ’åº
- å“åº”å¼å¡ç‰‡å¸ƒå±€

**æ•°æ®ç»“æ„**ï¼š
```javascript
{
  id: number,
  name: string,
  price: number,
  category: string,
  image: string,
  inStock: boolean
}
```

</Expandable>

### ç»ƒä¹ 4ï¼šè¯„è®ºçº¿ç¨‹

åˆ›å»ºä¸€ä¸ªåµŒå¥—çš„è¯„è®ºç³»ç»Ÿï¼Œæ”¯æŒå›å¤å’ŒæŠ˜å ã€‚

<Expandable title="ç‚¹å‡»æŸ¥çœ‹è¦æ±‚">

**åŠŸèƒ½è¦æ±‚**ï¼š
- åµŒå¥—è¯„è®ºæ˜¾ç¤º
- å›å¤è¯„è®º
- æŠ˜å /å±•å¼€è¯„è®ºçº¿ç¨‹
- ç‚¹èµåŠŸèƒ½
- æ—¶é—´æ˜¾ç¤º

**æ•°æ®ç»“æ„**ï¼š
```javascript
{
  id: number,
  author: string,
  content: string,
  timestamp: Date,
  replies: Comment[],
  likes: number
}
```

</Expandable>

---

## 11. å¸¸è§é”™è¯¯

### é”™è¯¯1ï¼šå¿˜è®°æ·»åŠ Key

<ErrorBox>

```jsx
// âŒ é”™è¯¯
{items.map(item => <div>{item.name}</div>)}

// âœ… æ­£ç¡®
{items.map(item => <div key={item.id}>{item.name}</div>)}
```

</ErrorBox>

### é”™è¯¯2ï¼šä½¿ç”¨Indexä½œä¸ºåŠ¨æ€åˆ—è¡¨çš„Key

<ErrorBox>

```jsx
// âŒ é”™è¯¯ - å½“åˆ—è¡¨é¡¹å¯ä»¥é‡æ–°æ’åºæ—¶
function List({ items, onReorder }) {
  return (
    <ul>
      {items.map((item, index) => (
        <li key={index}>{item.name}</li>  // Indexä¼šæ”¹å˜ï¼
      ))}
    </ul>
  );
}

// âœ… æ­£ç¡® - ä½¿ç”¨å”¯ä¸€ID
function List({ items, onReorder }) {
  return (
    <ul>
      {items.map(item => (
        <li key={item.id}>{item.name}</li>
      ))}
    </ul>
  );
}
```

</ErrorBox>

### é”™è¯¯3ï¼šKeyå€¼ä¸å”¯ä¸€

<ErrorBox>

```jsx
// âŒ é”™è¯¯
const categories = [
  { id: 1, name: 'A' },
  { id: 1, name: 'B' }  // é‡å¤IDï¼
];

return (
  <ul>
    {categories.map(cat => (
      <li key={cat.id}>{cat.name}</li>  // Keyä¸å”¯ä¸€ï¼
    ))}
  </ul>
);

// âœ… æ­£ç¡®
const categories = [
  { id: 1, name: 'A' },
  { id: 2, name: 'B' }  // å”¯ä¸€ID
];
```

</ErrorBox>

### é”™è¯¯4ï¼šä¿®æ”¹åŸæ•°ç»„

<ErrorBox>

```jsx
// âŒ é”™è¯¯ - ç›´æ¥ä¿®æ”¹state
function List({ items }) {
  const [list, setList] = useState(items);

  const sort = () => {
    list.sort();  // ä¿®æ”¹åŸæ•°ç»„ï¼
    setList(list);
  };

  return <button onClick={sort}>æ’åº</button>;
}

// âœ… æ­£ç¡® - åˆ›å»ºå‰¯æœ¬
function List({ items }) {
  const [list, setList] = useState(items);

  const sort = () => {
    const sorted = [...list].sort();  // åˆ›å»ºå‰¯æœ¬
    setList(sorted);
  };

  return <button onClick={sort}>æ’åº</button>;
}
```

</ErrorBox>

### é”™è¯¯5ï¼šé”™è¯¯çš„Keyæ›´æ–°é€»è¾‘

<ErrorBox>

```jsx
// âŒ é”™è¯¯ - æ·»åŠ é¡¹æ—¶Keyå¯èƒ½å†²çª
const addItem = (newItem) => {
  setItems([...items, newItem]);  // newItemå¯èƒ½æ²¡æœ‰ID
};

// âœ… æ­£ç¡® - ç¡®ä¿æ–°é¡¹æœ‰å”¯ä¸€ID
const addItem = (newItem) => {
  const itemWithId = {
    ...newItem,
    id: Date.now()  // ç”Ÿæˆå”¯ä¸€ID
  };
  setItems([...items, itemWithId]);
};
```

</ErrorBox>

---

## 12. æœ¬ç« å°ç»“

### å…³é”®è¦ç‚¹

<Checklist>

- âœ… ä½¿ç”¨`Array.map()`æ¸²æŸ“åˆ—è¡¨
- âœ… åˆ—è¡¨ä¸­çš„æ¯ä¸ªå…ƒç´ **å¿…é¡»**æä¾›Keyå±æ€§
- âœ… ä¼˜å…ˆä½¿ç”¨æ•°æ®çš„å”¯ä¸€IDä½œä¸ºKey
- âœ… ä»…åœ¨åˆ—è¡¨é™æ€ä¸”ä¸ä¼šé‡æ–°æ’åºæ—¶ä½¿ç”¨ç´¢å¼•ä½œä¸ºKey
- âœ… ä½¿ç”¨`filter()`å’Œ`sort()`è¿›è¡Œåˆ—è¡¨è¿‡æ»¤å’Œæ’åº
- âœ… ä½¿ç”¨å±•å¼€è¿ç®—ç¬¦`...`æ“ä½œåˆ—è¡¨ï¼Œé¿å…ä¿®æ”¹åŸæ•°ç»„
- âœ… å¤„ç†ç©ºåˆ—è¡¨ã€åŠ è½½çŠ¶æ€å’Œé”™è¯¯çŠ¶æ€
- âœ… å¯¹äºå¤§å‹åˆ—è¡¨ï¼Œè€ƒè™‘ä½¿ç”¨`React.memo`æˆ–è™šæ‹ŸåŒ–

</Checklist>

### æœ€ä½³å®è·µ

<BestPractices>

1. **ä¿æŒKeyçš„ç¨³å®šæ€§** - Keyå€¼åº”è¯¥åœ¨ç»„ä»¶çš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸä¸­ä¿æŒä¸€è‡´
2. **é¿å…ä½¿ç”¨éšæœºå€¼** - ä¸è¦ä½¿ç”¨`Math.random()`æˆ–æ—¶é—´æˆ³ä½œä¸ºKey
3. **ä¼˜åŒ–å¤§å‹åˆ—è¡¨** - å¯¹äºè¶…è¿‡100é¡¹çš„åˆ—è¡¨ï¼Œä½¿ç”¨è™šæ‹ŸåŒ–æˆ–åˆ†é¡µ
4. **åˆç†çš„ç»„ä»¶æ‹†åˆ†** - å°†å¤æ‚çš„åˆ—è¡¨é¡¹æ‹†åˆ†ä¸ºå•ç‹¬çš„ç»„ä»¶
5. **ä½¿ç”¨æ¡ä»¶æ¸²æŸ“** - æ€»æ˜¯å¤„ç†ç©ºåˆ—è¡¨å’ŒåŠ è½½çŠ¶æ€

</BestPractices>

### ä¸‹ä¸€æ­¥å­¦ä¹ 

ç°åœ¨ä½ å·²ç»æŒæ¡äº†åˆ—è¡¨æ¸²æŸ“ä¸Keysï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°†å­¦ä¹ ï¼š

1. **[è¡¨å•å¤„ç†](forms)** - æŒæ¡ç”¨æˆ·è¾“å…¥å’Œè¡¨å•äº¤äº’
2. **[çŠ¶æ€ç®¡ç†è¿›é˜¶](../hooks/basics/useState)** - æ·±å…¥ç†è§£çŠ¶æ€
3. **[è‡ªå®šä¹‰Hooks](../hooks/custom)** - åˆ›å»ºå¯å¤ç”¨çš„çŠ¶æ€é€»è¾‘

---

## 13. å»¶ä¼¸é˜…è¯»

### å®˜æ–¹èµ„æº

- [åˆ—è¡¨ä¸Keys](https://react.dev/learn/rendering-lists) - Reactå®˜æ–¹åˆ—è¡¨æ¸²æŸ“æŒ‡å—
- [Keysçš„è¯´æ˜](https://react.dev/reference/react/Key) - Keys APIæ–‡æ¡£
- [æ€§èƒ½ä¼˜åŒ–](https://react.dev/learn/render-and-commit) - æ¸²æŸ“å’Œæ€§èƒ½ä¼˜åŒ–

### æ¨èåº“

- [react-window](https://react-window.now.sh/) - é«˜æ•ˆæ¸²æŸ“å¤§å‹åˆ—è¡¨
- [react-virtualized](https://bvaughn.github.io/react-virtualized/) - åŠŸèƒ½å®Œæ•´çš„è™šæ‹ŸåŒ–åº“

### å·¥å…·æ¨è

- [React Developer Tools](https://react.dev/learn/react-developer-tools) - è°ƒè¯•Reactç»„ä»¶

---

[â† ä¸Šä¸€ç« ï¼šæ¡ä»¶æ¸²æŸ“](conditional-rendering) | [ä¸‹ä¸€ç« ï¼šè¡¨å•å¤„ç† â†’](forms)
