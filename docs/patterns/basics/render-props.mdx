# æ¸²æŸ“å±æ€§æ¨¡å¼ (Render Props) - çµæ´»é€»è¾‘å¤ç”¨

import { Tabs, TabItem } from '@docusaurus/theme-common';

æ¸²æŸ“å±æ€§ï¼ˆRender Propsï¼‰æ˜¯Reactä¸­ä¸€ç§å¼ºå¤§çš„æ¨¡å¼ï¼Œå®ƒé€šè¿‡å°†å‡½æ•°ä½œä¸ºpropä¼ é€’ç»™ç»„ä»¶æ¥å®ç°é€»è¾‘å¤ç”¨ã€‚è™½ç„¶Hookså·²ç»æˆä¸ºäº†é€»è¾‘å¤ç”¨çš„é¦–é€‰æ–¹å¼ï¼Œä½†ç†è§£Render Propså¯¹äºæ·±å…¥ç†è§£Reactç»„ä»¶æ¨¡å¼ä»ç„¶éå¸¸é‡è¦ã€‚åœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬å°†æ·±å…¥æ¢è®¨Render Propsçš„æ¦‚å¿µã€å®ç°æ–¹å¼ã€ä¼˜åŠ¿å’Œä½¿ç”¨åœºæ™¯ã€‚

## æœ¬ç« å­¦ä¹ ç›®æ ‡

- ç†è§£æ¸²æŸ“å±æ€§æ¨¡å¼çš„æ¦‚å¿µå’ŒåŸç†
- æŒæ¡Render Propsçš„è¯­æ³•å’Œå®ç°
- å­¦ä¼šä½¿ç”¨Render Propså®ç°é€»è¾‘å¤ç”¨
- å¯¹æ¯”Render Propsä¸HOCçš„ä¼˜ç¼ºç‚¹
- ç†è§£Render Propsä¸Hooksçš„å…³ç³»
- æŒæ¡Render Propsçš„å¸¸è§ä½¿ç”¨åœºæ™¯
- å­¦ä¼šé¿å…Render Propsçš„å¸¸è§é™·é˜±
- ç†è§£childrenä½œä¸ºå‡½æ•°çš„æ¨¡å¼

---

## 1. ä»€ä¹ˆæ˜¯æ¸²æŸ“å±æ€§ï¼Ÿ

æ¸²æŸ“å±æ€§ï¼ˆRender Propsï¼‰æ˜¯ä¸€ç§æ¨¡å¼ï¼Œå®ƒä½¿ç”¨ä¸€ä¸ªå€¼ä¸ºå‡½æ•°çš„propæ¥è®©ç»„ä»¶å†³å®šæ¸²æŸ“ä»€ä¹ˆã€‚å½“ç»„ä»¶éœ€è¦å¤ç”¨é€»è¾‘ä½†éœ€è¦ä¸åŒçš„UIæ—¶ï¼ŒRender Propså…è®¸æˆ‘ä»¬ä»¥å‡½æ•°çš„å½¢å¼ä¼ é€’æ¸²æŸ“é€»è¾‘ã€‚

<Box style={{ padding: '20px', background: '#e3f2fd', borderRadius: '8px', margin: '20px 0' }}>
  <h4 style={{ margin: 0, color: '#1976d2' }}>ğŸ’¡ æ ¸å¿ƒæ¦‚å¿µ</h4>
  <p style={{ margin: '10px 0 0 0' }}>
    <strong>Render Props</strong>æ˜¯ä¸€ä¸ªpropï¼Œå…¶å€¼æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå‘Šè¯‰ç»„ä»¶<strong>å¦‚ä½•æ¸²æŸ“</strong>ã€‚ç»„ä»¶å°†æ•°æ®ä½œä¸ºå‚æ•°ä¼ é€’ç»™è¿™ä¸ªå‡½æ•°ã€‚
  </p>
</Box>

<CodeBlock>

```jsx
// åŸºç¡€Render Propsæ¨¡å¼
<DataProvider
  render={(data) => <UserProfile data={data} />}
/>

// ç­‰åŒäº
<DataProvider>
  {(data) => <UserProfile data={data} />}
</DataProvider>
```

</CodeBlock>

### 1.1 æ ¸å¿ƒæ€æƒ³

<CodeBlock>

```jsx
// ç»„ä»¶æä¾›æ•°æ®å’Œé€»è¾‘
class DataProvider extends React.Component {
  state = { data: null, loading: true };

  render() {
    // å°†æ•°æ®ä¼ é€’ç»™renderå‡½æ•°
    return this.props.render(this.state);
  }
}

// ä½¿ç”¨ç»„ä»¶ - æ§åˆ¶å¦‚ä½•æ¸²æŸ“
<DataProvider
  render={({ data, loading }) => {
    if (loading) return <div>Loading...</div>;
    return <div>{data.title}</div>;
  }}
/>
```

</CodeBlock>

### 1.2 ä¸HOCå¯¹æ¯”

<Compare>

```jsx
// HOCæ–¹å¼
const EnhancedComponent = withData(WrappedComponent);

// Render Propsæ–¹å¼
<DataProvider
  render={(data) => <WrappedComponent data={data} />}
/>

// å·®å¼‚
1. HOC: åŒ…è£…ç»„ä»¶ï¼Œè¿”å›æ–°ç»„ä»¶
2. Render Props: ä¼ é€’æ¸²æŸ“å‡½æ•°ï¼Œç›´æ¥ä½¿ç”¨
3. HOC: ç»„ä»¶å±‚çº§å¢åŠ 
4. Render Props: æ— é¢å¤–å±‚çº§
```

</Compare>

---

## 2. Render PropsåŸºç¡€å®ç°

### 2.1 ç®€å•çš„Data Provider

<CodeBlock>

```jsx
// ç±»ç»„ä»¶å®ç°
class DataProvider extends React.Component {
  constructor(props) {
    super(props);
    this.state = {
      data: null,
      loading: false,
      error: null
    };
  }

  render() {
    const { render } = this.props;
    const { data, loading, error } = this.state;

    return render({ data, loading, error });
  }
}

// ä½¿ç”¨
<DataProvider
  render={({ data, loading, error }) => {
    if (loading) return <div>Loading...</div>;
    if (error) return <div>Error: {error.message}</div>;
    return <div>Data: {data}</div>;
  }}
/>
```

</CodeBlock>

### 2.2 å‡½æ•°ç»„ä»¶å®ç°

<CodeBlock>

```jsx
// å‡½æ•°ç»„ä»¶å®ç°
function DataProvider({ render, fetcher }) {
  const [data, setData] = useState(null);
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState(null);

  useEffect(() => {
    setLoading(true);
    fetcher()
      .then(setData)
      .catch(setError)
      .finally(() => setLoading(false));
  }, [fetcher]);

  return render({ data, loading, error });
}

// ä½¿ç”¨
<DataProvider
  fetcher={fetchUser}
  render={({ data, loading, error }) => {
    if (loading) return <div>Loading...</div>;
    if (error) return <div>Error: {error.message}</div>;
    return <div>Welcome, {data.name}</div>;
  }}
/>
```

</CodeBlock>

### 2.3 ä½¿ç”¨childrenä½œä¸ºå‡½æ•°

<CodeBlock>

```jsx
// ä½¿ç”¨children prop
function DataProvider({ fetcher, children }) {
  const [data, setData] = useState(null);
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState(null);

  useEffect(() => {
    setLoading(true);
    fetcher()
      .then(setData)
      .catch(setError)
      .finally(() => setLoading(false));
  }, [fetcher]);

  // childrenæ˜¯ä¸€ä¸ªå‡½æ•°
  return children({ data, loading, error });
}

// ä½¿ç”¨ï¼ˆæ›´è‡ªç„¶çš„è¯­æ³•ï¼‰
<DataProvider fetcher={fetchUser}>
  {({ data, loading, error }) => {
    if (loading) return <div>Loading...</div>;
    if (error) return <div>Error: {error.message}</div>;
    return <div>Welcome, {data.name}</div>;
  }}
</DataProvider>
```

</CodeBlock>

---

## 3. å¸¸è§Render Propsæ¨¡å¼

### 3.1 çŠ¶æ€ç®¡ç†Render Props

<CodeBlock>

```jsx
// çŠ¶æ€ç®¡ç†ç»„ä»¶
class Counter extends React.Component {
  constructor(props) {
    super(props);
    this.state = { count: props.initialCount || 0 };
  }

  increment = () => {
    this.setState(prev => ({ count: prev.count + 1 }));
  };

  decrement = () => {
    this.setState(prev => ({ count: prev.count - 1 }));
  };

  render() {
    return this.props.render({
      count: this.state.count,
      increment: this.increment,
      decrement: this.decrement
    });
  }
}

// ä½¿ç”¨
<Counter initialCount={0}>
  {({ count, increment, decrement }) => (
    <div className="counter">
      <button onClick={decrement}>-</button>
      <span>{count}</span>
      <button onClick={increment}>+</button>
    </div>
  )}
</Counter>
```

</CodeBlock>

### 3.2 åˆ—è¡¨æ¸²æŸ“Render Props

<CodeBlock>

```jsx
// è™šæ‹Ÿåˆ—è¡¨ç»„ä»¶
function VirtualList({ items, itemHeight, visibleCount, renderItem }) {
  const [scrollTop, setScrollTop] = useState(0);

  const startIndex = Math.floor(scrollTop / itemHeight);
  const endIndex = Math.min(startIndex + visibleCount, items.length);
  const visibleItems = items.slice(startIndex, endIndex);
  const totalHeight = items.length * itemHeight;

  return (
    <div
      style={{ height: totalHeight, position: 'relative' }}
      onScroll={(e) => setScrollTop(e.target.scrollTop)}
    >
      <div style={{ transform: `translateY(${startIndex * itemHeight}px)` }}>
        {visibleItems.map((item, index) =>
          renderItem(item, startIndex + index)
        )}
      </div>
    </div>
  );
}

// ä½¿ç”¨
<VirtualList
  items={users}
  itemHeight={50}
  visibleCount={10}
  renderItem={(user, index) => (
    <div key={index} style={{ height: 50 }}>
      {user.name}
    </div>
  )}
/>
```

</CodeBlock>

### 3.3 å¼‚æ­¥æ•°æ®Render Props

<CodeBlock>

```jsx
// å¼‚æ­¥æ•°æ®è·å–ç»„ä»¶
function AsyncData({ url, render, deps = [] }) {
  const [data, setData] = useState(null);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState(null);

  useEffect(() => {
    setLoading(true);
    setError(null);

    fetch(url)
      .then(res => res.json())
      .then(setData)
      .catch(setError)
      .finally(() => setLoading(false));
  }, [url, ...deps]);

  return render({ data, loading, error });
}

// ä½¿ç”¨
<AsyncData
  url="/api/users"
  deps={[userId]}
>
  {({ data, loading, error }) => {
    if (loading) return <div>Loading users...</div>;
    if (error) return <div>Error loading users</div>;
    return <UserList users={data} />;
  }}
</AsyncData>
```

</CodeBlock>

### 3.4 ä¸»é¢˜ç³»ç»ŸRender Props

<CodeBlock>

```jsx
// ä¸»é¢˜Provider
function ThemeProvider({ children, initialTheme = 'light' }) {
  const [theme, setTheme] = useState(() => {
    return localStorage.getItem('theme') || initialTheme;
  });

  const toggleTheme = () => {
    setTheme(prev => {
      const newTheme = prev === 'light' ? 'dark' : 'light';
      localStorage.setItem('theme', newTheme);
      return newTheme;
    });
  };

  return children({
    theme,
    toggleTheme,
    isDark: theme === 'dark'
  });
}

// ä½¿ç”¨
<ThemeProvider>
  {({ theme, toggleTheme, isDark }) => (
    <div className={`app ${isDark ? 'dark' : 'light'}`}>
      <button onClick={toggleTheme}>
        Switch to {isDark ? 'light' : 'dark'} mode
      </button>
      <div>Current theme: {theme}</div>
    </div>
  )}
</ThemeProvider>
```

</CodeBlock>

### 3.5 è¡¨å•Render Props

<CodeBlock>

```jsx
// è¡¨å•çŠ¶æ€ç®¡ç†
function Form({ initialValues, onSubmit, children }) {
  const [values, setValues] = useState(initialValues);
  const [touched, setTouched] = useState({});
  const [errors, setErrors] = useState({});

  const handleChange = (name, value) => {
    setValues(prev => ({ ...prev, [name]: value }));
  };

  const handleBlur = (name) => {
    setTouched(prev => ({ ...prev, [name]: true }));
  };

  const handleSubmit = (e) => {
    e.preventDefault();
    onSubmit(values);
  };

  return children({
    values,
    touched,
    errors,
    handleChange,
    handleBlur,
    handleSubmit
  });
}

// ä½¿ç”¨
<Form
  initialValues={{ name: '', email: '' }}
  onSubmit={(values) => console.log(values)}
>
  {({ values, touched, errors, handleChange, handleBlur, handleSubmit }) => (
    <form onSubmit={handleSubmit}>
      <input
        value={values.name}
        onChange={(e) => handleChange('name', e.target.value)}
        onBlur={() => handleBlur('name')}
        placeholder="Name"
      />
      {touched.name && errors.name && <span>{errors.name}</span>}
      <input
        value={values.email}
        onChange={(e) => handleChange('email', e.target.value)}
        onBlur={() => handleBlur('email')}
        placeholder="Email"
      />
      {touched.email && errors.email && <span>{errors.email}</span>}
      <button type="submit">Submit</button>
    </form>
  )}
</Form>
```

</CodeBlock>

---

## 4. é«˜çº§Render Propsæ¨¡å¼

### 4.1 ç»„åˆå¤šä¸ªRender Props

<CodeBlock>

```jsx
// ç»„åˆæ•°æ®
function DataComposer({ composers, children }) {
  const results = composers.map(composer => {
    const [data, setData] = useState(null);
    const [loading, setLoading] = useState(true);
    const [error, setError] = useState(null);

    useEffect(() => {
      composer.fetcher().then(setData).catch(setError).finally(() => setLoading(false));
    }, [composer.fetcher]);

    return { data, loading, error, ...composer };
  });

  return children({ results });
}

// ä½¿ç”¨
<DataComposer
  composers={[
    { name: 'users', fetcher: fetchUsers },
    { name: 'posts', fetcher: fetchPosts },
    { name: 'comments', fetcher: fetchComments }
  ]}
>
  {({ results }) => {
    const { users, posts, comments } = results;
    return <Dashboard users={users} posts={posts} comments={comments} />;
  }}
</DataComposer>
```

</CodeBlock>

### 4.2 æ¡ä»¶Render Props

<CodeBlock>

```jsx
// æ¡ä»¶æ¸²æŸ“ç»„ä»¶
function ConditionalRender({ condition, ifRender, elseRender }) {
  if (!condition) {
    return elseRender ? elseRender() : null;
  }

  return ifRender ? ifRender() : null;
}

// ä½¿ç”¨
<ConditionalRender
  condition={user.isAdmin}
  ifRender={() => <AdminPanel />}
  elseRender={() => <UserPanel />}
/>

// å¸¦propsçš„æ¡ä»¶æ¸²æŸ“
<ConditionalRender
  condition={hasPermission}
  ifRender={(props) => <Button {...props} />}
  elseRender={() => <button disabled>No Permission</button>}
/>
```

</CodeBlock>

### 4.3 åŠ¨æ€Render Props

<CodeBlock>

```jsx
// åŠ¨æ€æ¸²æŸ“ç»„ä»¶
function DynamicRenderer({ type, props }) {
  const renderers = {
    'user-card': ({ user }) => <UserCard user={user} />,
    'product-card': ({ product }) => <ProductCard product={product} />,
    'article-card': ({ article }) => <ArticleCard article={article} />
  };

  const renderComponent = renderers[type] || (() => <div>Unknown type</div>);
  return renderComponent(props);
}

// ä½¿ç”¨
<DynamicRenderer
  type="user-card"
  props={{ user: currentUser }}
/>
```

</CodeBlock>

### 4.4 æ¸²æŸ“ç­–ç•¥æ¨¡å¼

<CodeBlock>

```jsx
// æ¸²æŸ“ç­–ç•¥
class RenderStrategyProvider extends React.Component {
  state = { currentStrategy: 'default' };

  strategies = {
    default: (data) => <DefaultView data={data} />,
    grid: (data) => <GridView data={data} />,
    list: (data) => <ListView data={data} />,
    compact: (data) => <CompactView data={data} />
  };

  setStrategy = (strategy) => {
    if (this.strategies[strategy]) {
      this.setState({ currentStrategy: strategy });
    }
  };

  render() {
    const { data, children } = this.props;
    const { currentStrategy } = this.state;

    const strategyRenderer = this.strategies[currentStrategy];

    return children({
      currentStrategy,
      setStrategy: this.setStrategy,
      render: strategyRenderer,
      data
    });
  }
}

// ä½¿ç”¨
<RenderStrategyProvider data={items}>
  {({ currentStrategy, setStrategy, render, data }) => (
    <div>
      <div className="strategy-buttons">
        <button onClick={() => setStrategy('default')}>Default</button>
        <button onClick={() => setStrategy('grid')}>Grid</button>
        <button onClick={() => setStrategy('list')}>List</button>
        <button onClick={() => setStrategy('compact')}>Compact</button>
      </div>
      <div className={`view ${currentStrategy}`}>
        {render(data)}
      </div>
    </div>
  )}
</RenderStrategyProvider>
```

</CodeBlock>

---

## 5. Render Props vs HOC vs Hooks

### 5.1 æ¨¡å¼å¯¹æ¯”

<Compare>

```jsx
// HOC - åŒ…è£…ç»„ä»¶
const EnhancedComponent = withData(WrappedComponent);

// Render Props - ä¼ é€’æ¸²æŸ“å‡½æ•°
<DataProvider
  render={(data) => <WrappedComponent data={data} />}
/>

// Hooks - è‡ªå®šä¹‰Hook
function useData() {
  const [data, setData] = useState(null);
  // ...
  return data;
}

function WrappedComponent() {
  const data = useData();
  // ä½¿ç”¨data
}

// å·®å¼‚åˆ†æ
1. è¯­æ³•å¤æ‚åº¦: HOC < Render Props < Hooks
2. å­¦ä¹ æ›²çº¿: HOC < Render Props < Hooks
3. è°ƒè¯•ä½“éªŒ: HOC < Render Props < Hooks
4. æ€§èƒ½: Hooks â‰ˆ Render Props < HOC
5. çµæ´»æ€§: Hooks > Render Props > HOC
```

</Compare>

### 5.2 é€‰æ‹©æŒ‡å—

<CodeBlock>

```jsx
// é€‰æ‹©Render Propsçš„åœºæ™¯
1. çŠ¶æ€æå‡åˆ°çˆ¶ç»„ä»¶
2. å¤šä¸ªç»„ä»¶å…±äº«çŠ¶æ€é€»è¾‘
3. éœ€è¦æ§åˆ¶æ¸²æŸ“é€»è¾‘
4. children as functionæ¨¡å¼
5. ä¸æ”¯æŒHooksçš„æ—§ç‰ˆReact

// é€‰æ‹©Hooksçš„åœºæ™¯ (æ¨è)
1. æ–°çš„é¡¹ç›®
2. é€»è¾‘å¤ç”¨ç®€å•
3. ä¸éœ€è¦é¢å¤–ç»„ä»¶å±‚çº§
4. æ›´å¥½çš„TypeScriptæ”¯æŒ
5. æ›´å¥½çš„å¼€å‘ä½“éªŒ

// é€‰æ‹©HOCçš„åœºæ™¯
1. åº“å¼€å‘ (å¦‚Redux connect)
2. éœ€è¦ç»§æ‰¿React.Componentæ–¹æ³•
3. æ ·å¼å¢å¼º
4. å·²æœ‰å¤§é‡HOCä»£ç 
```

</CodeBlock>

### 5.3 æ€§èƒ½å¯¹æ¯”

<CodeBlock>

```jsx
// HOC - å¯èƒ½å¯¼è‡´é‡å¤æ¸²æŸ“
class withData extends React.Component {
  render() {
    return <WrappedComponent {...this.props} />;
  }
}

// Render Props - æ›´å¥½çš„æ§åˆ¶
<DataProvider
  render={(data) => {
    // å¯ä»¥ç²¾ç¡®æ§åˆ¶å“ªäº›ç»„ä»¶æ›´æ–°
    return <MyComponent data={data} />;
  }}
/>

// Hooks - æœ€ä½³æ€§èƒ½
function MyComponent() {
  const data = useData(); // åªåœ¨éœ€è¦æ—¶æ›´æ–°
  // ...
}
```

</CodeBlock>

---

## 6. å®é™…åº”ç”¨æ¡ˆä¾‹

### 6.1 ç”¨æˆ·è®¤è¯Render Props

<CodeBlock>

```jsx
// è®¤è¯Provider
function AuthProvider({ children }) {
  const [user, setUser] = useState(null);
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    checkAuth().then(setUser).finally(() => setLoading(false));
  }, []);

  const login = (credentials) => {
    return loginUser(credentials).then(setUser);
  };

  const logout = () => {
    return logoutUser().then(() => setUser(null));
  };

  return children({
    user,
    loading,
    isAuthenticated: !!user,
    login,
    logout
  });
}

// ä½¿ç”¨
<AuthProvider>
  {({ user, loading, isAuthenticated, login, logout }) => {
    if (loading) return <div>Loading...</div>;

    return (
      <div>
        {isAuthenticated ? (
          <Dashboard user={user} onLogout={logout} />
        ) : (
          <LoginForm onLogin={login} />
        )}
      </div>
    );
  }}
</AuthProvider>
```

</CodeBlock>

### 6.2 åª’ä½“æŸ¥è¯¢Render Props

<CodeBlock>

```jsx
// åª’ä½“æŸ¥è¯¢ç»„ä»¶
function MediaQuery({ query, children }) {
  const [matches, setMatches] = useState(() => {
    if (typeof window !== 'undefined') {
      return window.matchMedia(query).matches;
    }
    return false;
  });

  useEffect(() => {
    const mediaQuery = window.matchMedia(query);
    setMatches(mediaQuery.matches);

    const handler = (event) => setMatches(event.matches);
    mediaQuery.addListener(handler);

    return () => mediaQuery.removeListener(handler);
  }, [query]);

  return children({ matches });
}

// ä½¿ç”¨
<MediaQuery query="(min-width: 768px)">
  {({ matches }) => (
    <div>
      {matches ? (
        <DesktopLayout />
      ) : (
        <MobileLayout />
      )}
    </div>
  )}
</MediaQuery>
```

</CodeBlock>

### 6.3 æ— é™æ»šåŠ¨Render Props

<CodeBlock>

```jsx
// æ— é™æ»šåŠ¨ç»„ä»¶
function InfiniteScroll({ hasMore, loadMore, children, threshold = 100 }) {
  const [isLoading, setIsLoading] = useState(false);

  const handleScroll = useCallback(() => {
    if (isLoading || !hasMore) return;

    const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
    const scrollHeight = document.documentElement.scrollHeight;
    const clientHeight = document.documentElement.clientHeight;

    if (scrollTop + clientHeight >= scrollHeight - threshold) {
      setIsLoading(true);
      loadMore().finally(() => setIsLoading(false));
    }
  }, [isLoading, hasMore, loadMore, threshold]);

  useEffect(() => {
    window.addEventListener('scroll', handleScroll);
    return () => window.removeEventListener('scroll', handleScroll);
  }, [handleScroll]);

  return children({ isLoading });
}

// ä½¿ç”¨
<InfiniteScroll
  hasMore={hasMore}
  loadMore={loadMore}
>
  {({ isLoading }) => (
    <div>
      <ItemList items={items} />
      {isLoading && <div>Loading more...</div>}
    </div>
  )}
</InfiniteScroll>
```

</CodeBlock>

### 6.4 é”™è¯¯è¾¹ç•ŒRender Props

<CodeBlock>

```jsx
// é”™è¯¯è¾¹ç•ŒRender Props
class ErrorBoundary extends React.Component {
  constructor(props) {
    super(props);
    this.state = { hasError: false, error: null };
  }

  static getDerivedStateFromError(error) {
    return { hasError: true, error };
  }

  componentDidCatch(error, errorInfo) {
    this.props.onError?.(error, errorInfo);
  }

  render() {
    if (this.state.hasError) {
      return this.props.render({
        error: this.state.error,
        reset: () => this.setState({ hasError: false, error: null })
      });
    }

    return this.props.children;
  }
}

// ä½¿ç”¨
<ErrorBoundary
  onError={(error, info) => console.error(error, info)}
  render={({ error, reset }) => (
    <div className="error-boundary">
      <h2>Something went wrong</h2>
      <details>
        <summary>Error details</summary>
        <pre>{error.toString()}</pre>
      </details>
      <button onClick={reset}>Try again</button>
    </div>
  )}
>
  <MyComponent />
</ErrorBoundary>
```

</CodeBlock>

---

## 7. æœ€ä½³å®è·µ

### 7.1 å‘½åçº¦å®š

<CodeBlock>

```jsx
// âœ… å¥½çš„å‘½å
<Provider
  render={(data) => <Component data={data} />}
/>

<Component>
  {(data) => <div>{data}</div>}
</Component>

// âœ… æ¸…æ™°çš„å‚æ•°å
<DataProvider
  render={({ data, loading, error }) => {
    // æ¸…æ™°çš„çŠ¶æ€
  }}
/>

// âœ… æè¿°æ€§çš„renderå‡½æ•°
<RenderPropsComponent
  renderUser={(user) => <UserCard user={user} />}
  renderError={(error) => <ErrorMessage error={error} />}
/>
```

</CodeBlock>

### 7.2 Propsä¼ é€’

<CodeBlock>

```jsx
// âœ… ä¼ é€’æ‰€æœ‰å¿…è¦çš„çŠ¶æ€
<Counter>
  {({ count, increment, decrement, reset }) => (
    <div>
      <span>{count}</span>
      <button onClick={increment}>+</button>
      <button onClick={decrement}>-</button>
      <button onClick={reset}>Reset</button>
    </div>
  )}
</Counter>

// âœ… é¿å…åœ¨renderä¸­åˆ›å»ºå¯¹è±¡
<Counter>
  {({ count, increment }) => (
    <button onClick={() => increment()}>{count}</button>
    // é”™è¯¯: ä¸åº”è¯¥åœ¨renderä¸­åˆ›å»ºæ–°å‡½æ•°
  )}
</Counter>
```

</CodeBlock>

### 7.3 é”™è¯¯å¤„ç†

<CodeBlock>

```jsx
// âœ… æä¾›é»˜è®¤æ¸²æŸ“
<AsyncData
  url="/api/data"
  render={({ data, loading, error }) => {
    if (loading) return <DefaultLoader />; // é»˜è®¤
    if (error) return <DefaultError onRetry={refetch} />; // é»˜è®¤
    return <CustomView data={data} />; // è‡ªå®šä¹‰
  }}
/>

// âœ… è¾¹ç•Œæƒ…å†µå¤„ç†
<DataProvider
  render={({ data }) => {
    if (!data) return <div>No data available</div>;
    return <div>{data}</div>;
  }}
/>
```

</CodeBlock>

### 7.4 TypeScriptæ”¯æŒ

<CodeBlock>

```tsx
// TypeScriptç±»å‹å®šä¹‰
interface RenderProps<T> {
  data: T;
  loading: boolean;
  error: Error | null;
}

interface DataProviderProps {
  render: (props: RenderProps<any>) => React.ReactNode;
}

function DataProvider({ render }: DataProviderProps) {
  // å®ç°
}

// æ³›å‹ç‰ˆæœ¬
function DataProvider<T>({
  render,
  fetcher
}: {
  render: (props: RenderProps<T>) => React.ReactNode;
  fetcher: () => Promise<T>;
}) {
  // å®ç°
}

// ä½¿ç”¨
<DataProvider<{ name: string }>
  render={({ data, loading, error }) => {
    // dataå…·æœ‰ç±»å‹ { name: string }
    if (loading) return <div>Loading...</div>;
    return <div>{data.name}</div>;
  }}
/>
```

</CodeBlock>

---

## 8. å¸¸è§é™·é˜±

### é™·é˜±1ï¼šæ¸²æŸ“å‡½æ•°ä¸­çš„å¯¹è±¡åˆ›å»º

<ErrorBox>

```jsx
// âŒ é”™è¯¯ - åœ¨renderä¸­åˆ›å»ºæ–°å¯¹è±¡
<Counter>
  {({ count, increment }) => (
    <button onClick={() => increment()}>{count}</button>
    // æ¯æ¬¡æ¸²æŸ“éƒ½åˆ›å»ºæ–°å‡½æ•°
  )}
</Counter>

// âœ… æ­£ç¡® - å‡½æ•°å·²ä¼˜åŒ–
function MyComponent() {
  const handleClick = useCallback(() => {
    increment();
  }, [increment]);

  return (
    <Counter>
      {({ count, increment }) => (
        <button onClick={handleClick}>{count}</button>
      )}
    </Counter>
  );
}
```

</ErrorBox>

### é™·é˜±2ï¼šæ·±å±‚åµŒå¥—

<ErrorBox>

```jsx
// âŒ ä¸å¥½ - è¿‡å¤šåµŒå¥—
<AuthProvider>
  {({ user }) => (
    <ThemeProvider>
      {({ theme }) => (
        <DataProvider>
          {({ data }) => (
            <Router>
              {({ route }) => (
                <div>{/* å®é™…å†…å®¹ */}</div>
              )}
            </Router>
          )}
        </DataProvider>
      )}
    </ThemeProvider>
  )}
</AuthProvider>

// âœ… æ›´å¥½ - ç»„ä»¶ç»„åˆ
function AppProviders() {
  return (
    <AuthProvider>
      <ThemeProvider>
        <DataProvider>
          <AppContent />
        </DataProvider>
      </ThemeProvider>
    </AuthProvider>
  );
}

function AppContent() {
  const { user } = useAuth();
  const { theme } = useTheme();
  const { data } = useData();
  // æ¸²æŸ“å†…å®¹
}
```

</ErrorBox>

### é™·é˜±3ï¼šå¿˜è®°æ¸…ç†å‰¯ä½œç”¨

<ErrorBox>

```jsx
// âŒ é”™è¯¯ - æ²¡æœ‰æ¸…ç†å‰¯ä½œç”¨
function DataProvider({ url }) {
  const [data, setData] = useState(null);

  useEffect(() => {
    fetch(url).then(res => res.json()).then(setData);
  }, [url]);

  return <>{/* æ¸²æŸ“ */}</>;
}

// âœ… æ­£ç¡® - æ·»åŠ æ¸…ç†
function DataProvider({ url }) {
  const [data, setData] = useState(null);

  useEffect(() => {
    const controller = new AbortController();

    fetch(url, { signal: controller.signal })
      .then(res => res.json())
      .then(setData)
      .catch(err => {
        if (err.name !== 'AbortError') {
          console.error(err);
        }
      });

    return () => controller.abort();
  }, [url]);

  return <>{/* æ¸²æŸ“ */}</>;
}
```

</ErrorBox>

### é™·é˜±4ï¼šä¸ä¸€è‡´çš„æ¸²æŸ“é€»è¾‘

<ErrorBox>

```jsx
// âŒ é”™è¯¯ - ä¸åŒçš„æ¸²æŸ“æ¡ä»¶
<ConditionalRender
  condition={hasPermission}
  ifRender={() => <Component1 />}
  elseRender={() => <Component2 />}
/>

// æœ‰æ—¶ç›´æ¥è¿”å›
{hasPermission && <Component1 />}

// âœ… ä¸€è‡´ - ç»Ÿä¸€ä½¿ç”¨Render Props
<ConditionalRender
  condition={hasPermission}
  ifRender={() => <Component1 />}
  elseRender={() => <Component2 />}
/>
```

</ErrorBox>

---

## 9. å®è·µç»ƒä¹ 

### ç»ƒä¹ 1ï¼šåˆ›å»ºMouseTracker Render Props

<Expandable title="ç‚¹å‡»æŸ¥çœ‹è¦æ±‚">

**åŠŸèƒ½è¦æ±‚**ï¼š
- è·Ÿè¸ªé¼ æ ‡ä½ç½®
- å°†åæ ‡ä¼ é€’ç»™æ¸²æŸ“å‡½æ•°
- æ”¯æŒå¯é€‰çš„åæ ‡å˜æ¢ï¼ˆå¦‚ç›¸å¯¹ä½ç½®ã€åç§»ï¼‰

**å®ç°è¦æ±‚**ï¼š
```jsx
<MouseTracker
  render={({ x, y, relativeX, relativeY }) => (
    <div>
      <div>Absolute: {x}, {y}</div>
      <div>Relative: {relativeX}, {relativeY}</div>
    </div>
  )}
/>
```

**æç¤º**ï¼š
- ä½¿ç”¨mousemoveäº‹ä»¶ç›‘å¬
- ä½¿ç”¨useRefå­˜å‚¨å®¹å™¨å¼•ç”¨
- è®¡ç®—ç›¸å¯¹ä½ç½®

</Expandable>

### ç»ƒä¹ 2ï¼šåˆ›å»ºModal Render Props

<Expandable title="ç‚¹å‡»æŸ¥çœ‹è¦æ±‚">

**åŠŸèƒ½è¦æ±‚**ï¼š
- æ§åˆ¶æ¨¡æ€æ¡†çš„å¼€å…³
- ä¼ é€’æ§åˆ¶å‡½æ•°ç»™æ¸²æŸ“å‡½æ•°
- æ”¯æŒèƒŒæ™¯ç‚¹å‡»å…³é—­å’ŒESCé”®å…³é—­

**å®ç°è¦æ±‚**ï¼š
```jsx
<Modal
  isOpen={isModalOpen}
  onClose={() => setIsModalOpen(false)}
  render={({ isOpen, onClose }) => (
    <div className={`modal ${isOpen ? 'open' : ''}`}>
      <div className="modal-content">
        <button onClick={onClose}>Ã—</button>
        <h2>Modal Content</h2>
      </div>
    </div>
  )}
/>
```

**æç¤º**ï¼š
- ä½¿ç”¨é”®ç›˜äº‹ä»¶ç›‘å¬
- é˜»æ­¢å†’æ³¡
- CSSè¿‡æ¸¡åŠ¨ç”»

</Expandable>

### ç»ƒä¹ 3ï¼šåˆ›å»ºTabs Render Props

<Expandable title="ç‚¹å‡»æŸ¥çœ‹è¦æ±‚">

**åŠŸèƒ½è¦æ±‚**ï¼š
- æ ‡ç­¾é¡µåˆ‡æ¢
- ä¼ é€’å½“å‰æ ‡ç­¾å’Œåˆ‡æ¢å‡½æ•°
- æ”¯æŒé”®ç›˜å¯¼èˆª
- å¯é…ç½®é»˜è®¤æ ‡ç­¾

**å®ç°è¦æ±‚**ï¼š
```jsx
<Tabs defaultTab="tab1">
  {({ activeTab, setActiveTab, tabs }) => (
    <>
      <div className="tab-headers">
        {tabs.map(tab => (
          <button
            key={tab.id}
            className={activeTab === tab.id ? 'active' : ''}
            onClick={() => setActiveTab(tab.id)}
          >
            {tab.label}
          </button>
        ))}
      </div>
      <div className="tab-content">
        {tabs.find(tab => tab.id === activeTab)?.content}
      </div>
    </>
  )}
</Tabs>
```

**æç¤º**ï¼š
- ä½¿ç”¨useStateç®¡ç†å½“å‰æ ‡ç­¾
- æ·»åŠ å·¦å³ç®­å¤´é”®ç›˜å¯¼èˆª
- ä½¿ç”¨useRefä¿å­˜tabsé…ç½®

</Expandable>

### ç»ƒä¹ 4ï¼šåˆ›å»ºDrag and Drop Render Props

<Expandable title="ç‚¹å‡»æŸ¥çœ‹è¦æ±‚">

**åŠŸèƒ½è¦æ±‚**ï¼š
- æ‹–æ‹½åŠŸèƒ½
- ä¼ é€’æ‹–æ‹½çŠ¶æ€å’Œäº‹ä»¶å¤„ç†å™¨
- æ”¯æŒè‡ªå®šä¹‰æ‹–æ‹½åé¦ˆ
- è¾¹ç•Œæ£€æµ‹

**å®ç°è¦æ±‚**ï¼š
```jsx
<DragDrop
  onDragEnd={(data) => console.log('Dropped:', data)}
  render={({
    isDragging,
    dragProps,
    dropProps
  }) => (
    <div {...dropProps}>
      <div
        {...dragProps}
        className={`draggable ${isDragging ? 'dragging' : ''}`}
      >
        Drag me
      </div>
    </div>
  )}
/>
```

**æç¤º**ï¼š
- ä½¿ç”¨mousedown, mousemove, mouseupäº‹ä»¶
- è®°å½•åˆå§‹ä½ç½®
- è®¡ç®—æ‹–æ‹½åç§»é‡
- æ·»åŠ è§†è§‰åé¦ˆ

</Expandable>

---

## 10. æœ¬ç« å°ç»“

### å…³é”®è¦ç‚¹

<Checklist>

- âœ… Render Propsæ˜¯ä¸€ä¸ªpropï¼Œå€¼ä¸ºå‡½æ•°ï¼Œå‘Šè¯‰ç»„ä»¶å¦‚ä½•æ¸²æŸ“
- âœ… ä¼˜åŠ¿ï¼šæ— é¢å¤–ç»„ä»¶å±‚çº§ã€æ¸…æ™°çš„æ•°æ®æµã€çµæ´»çš„æ§åˆ¶
- âœ… ä½¿ç”¨children as functionä½¿è¯­æ³•æ›´è‡ªç„¶
- âœ… é€‚ç”¨åœºæ™¯ï¼šçŠ¶æ€æå‡ã€é€»è¾‘å¤ç”¨ã€æ¡ä»¶æ¸²æŸ“
- âœ… ç›¸æ¯”HOCï¼šæ›´å¥½çš„è°ƒè¯•ä½“éªŒã€é¿å…å‘½åå†²çª
- âœ… ç›¸æ¯”Hooksï¼šæ›´å¥½çš„ç±»å‹æ”¯æŒã€æ—§é¡¹ç›®å‹å¥½
- âœ… é¿å…åœ¨renderå‡½æ•°ä¸­åˆ›å»ºæ–°å¯¹è±¡æˆ–å‡½æ•°
- âœ… æ·±å±‚åµŒå¥—æ—¶è€ƒè™‘ç»„ä»¶ç»„åˆ
- âœ… è®°ä½æ¸…ç†å‰¯ä½œç”¨
- âœ… TypeScriptä¸­å¯ä»¥ä½¿ç”¨æ³›å‹å¢å¼ºç±»å‹å®‰å…¨

</Checklist>

### æ¨¡å¼é€‰æ‹©æŒ‡å—

<BestPractices>

1. **æ–°é¡¹ç›®** - ä¼˜å…ˆä½¿ç”¨Hooks
2. **ç®€å•é€»è¾‘** - ä½¿ç”¨è‡ªå®šä¹‰Hook
3. **å¤æ‚çŠ¶æ€** - ä½¿ç”¨useReduceræˆ–Context
4. **Render Props** - çŠ¶æ€æå‡ã€æ¡ä»¶æ¸²æŸ“ã€æ—§é¡¹ç›®
5. **HOC** - åº“å¼€å‘ã€æ ·å¼å¢å¼ºã€ç±»ç»„ä»¶

</BestPractices>

### å¸¸è§Render Propsç±»å‹

**çŠ¶æ€ç®¡ç†**ï¼š
- `<Counter>{({ count, increment }) => ...}</Counter>`
- `<Form>{({ values, handleChange }) => ...}</Form>`

**æ•°æ®è·å–**ï¼š
- `<AsyncData>{({ data, loading }) => ...}</AsyncData>`
- `<InfiniteScroll>{({ isLoading }) => ...}</InfiniteScroll>`

**ç³»ç»Ÿé›†æˆ**ï¼š
- `<AuthProvider>{({ user }) => ...}</AuthProvider>`
- `<ThemeProvider>{({ theme }) => ...}</ThemeProvider>`

**äº¤äº’**ï¼š
- `<MouseTracker>{({ x, y }) => ...}</MouseTracker>`
- `<Draggable>{({ dragProps }) => ...}</Draggable>`

### ä¸‹ä¸€æ­¥å­¦ä¹ 

ç°åœ¨ä½ å·²ç»æŒæ¡äº†Render Propsï¼Œæ¥ä¸‹æ¥å¯ä»¥å­¦ä¹ ï¼š

1. **[å¤åˆç»„ä»¶](compound-components)** - å­¦ä¹ ç»„ä»¶ç»„åˆçš„é«˜çº§æŠ€å·§
2. **[å®¹å™¨-å±•ç¤ºæ¨¡å¼](container-presentational)** - æŒæ¡çŠ¶æ€ç®¡ç†æœ€ä½³å®è·µ
3. **[é”™è¯¯è¾¹ç•Œ](../advanced/error-boundaries)** - æ·±å…¥Reacté”™è¯¯å¤„ç†
4. **[Hooksæ¨¡å¼](../advanced/hooks-patterns)** - ç°ä»£Reactå¼€å‘

---

## 11. å»¶ä¼¸é˜…è¯»

### å®˜æ–¹èµ„æº

- [Render Props](https://react.dev/reference/react) - Reactå®˜æ–¹æ–‡æ¡£
- [Composition vs Inheritance](https://react.dev/learn/thinking-in-react) - ç»„åˆæ¨¡å¼
- [Children as Function](https://react.dev/reference/react) - childrenä½œä¸ºå‡½æ•°

### æ¨èé˜…è¯»

- [Render Props vs HOCs](https://kentcdodds.com/blog/aha-moments-when-learning-react) - æ¨¡å¼å¯¹æ¯”
- [Recomposeåº“](https://github.com/acdlite/recompose) - Render Propså·¥å…·åº“
- [React Patterns](https://reactpatterns.com/) - Reactæ¨¡å¼é›†åˆ

### ç›¸å…³è¯é¢˜

- [React Composition](https://react.dev/learn/thinking-in-react) - ç»„åˆæ€ç»´
- [PropGettersæ¨¡å¼](../advanced/props-getters) - Propsä¼ é€’
- [Controlled vs Uncontrolled](../advanced/controlled-uncontrolled) - å—æ§æ¨¡å¼

---

[â† ä¸Šä¸€ç« ï¼šé«˜é˜¶ç»„ä»¶](higher-order-components) | [ä¸‹ä¸€ç« ï¼šå¤åˆç»„ä»¶ â†’](compound-components)
